# 考题综合解答 - 完整版 (Comprehensive Problem Set Answers - Final)

> [!abstract] 核心纲要
> 本笔记旨在为您**完整地**、**无遗漏地**详细解答您上传的所有技术类题目，内容涵盖**微控制器架构、半导体与数字逻辑、ADC/DAC、通信协议**和**嵌入式编程**。

---

### Ⅰ. CPU、内存与系统架构

> [!info]
> 这一部分涉及MCU与MPU的对比，以及MCU架构的基础知识。

> [-question] **题目 (`cb5c722ec388fe1ea90a929224ddf1c.jpg`)**
> (a) CPU中的寄存器是什么？它与普通内存有何不同？
> (b) 在尺寸、成本、功耗、I/O端口和内存方面，比较和对比微处理器和微控制器。

> [!answer] **(a) 解答**:
> CPU中的寄存器（Register）是位于CPU芯片内部的、数量有限但速度极快的存储单元。它用于临时存放当前正在执行的指令、操作数和计算的中间结果。
>
> 其与普通内存（Regular Memory / RAM）的核心区别在于：
> - **位置与速度**: 寄存器在CPU内部，访问速度极快；内存位于CPU外部，通过总线连接，速度远慢于寄存器。
> - **容量与成本**: 寄存器因制造成本高昂，容量非常小；内存则成本相对低廉，容量巨大。
> - **功用**: 寄存器是CPU的“临时工作台”，直接参与计算；内存是程序的“主要工作区”，存放运行的程序和数据，数据需要先加载到寄存器才能被CPU计算。

> [!answer] **(b) 解答**:
> 微处理器（MPU）和微控制器（MCU）的区别主要体现在其集成度和应用目标上，具体如下：
> | 特性 | 微处理器 (MPU) | 微控制器 (MCU) |
> | :--- | :--- | :--- |
> | **尺寸** | 系统体积大，需外挂多个芯片 | 单芯片方案，体积小巧 |
> | **成本**| 系统总成本高 | 芯片单价和系统总成本都低 |
> | **功耗** | 功耗高 | 功耗低，适合电池供电 |
> | **I/O端口** | 需外接专用芯片扩展 | 单芯片上集成了大量通用I/O端口 |
> | **内存** | 需外挂RAM和ROM，容量灵活 | 在单芯片上集成了固定大小的RAM和Flash/ROM |

> [!question] **题目 (`96f0d65eb4897937f03a4f26b1e372a.jpg` - Q1a, Q1b)**
> (a) CPU的三个主要组件是什么？简要描述其中任意两个的目的。
> (b) 微控制器中通常使用哪种类型的内存架构？借助图表解释内存如何与该架构中的处理器交互。

> [!answer] **(a) 解答**:
> CPU的三个主要组件是：**控制单元 (Control Unit)**、**算术逻辑单元 (ALU)** 和 **寄存器 (Registers)**。
> - **控制单元**: 它是CPU的“总指挥”。负责从内存中获取指令，对其进行译码，然后向CPU的其他部分发出控制信号。
> - **算术逻辑单元 (ALU)**: 它是CPU的“计算器”。负责执行所有的数学运算和逻辑运算。

> [!answer] **(b) 解答**:
> 微控制器中通常使用**哈佛架构 (Harvard Architecture)**。
> - **交互方式**: 在哈佛架构中，**指令内存**和**数据内存**物理上分离，并拥有各自独立的总线。这允许处理器**同时**从程序内存中读取指令，并从数据内存中存取数据，提高了执行效率。

> [!question] **题目 (`ed2176e43ef5542b1f9fe67afb860ee.jpg` - a)**
> (a) 画一个框图来表示一个典型的微控制器架构。请标记程序的所有部分并适当地互连它们。

> [!answer] **解答**:
> 一个典型的微控制器（MCU）架构框图应包含以下核心组件：
> - **CPU (中央处理器)**
> - **程序内存 (Program Memory, Flash/ROM)**
> - **数据内存 (Data Memory, RAM)**
> - **输入/输出端口 (I/O Ports)**
> - **定时器/计数器 (Timers/Counters)**
> - **通信接口 (如 UART, SPI, I2C)**
> - **ADC/DAC**
> - **时钟 (Clock)**
> - **总线 (Buses)**: 地址总线、数据总线和控制总线，将以上所有组件互连起来。
>
> *(框图可参考 `b16bc59e2c131cf8b602ed6ef43574d.jpg` 中的微控制器架构图)*

---

### Ⅱ. 半导体与数字逻辑

> [!info]
> 这一部分考察了二极管、MOSFET、CMOS以及逻辑门的基础知识。

> [!question] **题目 (`a78fa491eeb00b8487351dc5488d38b.jpg` & `c3a1eb9d4d057a89aaa8a2285cd2d5a.jpg` & `9cb8a25b25080be37d5fb8056074ee3.jpg` - d)**

> [!answer] **(c / d(i)) PN结二极管的什么特性使其适用于开关应用？**
> > PN结二极管的核心特性是其**单向导电性**。在**正向偏置**下，它呈现低电阻的“导通”状态（闭合开关）；在**反向偏置**下，它呈现高电阻的“截止”状态（断开开关）。

> [!answer] **(d / d(ii)) 画一个NMOS FET器件的示意图 / 描述MOSFET操作中的反型层。**
> > **示意图**: NMOS器件包含P型衬底(p-substrate)、N+掺杂的源极(S)和漏极(D)、通过氧化物绝缘层隔离的栅极(G)和体电极(B)。 *(参考 `c3a1eb9d4d057a89aaa8a2285cd2d5a.jpg` 中的图)*
> >
> > **反型层**: 在NMOS中，当施加在栅极的正电压（Vgs）超过阈值电压时，会在P型衬底表面产生电场，吸引电子聚集，形成一个连接源区和漏区的导电薄层，这个薄层就是**反型层（N沟道）**。

> [!answer] **(e / d(iii)) MOSFET的“阈值电压”是什么意思？ / 画一个CMOS反相器图。**
> > **阈值电压**: 是指**刚好**能够在源区和漏区之间形成导电**沟道**时，所需要的**最小栅极-源极电压 (Vgs)**。它是控制MOSFET开关状态的临界点。
> >
> > **CMOS反相器连接**: PMOS的源极接电源(VDD)，NMOS的源极接地(GND)；两者的漏极连接在一起作为输出；两者的栅极连接在一起作为输入。

> [!question] **题目 (`37814b8207d7b669afa14a1d28fc646.jpg` - a, b)**

> [!answer] **(a) 当图2(a)中的二极管D1导通时，ID的值是多少？**
> > 1. 当二极管D1导通并被视为**短路**时，电路变为5V电源和1kΩ电阻的简单回路。
> > 2. 根据欧姆定律 `I = V/R`，`I_D = 5V / 1kΩ = 5mA`。

> [!answer] **(b) 确定图2(b)中配置的真值表。**
> > 这个电路是一个**与非门 (NAND Gate)**。
> > **真值表**:
> > | A | B | Vo |
> > | :-: | :-: | :-: |
> > | 0 | 0 | **1** |
> > | 0 | 1 | **1** |
> > | 1 | 0 | **1** |
> > | 1 | 1 | **0** |

---

### Ⅲ. ADC / DAC (模数/数模转换)

> [!info]
> 这部分涉及ADC/DAC的应用、功能及相关计算。

> [!question] **题目 (`572f03638c49d33379c2b66bc576031.jpg` & `9b89f6e2b6dcc2e001acc92402d13e7.jpg` & `5c49a88a97c61b66ea05e14a3d1fa56.jpg` & `187e9b4346b0b1054fdf807148c4f62.jpg`)**

> [!answer] **(Q8iii / `572f...`) 将二进制数1101转换为模拟输出。**
> > 1.  ` (1101)₂ = 13₁₀`。
> > 2.  `Vout = Vref * (13 / 2⁴) = 5V * (13 / 16) = 4.0625V`。

> [!answer] **(Q7ii, iii / `9b89f...`) Nucleo L432KC的ADC位深和步长是多少？**
> > (ii) 位深是 **12位**。
> > (iii) 步长 = `3.6V / 2¹² = 3.6V / 4096 ≈ 0.879 mV`。

> [!answer] **(Q9ii / `5c49a...`) DAC的主要功能是什么？**
> > DAC的主要功能是将**时间上和幅度上都离散**的数字信号，转换为一个**幅度上连续**的模拟信号。

> [!answer] **(`187e9b...` - a, b, c)**
> > (a) **ADC的应用**: 1.麦克风录音; 2.数码相机; 3.数字温度计; 4.医疗设备(如ECG)。
> > (b) **Sigma-Delta ADC**: 通过**过采样**和**噪声整形**工作。**优势**是高分辨率、高抗噪性、低成本。
> > (c) **BJT vs. MOSFET**: 主要区别在于**控制方式**（电流vs电压）、**输入阻抗**（低vs高）和**功耗**（高vs低）。

---

### Ⅳ. 通信协议与PWM

> [!info]
> 这部分考察了对不同串行通信协议和PWM的理解。

> [!question] **题目 (`4692c6df667f054226b1b3f29379048.jpg` - a,b,c & `e60a368919865cb24a46c96c61c0e3c.jpg` - a,c,d,e & `d0a01795b814ad0e51c35b7c130272e.jpg` & `1bf758f8a87493b5523264aa5938d55.jpg` & `60755963e16588cc4c20ce51386b848.jpg` & `4e283b5b5b11c873bcd2758c2d5dd13.jpg` - a,b,c)**

> [!answer] **PWM计算 (`4e283b...`)**:
> > (i) 周期 `T = 1 / 100Hz = 10ms`。
> > (ii) 脉宽 `t_on = 0.20 * 10ms = 2ms`。
> > (iii) 平均值 `V_avg = 0.2 * 5V = 1V`。
> > (iv) 波形图为一个周期为10ms，前2ms为5V高电平，后8ms为0V低电平的方波。

> [!answer] **PWM转模拟 (`4e283b...`)**:
> > (b) 电路图为一个简单的**RC低通滤波器**：PWM信号输入端串联一个电阻R，在电阻R和地之间并联一个电容C，从电容两端取出平滑后的模拟电压。

> [!answer] **PWM参数应用 (`4e283b...`)**:
> > (c)(i) **控制LED亮度**: **周期/频率**通常是固定的，通过改变**占空比**来调节亮度。
> > (c)(ii) **驱动扬声器播放曲调**: **占空比**通常固定（如50%），通过改变**周期/频率**来产生不同音高的声音。

> [!answer] **协议选择 (`60755...` & `e60a36...` - a)**:
> > 连接40/120个外设，首选**I2C**。因为它使用地址寻址，仅需2根线。标准SPI需要为每个设备提供独立的片选线，不现实。

> [!answer] **SPI波形 (`1bf758...`)**:
> > (i) 时钟周期 `T = 1 / 10MHz = 100ns`。
> > (ii) `0x4A = 01001010`。Mode 0下，在每个时钟上升沿之前，数据线应准备好`0,1,0,0,1,0,1,0`的电平。

> [!answer] **奇偶校验位 (`d0a017...`)**:
> > 奇偶校验位在UART通信中用于**简单错误检测**。

---

### Ⅴ. 嵌入式C编程

> [!info]
> 这部分考察了Mbed平台的C++编程基础。

> [!question] **题目 (`96f0d65eb4897937f03a4f26b1e372a.jpg` - c)**

> [!answer] **(i) 7段数码管输出**:
> > 根据表格，`switch(i)`的`case 0, 1, 2, 3` 分别对应 `0x7D, 0x07, 0x6D, 0x06`，所以7段数码管会依次显示 **6, 7, 5, 1**。

> [!answer] **(ii) 修改SWITCH语句**:
> > 要显示从3到0的计数，应修改为：
> > ```cpp
> > switch(i) {
> >     case 0: display = 0x6F; break; // Display 3
> >     case 1: display = 0x5B; break; // Display 2
> >     case 2: display = 0x06; break; // Display 1
> >     case 3: display = 0x3F; break; // Display 0
> > }
> > ```

> [!question] **题目 (`39c052c...` - b,c & `ed2176e...` - b,c)**

> [!answer] **(Q5b / `39c052...`) 代码改错**:
> > 1. `digitalOut` 应为 `DigitalOut`。
> > 2. 变量 `x` 在使用前未定义。
> > 3. `ThisThread_sleepfor(x)` 语法错误，应为 `ThisThread::sleep_for()`。
> > 4. `my_led = 0;` 后面缺少延时。
> > 5. `main`函数缺少 `return 0;`。

> [!answer] **(Q5c / `39c052...`) 编写波形代码**:
> > ```cpp
> > #include "mbed.h"
> > DigitalOut D5(D5);
> > Timer t;
> > int main() {
> >     t.start();
> >     while(t.read() < 3.0) {
> >         D5 = 1; ThisThread::sleep_for(250ms);
> >         D5 = 0; ThisThread::sleep_for(750ms);
> >     }
> > }
> > ```

> [!answer] **(Q4b / `e60a36...`) 中断代码分析**:
> > (i) `InterruptIn`: 定义一个中断输入引脚。
> > (ii) `while(1)`: 创建无限循环，让主程序持续运行。
> > (iii) `&ISR1`: `&`是取地址运算符，传递函数地址。
> > (iv) `wait(0.25)`改为`25ms`: `ThisThread::sleep_for(25ms);`。
> > (v) `.rise`: 将ISR函数“附加”到中断引脚的**上升沿**事件上。

> [!answer] **(`6fb51f...` - c) 代码分析**:
> > (i) `parm1 = parm2;`: 发生了**ADC**（读取parm2）和**DAC**（写入parm1）两次转换。
> > (ii) `parm1 = 0.5;`: 发生了**DAC**转换。
> > (iii) `parm3 = parm2;`: 发生了**ADC**转换（读取parm2），然后将数字值赋给数字输出对象。


---
# 考题综合解答 - 补充与修正版

> [!abstract] 核心纲要
> 本笔记旨在为您**补充和修正**之前遗漏的题目解答，确保覆盖您上传的所有题目。内容涵盖**微控制器架构、PWM、通信协议**和**嵌入式编程**。

---

### Ⅰ. 微控制器架构与电路设计

> [!info]
> 这部分涉及系统框图和电路设计。

> [!question] **题目 (`39c052cda983cf730d12630397dee3d.jpg` - a)**
> (a) 一个微控制器被编程为当室温升至25°C以上时打开风扇。画一个框图来展示微处理器、内存和外部外设在这种情况下是如何连接的。请务必用箭头标示总线通信的方向。

> [!answer] **解答**:
> **框图**:
> 1. 一个**温度传感器**（外部外设）作为输入，连接到微处理器。
> 2. 一个**风扇**（外部外设）作为输出，由微处理器控制。
> 3. **微处理器(CPU)**、**内存(Memory)**以及外设接口都连接到**地址总线**和**数据总线**上。
>
> **通信流程**:
> - **地址总线**: 箭头从**CPU**单向指向**内存**和**外设**。
> - **数据总线**:
>   - 箭头从**温度传感器**单向指向**CPU**（输入数据）。
>   - 箭头从**CPU**单向指向**风扇**（输出指令）。
>   - 箭头在**CPU**和**内存**之间是**双向的**。

> [!question] **题目 (`4692c6df667f054226b1b3f29379048.jpg` - b)**
> (b) 画一个电路图来展示如何使用一个RC低通滤波器将PWM信号转换回模拟信号。

> [!answer] **解答**:
> 电路图为一个简单的**RC低通滤波器**：
> 1.  PWM信号的输出端首先串联一个**电阻 R**。
> 2.  在电阻R的另一端和地(GND)之间，并联一个**电容 C**。
> 3.  从电容的两端取出平滑后的模拟电压作为最终输出。
>
> 这个电路的原理是，电容会对快速变化的PWM方波进行充放电，电阻则限制了充放电的速度。最终，输出的电压会稳定在PWM信号的平均电压值附近，从而实现了从数字到模拟的转换。

---

### Ⅱ. PWM (脉冲宽度调制)

> [!info]
> 这部分是关于PWM的新计算题和应用分析。

> [!question] **题目 (`4e283b5b5b11c873bcd2758c2d5dd13.jpg` - a, c)**
> (a) 一个5V供电的MCU生成频率为100Hz、占空比为20%的PWM输出。
> (i) PWM输出的周期是多少？
> (ii) PWM输出的脉冲宽度是多少？
> (iii) PWM输出的平均值是多少？
> (iv) 绘制PWM输出的波形图。

> [!answer] **解答**:
> (i) **周期 (Period)**: `T = 1 / f = 1 / 100Hz = 0.01s = 10ms`。
> (ii) **脉冲宽度 (Pulse Width / ON time)**: `t_on = D * T = 20% * 10ms = 0.2 * 10ms = 2ms`。
> (iii) **平均值 (Average Value)**: `V_avg = D * V_peak = 0.2 * 5V = 1V`。
> (iv) **波形图**: 一个周期为10ms的方波。其中，前2ms为5V高电平，后8ms为0V低电平，然后重复此模式。

> [!question] (c) 对于以下两个应用，说明周期和占空比哪个是固定的，哪个是可变的。
> (i) 控制一个LED的亮度。
> (ii) 用PWM信号驱动一个扬声器来播放一个曲调。

> [!answer] **解答**:
> (i) **控制LED亮度**:
>    - **周期/频率**: **固定的 (fixed)**。通常设定在一个较高频率（如 >100Hz）以避免人眼察觉到闪烁。
>    - **占空比**: **可变的 (variable)**。通过改变占空比来调节LED在一个周期内点亮的时间，从而控制其平均亮度。
> (ii) **驱动扬声器播放曲调**:
>    - **周期/频率**: **可变的 (variable)**。声音的音高是由频率决定的，因此要播放不同的音符（曲调），必须改变PWM信号的频率。
>    - **占空比**: **固定的 (fixed)**。通常固定在50%，以使扬声器的振膜能够最大程度地前后振动，产生最响亮的声音。

---

### Ⅲ. 通信协议

> [!info]
> 这部分是新的通信协议题目。

> [!question] **题目 (`e60a368919865cb24a46c96c61c0e3c.jpg` - a, c)**
> (a) 一个STM32微控制器需要连接120个从设备...你会选择哪种同步通信协议，为什么？

> [!answer] **解答**:
> **我会选择I2C协议。**
> **原因**: I2C使用**地址寻址**，无论连接多少设备，理论上都只需要**2根**总线（SDA和SCL）。7位地址支持112个可用地址，如果不够，可以切换到10位地址模式。而标准SPI需要为每个从设备提供一根独立的片选线，连接120个设备将需要**120根**GPIO引脚，这在任何微控制器上都是**不现实的**。

> [!question] (c) 一个UART...波特率9600bps，用于发送值`0xA7`... 绘制UART输出波形。

> [!answer] **解答**:
> 1. **参数解码**:
>    - **数据**: `0xA7` 的8位二进制是 `10100111`。
>    - **发送顺序 (LSB first)**: `1`, `1`, `1`, `0`, `0`, `1`, `0`, `1`。
> 2. **波形绘制**:
>    - **Idle**: 线路保持在高电平。
>    - **Start Bit**: 线路拉低到 **0V**。
>    - **Data Bits**: 依次发送`1, 1, 1, 0, 0, 1, 0, 1`的电平序列。
>    - **Parity Bit**: 题目未指定奇偶校验，假设为无校验(none)。
>    - **Stop Bit**: 线路拉高到 **高电平**。
>    - **Return to Idle**: 线路保持在高电平。

---

### Ⅳ. 嵌入式C编程

> [!info]
> 这部分是新的或需要修正答案的编程题。

> [!question] **题目 (`96f0d65eb4897937f03a4f26b1e372a.jpg` - c)**

> [!answer] **(i) 写出7段数码管显示器的输出**:
> > 根据表格，`switch(i)`的`case 0, 1, 2, 3` 分别对应 `0x7D, 0x07, 0x6D, 0x06`。查表可知，这些十六进制值对应的实际显示数字是：
> > - `0x7D` -> **2**
> > - `0x07` -> **7**
> > - `0x6D` -> **5**
> > - `0x06` -> **6**
> >
> > 所以，7段数码管会依次显示 **2, 7, 5, 6**。

> [!answer] **(ii) 修改SWITCH语句以显示从3到0的计数**:
> > ```cpp
> > switch(i) {
> >     case 0: display = 0x6F; break; // Display 3
> >     case 1: display = 0x7D; break; // Display 2
> >     case 2: display = 0x07; break; // Display 1
> >     case 3: display = 0x3F; break; // Display 0
> > }
> > ```

> [!question] **题目 (`39c052cda983cf730d12630397dee3d.jpg` - b)**
> (b) 找出代码中的5个错误并改正。

> [!answer] **解答**:
> 1. **错误**: `digitalOut my_led(D5);` -> **改正**: `DigitalOut my_led(D5);` (D和O应大写)。
> 2. **错误**: 变量 `x` 在使用前未定义。 -> **改正**: 在`while(1)`前添加 `int x = 2;`。
> 3. **错误**: `ThisThread_sleepfor(x);` -> **改正**: `ThisThread::sleep_for(chrono::seconds(x));` (正确的Mbed OS 6语法)。
> 4. **错误**: `my_led = 0;` 后面缺少延时，导致`my_led=1`的效果几乎看不见。 -> **改正**: 在 `my_led = 0;` 之后也添加一行延时，例如 `ThisThread::sleep_for(chrono::seconds(2));`。
> 5. **错误**: `main`函数应有返回值。 -> **改正**: 在`main`函数的最后括号前加上 `return 0;`。

> [!question] **题目 (`6fb51f694270468d30f20cdd20024c2.jpg` - c)**

> [!answer] **(iii) 在 `parm3 = parm2;` 这行代码中是否发生转换？**
> > 是的，发生了**ADC（模数转换）**。`parm2`是一个`AnalogIn`对象，读取它会启动一次ADC，将A6引脚上的模拟电压转换为一个0.0到1.0的浮点数。然后，这个**数字值**被赋给`DigitalOut`对象`parm3`。如果这个浮点数不为0，`parm3`对应的引脚会输出高电平；如果为0，则输出低电平。
> 
> 