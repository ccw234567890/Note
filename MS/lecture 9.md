![[屏幕截图 2025-08-12 150818.png]]

![[屏幕截图 2025-08-12 150834.png]]

![[屏幕截图 2025-08-12 150845.png]]

![[屏幕截图 2025-08-12 150858.png]]

![[屏幕截图 2025-08-12 150912.png]]

![[屏幕截图 2025-08-12 150923.png]]

![[屏幕截图 2025-08-12 150935.png]]

![[屏幕截图 2025-08-12 150945.png]]

# 笔记：通信基础 - 从比特流到并行/串行

> [!abstract] 核心纲要
> 本笔记旨在深入剖析电子设备之间进行数据通信的基础概念。我们将遵循一个从宏观到微观的逻辑路径：
> 1.  **通信的基本原理**: 了解设备如何通过电压变化来传递二进制信息，以及“协议”的重要性。
> 2.  **数据传输的三种类型**: 解析**单工 (Simplex)**、**半双工 (Half-duplex)** 和 **全双工 (Full-duplex)** 的区别。
> 3.  **通信的两种形式**: 深度对比**并行通信 (Parallel)** 与**串行通信 (Serial)** 的优缺点。
> 4.  **串行通信的分类**: 介绍**同步 (Synchronous)** 与**异步 (Asynchronous)** 通信的基本概念。

---

### Ⅰ. 通信的基本原理

> [!info]
> **什么是通信？** 电子设备之间的通信，就像人与人之间的交流，是为了共享信息和执行任务。为了确保信息能够被准确无误地理解，设备之间必须遵循一套共同的**规则**，这套规则就被称为**通信协议 (Communication Protocol)**，例如我们后续会学到的 **SPI, I2C, UART** 等。

> [!example] **信息的物理表示**
> > - **比特 (Bit)**: 电子设备通过在导线上传输**比特流**（一串 `1` 和 `0`）来进行通信。比特是信息的基本单元，就像语言中的字母。
> > - **电压表示**: 这些抽象的 `1` 和 `0`，在物理电路上是通过**电压的快速变化**来实现的。
> >   - **逻辑 `1` (High)**: 通常对应一个**较高的电压**，例如 **3.3V** 或 **5V**。
> >   - **逻辑 `0` (Low)**: 通常对应一个**较低的电压**，例如 **GND (地, `0V`)**。

---

### Ⅱ. 数据传输的三种类型 (按数据流向划分)

> [!help]
> 根据数据流动的方向性，通信可以分为三种基本类型。

> [!check] **1. 单工 (Simplex)**
> > - **定义**: 数据只能**单向**流动，从发送方(TX)到接收方(RX)。
> > - **比喻**: **电视广播**或**收音机**。信号塔永远是发送方，你的电视永远是接收方。

> [!check] **2. 半双工 (Half-duplex)**
> > - **定义**: 数据可以**双向**流动，但**不能同时进行**。在任意时刻，一个设备要么在发送，要么在接收。
> > - **比喻**: **对讲机 (Police Radio)**。一个人说完“Over”之后，另一个人才能开始说。

> [!check] **3. 全双工 (Full-duplex)**
> > - **定义**: 数据可以**同时进行双向**流动。双方可以同时发送和接收。
> > - **比喻**: **打电话**。你可以边听边说。

---

### Ⅲ. 通信的两种形式 (按布线方式划分)

> [!question]
> 我们是将一大组数据“并排”一次性发送，还是“排队”逐个发送呢？这定义了并行和串行两种通信形式。

> [!danger] **1. 并行通信 (Parallel Communication)**
> > - **原理**: **一次同时**传输多个数据位。例如，一个8位的字节通过8条并行的导线同时发送，理论上速度是串行的8倍。
> > - **优点**: 在**短距离**内可以实现非常**高的数据传输速率**。
> > - **致命缺陷 (Challenges)**:
> >   - **成本高、布线复杂 (Cost & Complexity)**: 需要更多的导线、引脚和更大的连接器。
> >   - **串扰 (Crosstalk)**: 在长距离下，相邻导线之间的电磁干扰会变得严重，导致数据出错。
> >   - **时钟偏移 (Clock Skew)**: 由于每根导线的物理特性（长度、阻抗等）有微小差异，导致同时发送的比特位在长距离传输后，**无法同时到达**接收端，造成数据错乱。
> > - **主要应用**: 计算机**内部**的高速数据传输（如CPU到RAM）。

> [!success] **2. 串行通信 (Serial Communication)**
> > - **原理**: 数据位**一个接一个地**，在一条单一的导线上排队传输。
> > - **优点**: 完美地解决了并行通信的缺陷，**布线简单、成本低、抗干扰能力强，非常适合长距离传输**。
> > - **主要应用**: **绝大多数**的现代外部设备通信，如USB, SATA, Ethernet, CAN, 以及我们将要学习的UART, I2C, SPI。

---

### Ⅳ. 串行通信的分类

> [!tip]
> 串行通信又可以根据“收发双方是否共享一个统一的节拍器（时钟）”分为两类。

- **同步通信 (Synchronous Communication)**:
  - **特点**: 使用一根**共享的时钟线 (Clock)** 来同步数据传输。
  - **例子**: SPI, I2C。
- **异步通信 (Asynchronous Communication)**:
  - **特点**: **没有共享的时钟线**。通过在数据中加入特殊的**起始/停止位**来进行同步。
  - **例子**: **UART**。

![[屏幕截图 2025-08-12 150956.png]]

![[屏幕截图 2025-08-12 151009.png]]

![[屏幕截图 2025-08-12 151026.png]]

![[屏幕截图 2025-08-12 151042.png]]

![[屏幕截图 2025-08-12 151056.png]]

![[屏幕截图 2025-08-12 151108.png]]

![[屏幕截图 2025-08-12 151120.png]]

![[屏幕截图 2025-08-12 151139.png]]

# 笔记：并行 vs. 串行 & 同步 vs. 异步 通信全解析

> [!abstract] 核心纲要
> 本笔记旨在深入剖析电子设备之间进行数据通信的两种核心形式及其子分类。我们将遵循一个从宏观到微观的逻辑路径：
> 1.  **宏观对比**: **并行通信 (Parallel)** 与 **串行通信 (Serial)** 的优缺点及应用场景。
> 2.  **串行通信详解**: 深入了解串行通信的特点，并进一步将其分为**同步 (Synchronous)** 与**异步 (Asynchronous)** 两种模式。
> 3.  **模式深度对比**: 详细解析同步与异步通信的原理、优缺点及典型协议。

---

### Ⅰ. 宏观对比：并行通信 vs. 串行通信

> [!info]
> 数据传输最基本的两种“布线”方式，决定了数据是“并排走”还“是排队走”。

> [!example] **核心原理**
> - **并行通信**: **一次同时**传输多个数据位（例如，8位数据通过8条独立的线同时发送）。
> - **串行通信**: 数据位**一个接一个地**，在一条单一的导线上排队传输。

> [!summary] **详细对比表**
| 特性 | 并行通信 (Parallel Communication) | 串行通信 (Serial Communication) |
| :--- | :--- | :--- |
| **串扰 (Crosstalk)** | **高** - 多条邻近线路会相互干扰 | **低** - 导线少，干扰几率小 |
| **时钟偏移 (Clock Skew)** | **显著** - 各线路的微小差异导致信号到达时间不一致 | **可忽略** - 数据在单线上传输，不存在线间偏移 |
| **线缆长度 (Cable Length)** | **短** - 因偏移和串扰，信号完整性随距离迅速下降 | **长** - 性能可靠，非常适合长距离传输 |
| **硬件成本 (Hardware Cost)** | **高** - 需要更多导线、引脚和更大的连接器 | **低** - 更少的导线和更简单的接口降低了成本 |
| **数据速率 (Data Rate)** | 短距离内速率高 | **可通过提高时钟频率实现高速率**，在长距离上更快 |
| **物理体积 (Bulkiness)** | **笨重** - 宽大的线缆和接口不适合紧凑系统 | **紧凑** - 细窄的线缆适合嵌入式和移动应用 |
| **主要应用** | 计算机**内部**总线 (CPU ↔ RAM) | **网络、USB、SATA、UART、I2C、SPI** |

---

### Ⅱ. 串行通信的两种模式：同步 vs. 异步

> [!question]
> 在串行通信中，接收方如何知道何时开始读取每一位数据呢？这主要有两种同步节拍的方式。

> [!success] **1. 同步通信 (Synchronous Communication) - “统一的节拍器”**
> > - **核心原理**: 发送方 (Tx) 和接收方 (Rx) **共享一根额外的时钟线 (Clock)**。
> > - **工作流程**: 发送方在时钟信号的特定边沿发送数据，接收方在完全相同的节拍上接收数据。这确保了双方的完美同步。
> > - **数据形式**: 数据通常以**连续的数据流（块或帧）**形式发送，中间没有停顿。
> >
> > > [!check] **优点**
> > > - **高速高效**: 非常适合大数据块的传输。
> > > - **低开销 (Low Overhead)**: 无需为每个字节添加额外的起始/停止位，节省了带宽。
> >
> > > [!danger] **缺点**
> > > - **硬件更复杂**: 需要额外的时钟线和同步电路。
> > > - **不适合长距离**: 在长电缆上，时钟信号本身也可能发生偏移和抖动。
> >
> > **典型协议**: **I²C, SPI**

> [!tip] **2. 异步通信 (Asynchronous Communication) - “事先的约定”**
> > - **核心原理**: **没有共享的时钟线**。
> > - **工作流程**:
> >   1.  双方**事先约定**好相同的**比特率/波特率 (Bit rate/Baud rate)**。
> >   2.  发送方在每个数据字节（包）的开头加上一个**起始位 (Start bit)**，结尾加上一个**停止位 (Stop bit)**。
> >   3.  接收方通过检测到起始位来与发送方进行临时同步，并按照约定的速率接收数据。
> > - **数据形式**: 数据以**数据包 (Packet)** 的形式发送，传输之间可以有任意时间的停顿。
> >
> > > [!check] **优点**
> > > - **设计简单、成本低**: 需要的电路和引脚更少。
> > > - **适合长距离**: 没有时钟偏移的问题，信号更鲁棒。
> >
> > > [!danger] **缺点**
> > > - **传输速度较慢**: 每个字节都需要额外的起始/停止位，开销较大。
> > > - **不适合大量数据传输**: 逐字节发送对于连续的 bulk data 传输效率较低。
> > > - **依赖起始位识别**: 如果起始位因噪声被错过，整个字节都可能被误读。
> >
> > **典型协议**: **UART** (常用于RS-232)



![[屏幕截图 2025-08-12 151152.png]]

![[屏幕截图 2025-08-12 151204.png]]

![[屏幕截图 2025-08-12 151228.png]]

![[屏幕截图 2025-08-12 151241.png]]

![[屏幕截图 2025-08-12 151252.png]]

![[屏幕截图 2025-08-12 151305.png]]

![[屏幕截图 2025-08-12 151318.png]]

![[屏幕截图 2025-08-12 151329.png]]


# 笔记：异步通信与UART协议全解析

> [!abstract] 核心纲要
> 本笔记旨在深入剖析一种基础而重要的串行通信方式——**异步通信**，并重点讲解其最典型的实现——**UART协议**。我们将：
> 1.  **对比同步与异步通信**: 明确两者在有无**共享时钟**上的根本区别。
> 2.  **定义UART**: 了解其作为一种异步串行通信协议和硬件电路的角色。
> 3.  **拆解UART数据帧**: 详细解析**起始位、数据位、校验位、停止位**在通信中的作用。
> 4.  **明确关键参数**: 理解**比特率**与**波特率**的含义。
> 5.  **总结优缺点与应用**: 了解在何种场景下应该选择使用UART。

---

### Ⅰ. 基础：同步 vs. 异步通信

> [!question] 同步与异步通信最主要的区别是什么？
> **答案 (C)**: **同步通信使用共享时钟，而异步通信不使用。(Synchronous uses a shared clock, while asynchronous does not.)**

> [!example] **详细对比**
| 特性 | 同步通信 (Synchronous) | 异步通信 (Asynchronous) |
| :--- | :--- | :--- |
| **时钟信号** | **需要**一根共享的时钟线 | **没有**共享时钟线 |
| **数据传输** | 以连续的数据流（块/帧）发送 | 以字节为单位的数据包（帧）发送，可有间歇 |
| **开销 (Overhead)**| **低** (没有额外的起始/停止位) | **高** (每个字节都需要起始/停止位) |
| **速度** | **更快**、更高效 | 相对较慢 |
| **硬件设计** | 更复杂（需要同步电路） | 更简单 |
| **同步方式** | 外部时钟线 | 数据帧内的起始位 |
| **理想应用** | 高速、大块数据传输（如I2C, SPI） | 低速、零散数据通信（如UART, RS-232） |

---

### Ⅱ. UART 是什么？

> [!info]
> - **全称**: **U**niversal **A**synchronous **R**eceiver/**T**ransmitter (通用异步收发器)。
> - **定义**: 它既是一种**异步串行通信协议**，也是实现该协议的**物理电路**（通常集成在微控制器内部）。
> - **硬件连接**: 非常简单，最基础的通信只需要**两根线**（和一个共用地线GND）：
>   - **TX (Transmit)**: 发送数据线。
>   - **RX (Receive)**: 接收数据线。
>   - 连接时需要**交叉连接**：设备A的TX连接到设备B的RX，设备A的RX连接到设备B的TX。

---

### Ⅲ. UART的“游戏规则”：数据帧与波特率

> [!help]
> 由于没有共享时钟，UART通信的双方必须像立下“君子协定”一样，事先约定好一套完全相同的通信规则。

> [!check] **1. 关键参数：比特率 (Bit rate) 与 波特率 (Baud Rate)**
> > - **比特率**: **每秒传输的数据位数** (单位: bps)。
> > - **波特率**: **每秒信号电平变化的次数** (单位: bauds per second)。
> > - **关键结论**: 在UART这种使用高低电平表示`1`和`0`的二进制系统中，**比特率和波特率是相等的**。
> > - **“君子协定”**: **发送方和接收方必须设置成完全相同的波特率**（如9600, 115200等），否则接收方会“会错意”，导致数据解码完全错误。

> [!tip] **2. UART数据包（帧）结构**
> > UART通过一个精确定义的数据帧结构，来在没有时钟线的情况下实现收发同步。
> > 
> >
> > **一帧数据的“旅程”**:
> > 1. **空闲状态 (Idle State)**: 在没有数据传输时，发送线(TX)保持在**高电平 (逻辑`1`)**。
> > 2. **起始位 (Start Bit)**: 发送方将TX线**拉低 (逻辑`0`)** 一个比特的时间。这个**从高到低的跳变**就像一个信号枪，告诉接收方：“注意，我要开始发数据了！” 接收方检测到这个信号后，启动自己的时钟开始准备接收。
> > 3. **数据位 (Data Bits)**: 紧接着是5到9位的实际数据，通常是**8位**。数据按照**从最低有效位(LSB)到最高有效位(MSB)**的顺序发送。
> > 4. **奇偶校验位 (Parity Bit) (可选)**: 一个用于**基本错误检测**的附加位。
> > 5. **停止位 (Stop Bit(s))**: 发送方将TX线**拉高 (逻辑`1`)** 1位或2位的时间，标志着一帧数据的**结束**。线路恢复到空闲的高电平状态，准备下一次的发送。

---

### Ⅳ. UART的优缺点与应用

> [!summary]

> [!success] **优点 (Why UART?)**
> - **成本低、硬件简单**: 只需要两根线，内部电路实现也相对简单。
> - **易于实现**: 几乎所有的微控制器都内置了硬件UART模块。
> - **无需时钟管理**: 异步特性使其非常适合连接两个独立时钟系统的设备。

> [!danger] **局限性 (Limitations)**
> - **速度相对较慢**: 相比SPI等同步协议，速度有上限。
> - **点对点通信**: 一个UART接口通常只能实现两个设备间的通信，不支持多设备总线。
> - **距离有限**: 通常在15米以内，长距离传输需要RS-485等电平转换芯片。

> [!list] **在哪里使用？ (Where is UART Used?)**
> - **微控制器与电脑通信**: 例如 **Arduino** 的串口监视器，用于调试和打印信息。
> - **外设模块连接**: 连接 **GPS模块**、**蓝牙模块 (HC-05, HC-06)** 等。
> - **调试接口**: 许多嵌入式设备的底层**调试控制台**。
> - **传统PC串口**: 继承自**RS-232**标准。


![[屏幕截图 2025-08-12 151340.png]]

![[屏幕截图 2025-08-12 151353.png]]

![[屏幕截图 2025-08-12 151403.png]]

![[屏幕截图 2025-08-12 151414.png]]

![[屏幕截图 2025-08-12 151422.png]]

![[屏幕截图 2025-08-12 151436.png]]

![[屏幕截图 2025-08-12 151447.png]]

![[屏幕截图 2025-08-12 151457.png]]


# 笔记：UART通信协议深度解析 (Step-by-Step)

> [!abstract] 核心纲要
> 本笔记旨在深入剖析**通用异步收发器 (UART)** 的核心工作流程。我们将重点关注：
> 1.  **UART的宏观功能**: 理解其作为CPU并行数据与外部串行世界之间的“转换器”角色。
> 2.  **通信的先决条件**: 强调**波特率 (Baud Rate)** 匹配的重要性。
> 3.  **UART数据包的剖析**: 详细拆解一帧UART数据从**空闲、起始、数据、校验、停止**的完整生命周期。

---

### Ⅰ. 宏观功能：并行与串行的“转换器”

> [!info]
> UART硬件的核心任务是在CPU的**并行总线**和外部设备的**串行线路**之间进行双向的数据格式转换。

> [!example] **工作流程**
> 1. **发送方 (Transmitting UART)**:
>    - 从CPU的并行**数据总线**上接收一个完整的数据字节（如8位）。
>    - 像一个“打包工人”，给这个字节加上**起始位、可选的校验位和停止位**等“包装”，形成一个完整的**UART数据包 (Data Packet)**。
>    - 将这个打包好的数据，一位一位地通过**TX引脚**串行发送出去。
> 2. **接收方 (Receiving UART)**:
>    - 从**RX引脚**一位一位地接收串行数据。
>    - 像一个“拆包工人”，验证起始/停止位和校验位，将“包装”剥离。
>    - 将提取出的干净的数据字节，并行地呈递给接收方CPU的**数据总线**。

---

### Ⅱ. 通信的先决条件：波特率的“君子协定”

> [!danger]
> 由于UART是**异步**通信（没有共享时钟线），为了让接收方能够正确地在信号流中“踩点”读取每一位数据，收发双方必须**事先约定**好完全相同的通信速率。

> [!check] **波特率 (Baud Rate)**
> > - **定义**: 每秒传输的信号符号（在二进制中即比特）的数量。
> > - **核心要求**: **发送方和接收方的波特率必须配置得几乎完全相同**。
> > - **后果**: 如果波特率不匹配（通常误差大于±10%），接收方就会在错误的时间点进行采样，导致数据错位，最终产生**帧错误 (Framing Error)** 和数据损坏。

---

### Ⅲ. UART数据包（帧）的剖析：一步一脚印

> [!tip]
> 我们来跟随一帧数据的完整旅程，理解每一个控制位的作用。

> [!note] **1. 空闲状态 (Idle State)**
> > - **电平**: 在没有数据传输时，通信线 (TX) 始终保持在**高电平 (Logic 1)**。
> > - **状态**: 收发双方都处于就绪状态。

> [!note] **2. 起始位 (Start Bit)**
> > - **电平**: **高 -> 低** 的跳变。
> > - **作用**: 发送方通过将线路**拉低一个比特的时间**，来发出一个**“开始信号”**。
> > - **意义**: 这是至关重要的**同步信号**。接收方一旦检测到这个下降沿，就知道一个新数据帧来了，并立即启动自己的时钟，准备在约定的时间间隔（由波特率决定）后开始采样数据位。

> [!note] **3. 数据位 (Data Bits)**
> > - **内容**: 实际承载的信息，通常是**8位**（一个字节）。
> > - **顺序**: 数据按照**从最低有效位 (LSB) 到最高有效位 (MSB)** 的顺序依次发送。

> [!note] **4. 奇偶校验位 (Parity Bit) - 可选**
> > - **作用**: 用于进行简单的**错误检测**。
> > - **类型**:
> >   - **偶校验 (Even Parity)**: 校验位被设置为 `0` 或 `1`，以确保**数据位+校验位**中 `1` 的总个数为**偶数**。
> >   - **奇校验 (Odd Parity)**: 确保 `1` 的总个数为**奇数**。
> > - **机制**: 接收方会用同样的方法计算接收到的数据位的奇偶性，并与接收到的校验位进行比较。如果不匹配，就检测到了传输错误。

> [!note] **5. 停止位 (Stop Bit(s))**
> > - **电平**: **高电平 (Logic 1)**。
> > - **作用**: 发送方通过将线路**拉高1位或2位的时间**，来标志一帧数据的**结束**。
> > - **意义**:
> >   1. 确保线路在数据帧结束后能可靠地返回到**空闲状态（高电平）**。
> >   2. 给予接收方一定的处理时间，以准备好接收下一个数据帧的起始位。

> [!note] **6. 返回空闲 / 下一帧 (Idle / Next Frame)**
> > 停止位之后，线路保持空闲的高电平，直到下一个起始位的到来。

---

### Ⅳ. 总结与知识检验

> [!summary] **UART数据包各字段总结**
| 字段 | 典型大小 | 值 | 目的 |
| :--- | :--- | :--- | :--- |
| **起始位** | 1 bit | `0` (LOW) | 标志数据帧开始；实现接收方同步 |
| **数据位** | 5-9 bits (通常8) | 二进制数据 | 承载实际数据 (如一个字节或ASCII字符) |
| **校验位** | 0或1 bit (可选) | `0` 或 `1` | 提供基于奇偶校验的简单错误检测 |
| **停止位** | 1或2 bits | `1` (HIGH) | 标志数据帧结束；给接收方复位时间 |

> [!question] **知识检验**
> > **Which of the following correctly describes the structure of a UART data packet?**
> > (以下哪个选项正确描述了UART数据包的结构？)
> >
> > **正确答案**: **B)** One start bit (logic low), 7-8 data bits, optional parity bit, and one or more stop bits (logic high)
> >
> > **解析**:
> > - A和C错误，因为异步通信**没有时钟信号 (clock signal)**。
> > - D错误，因为数据位数是可配置的，不是固定的10位。
> > - B完美地描述了我们上面剖析的UART数据帧结构。

![[屏幕截图 2025-08-12 151510.png]]

![[屏幕截图 2025-08-12 151521.png]]

![[屏幕截图 2025-08-12 151532.png]]

![[屏幕截图 2025-08-12 151543.png]]

![[屏幕截图 2025-08-12 151552.png]]

![[屏幕截图 2025-08-12 151602.png]]

![[屏幕截图 2025-08-12 151614.png]]

![[屏幕截图 2025-08-12 151624.png]]

![[屏幕截图 2025-08-12 151634.png]]

![[屏幕截图 2025-08-12 151643.png]]

# 笔记：UART通信流程、错误及USART详解

> [!abstract] 核心纲要
> 本笔记旨在深入剖析**通用异步收发器 (UART)** 的完整端到端通信流程及其错误检测机制，并在此基础上，介绍其升级版——**通用同步/异步收发器 (USART)**。我们将重点关注：
> 1.  **UART的完整工作流程**: 从发送方的“打包”到接收方的“解包”和同步采样。
> 2.  **UART的错误类型**: 解析**帧错误**和**奇偶校验错误**的成因。
> 3.  **USART的引入**: 理解其相比于UART所增加的**同步模式**及其优势。
> 4.  **UART vs. USART**: 通过一个全面的对比，明确两者的核心差异。

---

### Ⅰ. UART的端到端工作流程

> [!info]
> UART通信的本质，是发送方将CPU的并行数据“打包”成串行帧发送，接收方再将串行帧“解包”成并行数据给CPU。

#### **1. 发送方 (Transmitting UART) - “打包工人”**

> [!example] **以发送字符 ‘A’ 为例**
> > 假设约定为8位数据，偶校验，1位停止位。
> > 1. **获取并行数据**: 发送方从CPU数据总线接收到字符 **'A'**，其二进制ASCII码为 `01000001`。
> > 2. **构建数据帧 (Data Frame)**:
> >    - **添加起始位**: 在数据前加上一个 `0` (LOW)。
> >    - **准备数据位**: 数据需**从最低有效位(LSB)开始**发送，所以 `01000001` 被倒序为 `10000010`。
> >    - **计算校验位**: 数据 `01000001` 中有2个`1`。因为是**偶校验**，`1`的个数已经是偶数，所以**校验位为 `0`**。
> >    - **添加停止位**: 在数据最后加上一个 `1` (HIGH)。
> > 3. **串行发送**: 将打包好的完整数据帧 `0 10000010 0 1`，在**Tx**线上一位一位地发送出去。
> >
> > 

#### **2. 接收方 (Receiving UART) - “拆包工人”**

> [!help]
> 接收方在没有共享时钟的情况下，必须精确地同步和采样。

> [!check] **接收流程**
> > 1. **检测起始位**: 接收方持续监测**Rx**线。当检测到电平**从高(Idle)到低**的跳变时，它知道一帧数据来了，并**重置其内部的定时器**。
> > 2. **按波特率采样**: 根据预先配置好的波特率，接收方会在每个比特周期的**正中间**进行电压采样，以最准确地读取 `0` 或 `1`。
> > 3. **接收并验证**: 接收方读入数据位和校验位，并自行计算校验。
> > 4. **移除帧位**: 在检测到停止位后，接收方会**剥离**掉起始位、校验位和停止位这些“包装”。
> > 5. **转换为并行数据**: 最后，将干净的、8位的数据**并行地**呈递给接收方CPU的数据总线。

---

### Ⅱ. UART的错误类型

> [!danger]
> 在异步通信中，可能会发生以下常见错误。

> [!warning] **1. 帧错误 (Framing Error)**
> > - **原因**: 当接收方在期望接收到**停止位**（高电平）的时刻，却检测到了**低电平**。
> > - **根源**: 这通常是由**波特率不匹配**、**时序错误**或**线路噪声**引起的，导致接收方与发送方的“节拍”错位。

> [!warning] **2. 奇偶校验错误 (Parity Error)**
> > - **原因**: 当接收到的**数据位**计算出的奇偶性，与接收到的**奇偶校验位**的值**不匹配**时，就会触发此错误。
> > - **作用**: 表明在传输过程中，可能有一个数据位发生了翻转（从0变1或从1变0）。
> > - **前提**: 只有在收发双方都**启用了奇偶校验模式**时，这个错误才会被检测到。

---

### Ⅲ. 升级版：USART - 同步/异步混合体

> [!tip]
> **USART (Universal Synchronous/Asynchronous Receiver/Transmitter)** 是一个更强大、更通用的通信外设。

- **定义**: 几乎所有现代微控制器都配备了USART模块。它是一个**既支持像UART一样的异步模式，也支持同步模式**的“二合一”通信接口。
- **同步模式**:
  - 在同步模式下，会使用一根**额外的时钟线 (CLK)**。
  - 发送方会主动产生时钟信号，接收方根据这个时钟信号进行精确的同步采样。
  - **优点**: 因为有了精确的时钟，**不再需要起始/停止位**，数据传输效率和速度都更高。

---

### Ⅳ. 全面对比：UART vs. USART

> [!summary]

| 特性 | UART (通用异步收发器) | USART (通用同步/异步收发器) |
| :--- | :--- | :--- |
| **工作模式** | **仅异步 (Asynchronous only)** | **支持同步和异步两种模式** |
| **时钟要求** | 无共享时钟线，依赖波特率约定 | 异步模式下同UART；**同步模式下需要共享时钟线** |
| **位定时** | 依赖起始/停止位，对波特率失配敏感 | 同步模式下由时钟线提供精确的位定时 |
| **错误检测** | 基本（奇偶校验、帧错误） | 异步模式下同UART；**同步模式可支持更高级的错误检测**（如CRC） |
| **硬件复杂度** | **更简单**（仅TX, RX） | 更复杂（增加了时钟线和相关逻辑） |
| **数据效率** | **较低**（每个字节都有额外的起始/停止位开销） | **同步模式下更高**（无额外位开销） |
| **速度能力** | 适用于**中低速** | **同步模式下可实现更高速率** |
| **常用场景** | 调试、GPS模块、蓝牙等简单串口设备 | MCU间高速通信、实时数据系统等 |