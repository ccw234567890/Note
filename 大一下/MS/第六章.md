![[Pasted image 20250811211045.png]]
![[4b8455f06eb36eaf3cf2793cc367173.jpg]]

![[b33f960adb788e690ee174133519990.jpg]]

# 笔记：微控制器(MCU)编程入门 (Introduction to MCU Programming)

> [!abstract] 核心纲要
> 本笔记旨在系统梳理微控制器（MCU）的基础知识与编程入门。我们将遵循一个从宏观到微观、从硬件到软件的逻辑路径：
> 1.  **MCU是什么**: 了解其定义、功能和应用。
> 2.  **MCU的内部架构**: 解析其核心组件及两种主流的内存架构（哈佛 vs. 冯诺依曼）。
> 3.  **MCU vs. MPU**: 清晰地区分微控制器与微处理器。
> 4.  **MCU的编程**: 了解嵌入式C的特点以及Mbed等开发平台的优势。
> 5.  **硬件大家族**: 明确MCU在ASIC、MCU、FPGA这一硬件谱系中的定位。

---

### Ⅰ. MCU是什么？- 基础回顾

> [!info]
> - **定义与功能**: 微控制器（MCU）是一种**单芯片微型计算机系统**。它将**CPU核心、存储器（Flash, ROM, RAM）、定时器、I/O端口**等多种必要外设全部集成在了一块芯片上。它的主要用途是**控制电子设备，执行特定任务**。
> - **应用**: MCU存在于各种现代电子设备中，从**消费电子**到**工业自动化**，无处不在。
> - **市场趋势**: **物联网 (IoT)** 的发展是推动微控制器市场持续增长的重要驱动力。

---

### Ⅱ. MCU的内部架构

> [!example]
> 一颗MCU就像一个“五脏俱全”的微型电脑。

> [!check] **1. 核心组件 (Core Components)**
> > - **CPU (中央处理器)**: **大脑**，负责执行指令和运算。
> > - **存储器 (Memory)**:
> >   - **程序内存 (Flash ROM)**: 存放**程序代码**，非易失性（断电不丢）。
> >   - **数据内存 (RAM)**: 存放**临时变量**，易失性（断电即丢）。
> > - **I/O端口 (I/O Ports)**: **感官和四肢**，与外部世界交互的接口（如数字、模拟、PWM等）。
> > - **总线 (Buses)**: **神经网络**，连接所有组件，传输地址、数据和控制信号。
> > - **时钟 (Clock)**: **心跳**，提供同步节拍，驱动整个系统运行（例如，Mbed Nucleo板的时钟频率为80 MHz）。

> [!tip] **2. 两种内存架构 (MCU Architecture)**
> > - **哈佛架构 (Harvard Architecture)**:
> >   - **特点**: **指令总线**和**数据总线**相互**分离**。
> >   - **优势**: CPU可以**同时**读取指令和存取数据，**效率更高**。这是现代ARM Cortex-M等高性能MCU的常用架构。
> > - **冯·诺依曼架构 (von Neumann Architecture)**:
> >   - **特点**: **指令和数据共享**同一条总线。
> >   - **优势**: 结构简单。
> >   - **劣势**: 存在“冯·诺依曼瓶颈”，取指令和取数据不能同时进行。

---

### Ⅲ. MCU vs. MPU：微控制器 vs. 微处理器

> [!faq]
> 这是两个非常容易混淆的概念。

| 特性 | **微控制器 (Microcontroller, MCU)** | **微处理器 (Microprocessor, MPU)** |
| :--- | :--- | :--- |
| **集成度** | **高** (CPU, RAM, ROM, I/O都**集成**在一块芯片上) | **低** (通常只有CPU核心，需**外挂**RAM, ROM等) |
| **系统** | 一个完整的**片上系统 (System on a Chip)** | 一个计算机系统的**中央处理单元** |
| **灵活性** | RAM/ROM容量和I/O端口数量**固定** | 可根据需求**灵活配置**RAM/ROM的大小 |
| **尺寸** | 小 (Small in size) | 大 (Normally occupies more space) |
| **成本** | **便宜 (Cheap)** | **昂贵 (Expensive)** |
| **功耗** | **低 (Less power consumption)** | 高 (Need more power to function) |
| **应用** | 控制导向（如家电、汽车电子） | 计算导向（如个人电脑、服务器） |

---

### Ⅳ. MCU的编程：嵌入式C与Mbed平台

> [!help]
> 我们通过编写程序来赋予MCU“灵魂”。

> [!note] **1. 嵌入式C (Embedded C)**
> > - **定义**: 标准C语言的一个**扩展子集**，增加了针对微控制器硬件（如I/O端口、寄存器）进行直接操作的特性。
> > - **特点**:
> >   - **底层访问 (Low-Level Access)**: 可直接操作硬件。
> >   - **高效与性能 (Efficiency & Performance)**: 执行速度快，内存占用少。
> >   - **可移植性 (Portability)**: 代码稍作修改即可在不同MCU上运行。

> [!success] **2. Mbed等开发平台的优势**
> > 像 **Mbed OS** 这样的平台，极大地简化了嵌入式开发。
> > - **丰富的库文件 (Rich Set of Libraries)**: 提供了大量预先写好的函数库，让我们无需关心底层寄存器的复杂操作，就能轻松控制硬件。
> > - **系统资源控制 (Control Over System Resources)**: 允许对CPU、内存和外设进行精细控制。
> > - **易于调试 (Ease of Debugging)**: 良好的工具链支持（如JTAG），便于查找和修复错误。
> > - **结构化与模块化 (Structured & Modular Approach)**: 鼓励编写结构清晰、可重用的代码。
> >
> > > [!example] **"Blinky" 程序**
> > > 这是嵌入式世界的“Hello, World!”。第一个程序通常都是编写一个让LED灯闪烁的“Blinky”程序，以验证硬件和开发环境是否正常工作。

---

### Ⅴ. 硬件大家族：MCU在硬件谱系中的定位

> [!cite]
> 从“专用”到“通用”，MCU处在一个承上启下的关键位置。

**Specific (专用) <--------------------------------> Generic (通用)**
**ASIC** -------------------- **MCU** -------------------- **FPGA**

- **ASIC (专用集成电路)**:
  - **特点**: 为**单一特定功能**而定制的芯片。
  - **优/缺点**: 性能最高、功耗最低；但开发成本极高，且**完全没有灵活性**。
- **MCU (微控制器)**:
  - **特点**: **通过软件编程**来实现不同的功能，在特定领域内非常灵活。
  - **优/缺点**: **性能、成本、功耗和灵活性的最佳平衡点**。
- **FPGA (现场可编程门阵列)**:
  - **特点**: 硬件逻辑本身可以被用户**重新编程**。
  - **优/缺点**: **灵活性最高**，可以实现任何数字电路；但成本和功耗相对较高，开发也更复杂。