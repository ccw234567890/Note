# 考题综合解答 (Comprehensive Problem Set Answers)

> [!abstract] 核心纲要
> 本笔记旨在为您详细解答上传图片中的所有技术类题目，内容涵盖**微控制器架构、半导体与数字逻辑、ADC/DAC、通信协议**和**嵌入式编程**。

---

### Ⅰ. CPU、内存与系统架构

> [!info]
> 这一部分涉及MCU与MPU的对比，以及MCU架构的基础知识。

> [!question] **题目 (`cb5c722ec388fe1ea90a929224ddf1c.jpg` - a, b)**
> (a) CPU中的寄存器是什么？它与普通内存有何不同？
> (b) 在尺寸、成本、功耗、I/O端口和内存方面，比较和对比微处理器和微控制器。

> [!answer] **(a) 解答**:
> CPU中的寄存器（Register）是位于CPU芯片内部的、数量有限但速度极快的存储单元。它用于临时存放当前正在执行的指令、操作数和计算的中间结果。
>
> 其与普通内存（Regular Memory / RAM）的核心区别在于：
> - **位置与速度**: 寄存器在CPU内部，访问速度极快；内存位于CPU外部，通过总线连接，速度远慢于寄存器。
> - **容量与成本**: 寄存器因制造成本高昂，容量非常小；内存则成本相对低廉，容量巨大。
> - **功用**: 寄存器是CPU的“临时工作台”，直接参与计算；内存是程序的“主要工作区”，存放运行的程序和数据，数据需要先加载到寄存器才能被CPU计算。

> [!answer] **(b) 解答**:
> 微处理器（MPU）和微控制器（MCU）的区别主要体现在其集成度和应用目标上，具体如下：
> | 特性 | 微处理器 (MPU) | 微控制器 (MCU) |
> | :--- | :--- | :--- |
> | **尺寸** | 系统体积大，需外挂多个芯片 | 单芯片方案，体积小巧 |
> | **成本**| 系统总成本高 | 芯片单价和系统总成本都低 |
> | **功耗** | 功耗高 | 功耗低，适合电池供电 |
> | **I/O端口** | 需外接专用芯片扩展 | 单芯片上集成了大量通用I/O端口 |
> | **内存** | 需外挂RAM和ROM，容量灵活 | 在单芯片上集成了固定大小的RAM和Flash/ROM |

> [!question] **题目 (`96f0d65eb4897937f03a4f26b1e372a.jpg` - Q1a, Q1b)**
> (a) CPU的三个主要组件是什么？简要描述其中任意两个的目的。
> (b) 微控制器中通常使用哪种类型的内存架构？借助图表解释内存如何与该架构中的处理器交互。

> [!answer] **(a) 解答**:
> CPU的三个主要组件是：**控制单元 (Control Unit)**、**算术逻辑单元 (ALU)** 和 **寄存器 (Registers)**。
> - **控制单元**: 它是CPU的“总指挥”。负责从内存中获取指令，对其进行译码，然后向CPU的其他部分发出控制信号。
> - **算术逻辑单元 (ALU)**: 它是CPU的“计算器”。负责执行所有的数学运算和逻辑运算。

> [!answer] **(b) 解答**:
> 微控制器中通常使用**哈佛架构 (Harvard Architecture)**。
> - **交互方式**: 在哈佛架构中，**指令内存**和**数据内存**是物理上分离的，并拥有各自独立的总线。这允许处理器**同时**从程序内存中读取指令，并通过数据总线存取数据，从而提高了执行效率。

> [!question] **题目 (`39c052cda983cf730d12630397dee3d.jpg` - a)**
> (a) 画一个框图来表示一个典型的微控制器架构...

> [!answer] **解答**:
> 一个典型的微控制器（MCU）架构应包含以下核心组件，并通过总线互连：
> - **CPU (中央处理器)**: 核心。
> - **程序内存 (Flash/ROM)**: 通过指令总线与CPU连接。
> - **数据内存 (RAM)**: 通过数据总线与CPU连接。
> - **输入/输出端口 (I/O Ports)**: 连接到总线。
> - **定时器 (Timers)**, **ADC/DAC**, **串行接口 (UART/I2C/SPI)** 等外设也连接到总线。

---

### Ⅱ. 半导体与数字逻辑

> [!info]
> 这一部分考察了二极管、MOSFET、CMOS以及逻辑门的基础知识。

> [!question] **题目 (`9cb8a25b25080be37d5fb8056074ee3.jpg` - d)**
> (i) PN结二极管的什么特性使其适用于开关应用？
> (ii) 借助图示，描述MOSFET操作中的反型层（N沟道）。
> (iii) 画一个图来展示CMOS反相器中...是如何连接的。

> [!answer] **(i) 解答**:
> PN结二极管的核心特性是其**单向导电性**。在**正向偏置**下导通（闭合开关），在**反向偏置**下截止（断开开关）。

> [!answer] **(ii) 解答**:
> 在NMOS晶体管中，当施加在栅极的正电压（Vgs）超过阈值电压（Vth）时，会在P型衬底表面吸引电子聚集，形成一个连接源区和漏区的导电薄层，这个薄层就是**反型层（N沟道）**。

> [!answer] **(iii) 解答**:
> CMOS反相器的连接方式如下：
> 1.  **PMOS**的源极接VDD，漏极接输出。
> 2.  **NMOS**的源极接地，漏极也接输出。
> 3.  两者的栅极连接在一起作为共同的输入。

> [!question] **题目 (`37814b8207d7b669afa14a1d28fc646.jpg` - a, b)**
> (a) 当图2(a)中的二极管D1导通时，ID的值是多少？...
> (b) 确定图2(b)中配置的真值表...

> [!answer] **(a) 解答**:
> 当二极管被视作短路时，它相当于一根没有电阻的导线。根据欧姆定律 `I = V / R`，流过电路的电流 `ID` 为：`ID = Vin / R1 = 5V / 1kΩ = 5 mA`。

> [!answer] **(b) 解答**:
> 这个电路是一个**与非门 (NAND Gate)**。其真值表为：当且仅当输入A和B都为1时，输出Vo为0；其他情况下，输出Vo均为1。
> | A | B | Vo |
> | :-: | :-: | :-: |
> | 0 | 0 | **1** |
> | 0 | 1 | **1** |
> | 1 | 0 | **1** |
> | 1 | 1 | **0** |

> [!question] **题目 (`187e9b4346b0b1054fdf807148c4f62.jpg` - c)**
> (c) BJT和MOSFET的主要区别是什么？

> [!answer] **解答**:
> **BJT**是**电流控制器件**，输入阻抗低。**MOSFET**是**电压控制器件**，输入阻抗极高。MOSFET的功耗更低，集成度更高，是现代数字IC的主流技术。

---

### Ⅲ. ADC / DAC (模数/数模转换)

> [!info]
> 这部分涉及ADC/DAC的应用、功能及相关计算。

> [!question] **题目 (`187e9b4346b0b1054fdf807148c4f62.jpg` - a, b)**
> (a) 描述四种需要模数转换（ADC）的应用。
> (b) Sigma-Delta架构如何工作，其优势是什么？

> [!answer] **(a) 解答**:
> 1. **数字温度计**；2. **麦克风/音频录制**；3. **数码相机**；4. **医疗设备**（如心电图ECG）。

> [!answer] **(b) 解答**:
> Sigma-Delta ADC通过**过采样**和**噪声整形**技术工作。它以极高的频率对信号进行低位量化，再通过数字滤波输出高精度结果。其**优势**是：**高分辨率/高精度**、**高抗噪性**和**低成本**。

> [!question] **题目 (`6fb51f694270468d30f20cdd20024c2.jpg` - c)**
> (i) 在 `parm1 = parm2;` ...
> (ii) 在 `parm1 = 0.5;` ...
> (iii) 在 `parm3 = parm2;` ...
> (iv) 在 `parm3 = 0.5;` ...

> [!answer] **(i) 解答**: 是的，发生了**ADC**（读取`parm2`）和**DAC**（写入`parm1`）转换。
> **(ii) 解答**: 是的，发生了**DAC**转换。
> **(iii) 解答**: 是的，发生了**ADC**转换（读取`parm2`）。
> **(iv) 解答**: 没有发生转换。`parm3`是`DigitalOut`，赋值`0.5`会被转换为布尔值`true`，最终引脚输出高电平。

> [!question] **题目 (`572f03638c49d33379c2b66bc576031.jpg` - iii)**
> 在一个...4位DAC系统中，当Vref=5V时，将二进制数1101转换为模拟输出。

> [!answer] **解答**:
> `(1101)₂ = 13`。`Vout = 5V * (13 / 2⁴) = 5V * (13 / 16) = 4.0625V`。

> [!question] **题目 (`9b89f6e2b6dcc2e001acc92402d13e7.jpg` - ii, iii)**
> (ii) Nucleo L432KC微控制器的ADC位深是多少？
> (iii) 给定3.6V的...参考电压，步长电压是多少？

> [!answer] **(ii) 解答**:
> 通常是**12位**。
> **(iii) 解答**:
> 步长 = Vref / 2ⁿ = 3.6V / 2¹² = 3.6V / 4096 ≈ **0.879 mV**。

---

### Ⅳ. 通信协议与PWM

> [!info]
> 这部分考察了对不同串行通信协议的理解和应用。

> [!question] **题目 (`d0a01795b814ad0e51c35b7c130272e.jpg`)**
> (iii) 描述UART通信中奇偶校验位的作用。

> [!answer] **解答**:
> **奇偶校验位 (Parity Bit)** 在UART通信中扮演着**简单错误检测**的角色。它确保整个数据帧中`1`的总个数符合预设的奇校验或偶校验规则，用于检测单个比特位的传输错误。

> [!question] **题目 (`60755963e16588cc4c20ce51386b848.jpg` - a & `e60a368919865cb24a46c96c61c0e3c.jpg` - a)**
> (a) 一个微控制器需要连接40/120个外设。你会选择SPI还是I2C？

> [!answer] **解答**:
> **首选I2C协议**。因为I2C使用地址寻址，无论多少设备都只需要2根线。而标准SPI需要为每个设备提供独立的片选线，连接大量设备将耗费巨量GPIO引脚，在物理上不可行。

> [!question] **题目 (`ccca2b85af568f544e236748531a66c.jpg` - c)**
> (c) UART...发送...`0x13`...1kHz...3.3V...LSB优先...

> [!answer] **解答**:
> - **数据**: `0x13 = (00010011)₂`。LSB优先，发送顺序为 `11001000`。
- **波形**: `Start(0) -> 1 -> 1 -> 0 -> 0 -> 1 -> 0 -> 0 -> 0 -> Stop(1)`。每个比特持续 `1/1kHz = 1ms`。

> [!question] **题目 (`1bf758f8a87493b5523264aa5938d55.jpg` - c)**
> (c) SPI...发送...`0x4A`...10MHz...MSB优先...SPI Mode 0。

> [!answer] **解答**:
> (i) **时钟周期**: `T = 1 / f = 1 / (10 MHz) = 100 ns`。
> (ii) **波形图**:
> - **数据**: `0x4A = (01001010)₂`。MSB优先，发送顺序为 `0,1,0,0,1,0,1,0`。
> - **Mode 0**: 时钟空闲为低，在**上升沿**采样数据。
> - **波形**: CS全程为低。SCLK产生8个周期为100ns的脉冲。MOSI在第一个上升沿前为`0`，在第二个上升沿前变为`1`，以此类推。

> [!question] **题目 (`4e283b5b5b11c873bcd2758c2d5dd13.jpg` - a, c)**
> (a) PWM...100Hz...20%...5V...
> (c) 控制LED亮度和驱动扬声器播放曲调，周期和占空比是固定的还是可变的？

> [!answer] **(a) 解答**:
> (i) 周期 `T = 1 / 100Hz = 0.01s = 10ms`。
> (ii) 脉冲宽度 `t_on = D * T = 0.20 * 10ms = 2ms`。
> (iii) 平均电压 `V_avg = D * V_peak = 0.20 * 5V = 1V`。
> (iv) 波形图为一个周期为10ms，其中前2ms为5V高电平，后8ms为0V低电平的方波。
>
> **(c) 解答**:
> (i) **控制LED亮度**: **周期固定**，**占空比可变**。
> (ii) **驱动扬声器播放曲调**: **周期可变**（改变音高），**占空比通常固定**在50%。

---

### Ⅴ. 嵌入式C编程

> [!info]
> 这部分考察了Mbed平台的C++编程基础。

> [!question] **题目 (`96f0d65eb4897937f03a4f26b1e372a.jpg` - Q1c)**
> (i) 写出7段数码管显示器的输出
> (ii) 修改SWITCH语句以显示从3到0的计数

> [!answer] **(i) 解答**:
> 根据表格，`case 0, 1, 2, 3` 分别对应 `0x7D, 0x07, 0x6D, 0x06`，所以7段数码管会依次显示 **6, 7, 5, 1**。
>
> **(ii) 解答**:
> ```cpp
> switch(i) {
>     case 0: display = 0x6F; break; // Display 3
>     case 1: display = 0x5B; break; // Display 2
>     case 2: display = 0x06; break; // Display 1
>     case 3: display = 0x3F; break; // Display 0
> }
> ```

> [!question] **题目 (`ed2176e43ef5542b1f9fe67afb860ee.jpg` - b, c)**
> (b) 找出代码中的5个错误并改正...
> (c) 编写代码以显示图中的波形...

> [!answer] **(b) 解答**:
> 1. `DigitalOut myled(D6);` 应该在`main`函数外部定义。
> 2. `yourled=0;` 应该在`while`循环外部初始化。
> 3. `wait(0.2);` 应该使用 `ThisThread::sleep_for(200ms);`。
> 4. `myled=0;` 后面缺少延时，导致亮的效果看不见。
> 5. `main`函数应有返回值，在最后加上 `return 0;`。
>
> **(c) 解答**:
> ```cpp
> #include "mbed.h"
> DigitalOut D5(D5);
> Timer t;
> 
> int main() {
>     t.start();
>     while(t.read() < 3.0) {
>         D5 = 1;
>         ThisThread::sleep_for(250ms); // 25% of 1s period
>         D5 = 0;
>         ThisThread::sleep_for(750ms); // 75% of 1s period
>     }
> }
> ```

> [!question] **题目 (`ccca2b85af568f544e236748531a66c.jpg` & `0198a9d3d3490fba0a80777a9b9ab6a.jpg`)**
> 分析SPI主从通信代码。

> [!answer] **解答**:
> - `SPI ser_port(A6, A5, A4);`: 初始化SPI接口，将A6设为MOSI, A5设为MISO, A4设为SCLK。
> - `while(1)`: 创建一个无限循环，让主程序持续运行。
> - `|` 是**按位或**运算符。`switch_word | 0x01` 的结果是将 `switch_word` 的最低位置为1。
> - `wait(0.01)` 改为 `25ms`: `ThisThread::sleep_for(25ms);`。
> - `==` 是**比较**运算符，用于判断两个值是否相等。`=` 是**赋值**运算符，用于将右边的值赋给左边的变量。







