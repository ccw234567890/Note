![[Pasted image 20250812143723.png]]
![[屏幕截图 2025-08-12 143826.png]]
![[屏幕截图 2025-08-12 143843.png]]

![[屏幕截图 2025-08-12 143854.png]]

![[屏幕截图 2025-08-12 143907.png]]

![[屏幕截图 2025-08-12 143931.png]]

![[屏幕截图 2025-08-12 143941.png]]

![[屏幕截图 2025-08-12 143952.png]]

![[屏幕截图 2025-08-12 144005.png]]

![[屏幕截图 2025-08-12 144019.png]]

![[屏幕截图 2025-08-12 144029.png]]

![[屏幕截图 2025-08-12 144040.png]]

![[屏幕截图 2025-08-12 144055.png]]

![[屏幕截图 2025-08-12 144107.png]]

![[屏幕截图 2025-08-12 144119.png]]

![[屏幕截图 2025-08-12 144127.png]]

![[屏幕截图 2025-08-12 144137.png]]

![[屏幕截图 2025-08-12 144145.png]]

![[屏幕截图 2025-08-12 144155.png]]

![[屏幕截图 2025-08-12 144205.png]]

![[屏幕截图 2025-08-12 144212.png]]

![[屏幕截图 2025-08-12 144223.png]]
# 笔记：MUX/DEMUX原理与在处理器中的应用

> [!abstract] 核心纲要
> 本笔记旨在深入剖析**多路复用器 (MUX)** 与**多路解复用器 (DEMUX)** 的核心原理及其在计算机系统中的关键应用。我们将重点关注：
> 1.  **MUX (多路复用器)**: “多选一”数据选择器的功能与逻辑门实现。
> 2.  **DEMUX (多路解复用器)**: “一分多”数据分配器的功能与逻辑门实现。
> 3.  **核心应用**: 详细解析MUX和DEMUX是如何在**处理器（CPU）**内部实现操作数选择和结果路由，以及它们在**内存系统**中的作用。

---

### Ⅰ. 多路复用器 (Multiplexer, MUX) - “数据选择器”

> [!info]
> - **功能**: **多选一 (Many-to-One)**。MUX是一个数字开关，它有 `2ⁿ` 条数据输入线、`n` 条选择线和一个单一的输出线。
> - **工作原理**: 通过 `n` 条**选择线**上的二进制值（地址），来决定将**哪一条**数据输入线连接到唯一的输出线上。

> [!example] **4x1 MUX的内部逻辑实现**
> > - **组件**: 一个4x1 MUX通常由**4个与门 (AND)**、**1个或门 (OR)** 和 **2个非门 (NOT)** 构成。
> > - **工作流程**:
> >   1. **地址解码**: 2条选择线 `s1, s0` 和它们的反向信号，共同构成了一个“地址解码”网络。对于`s1,s0`的任何一个组合（如`10`），**只有**一个对应的与门会被“使能”（允许通过）。
> >   2. **数据选通**: 被使能的那个与门，会将其对应的数据输入线（如`I₂`）上的值传递出去；而所有其他未被使能的与门，输出都为`0`。
> >   3. **输出汇总**: 最终，所有与门的输出汇集到一个或门。因为只有一个与门的输出可能为`1`，所以或门的输出就等于那条被选中的数据输入线的值。
> >
> >

---

### Ⅱ. 多路解复用器 (Demultiplexer, DEMUX) - “数据分配器”

> [!help]
> - **功能**: **一分多 (One-to-Many)**。DEMUX执行与MUX相反的操作，它有一个单一的数据输入线、`n` 条选择线和 `2ⁿ` 条输出线。
> - **工作原理**: 通过 `n` 条**选择线**上的二进制值（地址），来决定将那条**单一的输入数据**发送到**哪一条**输出线上去。

> [!tip] **1x4 DEMUX的内部逻辑实现**
> > - **组件**: 一个1x4 DEMUX的结构与 **2x4译码器 (Decoder)** 非常相似，可以理解为一个**带有“使能”端**的译码器。
> > - **工作流程**:
> >   1. **地址选择**: 选择线 `a, b` 首先像译码器一样，选中**唯一一条**将要输出的路径。
> >   2. **数据传输**: 单一的数据输入 `F` 充当了所有与门的“总开关”。如果 `F=1`，则被选中的那条输出线输出`1`；如果 `F=0`，则所有输出线都为`0`。
> >
> > 

---

### Ⅲ. 实际应用：MUX/DEMUX 在处理器与内存中的角色

> [!success]
> 这些简单的“选择器”和“分配器”是构建复杂计算机系统的核心骨架。

> [!cite] **1. 在处理器 (Processor) 内部**
> > 下图展示了一个简化的处理器数据通路，MUX和DEMUX在其中扮演着“**数据调度总管**”的角色。
> >
> >
> >
> > - **操作数选择 (MUX)**:
> >   - 处理器中的算术逻辑单元 (ALU) 需要从多个寄存器 (`In₀` - `In₃`) 中选择两个作为输入。
> >   - 图中左侧的**两个MUX**就负责这个任务。控制信号 `SRC1` 和 `SRC2`（即选择线）决定了哪两个寄存器的值被送到ALU进行计算。
> > - **结果路由 (DEMUX)**:
> >   - ALU计算完成后，其**单一的结果**需要被存回到多个目标寄存器 (`Out₀` - `Out₃`) 中的**某一个**。
> >   - 图中右侧的**DEMUX**就负责这个任务。控制信号 `DEST`（即选择线）决定了ALU的计算结果最终被写入哪个目标寄存器。
> >
> > **示例**: `Add In₀ and In₃ and send to Out₂`
> > - MUX 1的选择信号设为 `00`，选中 `In₀`。
> > - MUX 2的选择信号设为 `11`，选中 `In₃`。
> > - ALU的控制信号设为“加法”。
> > - DEMUX的选择信号设为 `10`，将ALU的加法结果路由到 `Out₂`。

> [!cite] **2. 在内存 (Memory) 系统中**
> > - **写入内存 (Write)**: 当CPU要向内存写入数据时，**译码器 (Decoder)** 会根据CPU提供的地址，在成千上万个存储单元中**选中唯一一个**。**多路解复用器 (DEMUX)** 则负责将CPU数据总线上的数据，准确地**分配**到这个被选中的存储单元中。
> > - **读取内存 (Read)**: 当CPU要从内存读取数据时，**多路复用器 (MUX)** 负责从成千上万个存储单元中，**选择**出那个地址被指定的单元的数据，并将其**传送**到CPU的数据总线上。

# 笔记：PWM的生成方法与计算实例

> [!abstract] 核心纲要
> 本笔记旨在深入剖析**脉冲宽度调制 (PWM)** 的生成方法与核心参数计算。我们将重点关注：
> 1.  **PWM的生成方法**: 详细对比**模拟电路（比较器法）**和**数字电路（微控制器法）**两种实现方式。
> 2.  **MCU数字生成**: 进一步比较**软件模拟 (GPIO)** 与**硬件模块 (Timer)** 两种数字生成方式的优劣。
> 3.  **PWM参数计算**: 通过四个全面的实例，熟练掌握**周期、频率、占空比、高/低电平时间**和**平均电压**之间的换算关系。

---

### Ⅰ. PWM信号的生成方法

#### 1. 模拟电路生成法 (Analog Generation)

> [!example] **比较器法 (Comparator Circuit)**
> > - **原理**: 这是最简单的模拟生成方法，核心是一个**比较器 (Comparator)**。
> > - **输入**:
> >   1. 一个周期性的**三角波**（或锯齿波）信号。
> >   2. 一个稳定可调的直流**控制电压 (`V_control`)**。
> > - **工作流程**:
> >   - 当**三角波**的瞬时电压 **>** `V_control` 时，比较器输出**高电平**。
> >   - 当**三角波**的瞬时电压 **<** `V_control` 时，比较器输出**低电平**。
> > - **占空比控制**: 通过**改变 `V_control` 的电压高低**，就可以改变输出信号中高电平的持续时间，从而精确地**调节脉冲的宽度（占空
> > 比）**。例如，降低 `V_control` 会使输出脉冲变宽（占空比增大）。
> >
> >

#### 2. 数字生成法 (Digital Generation)

> [!info]
> 现代电子系统中，PWM信号通常由**微控制器 (Microcontroller)** 来生成。主要有两种方式：

> [!danger] **方法一：软件模拟 (使用通用I/O引脚 - GPIO)**
> > - **原理**: 完全依靠CPU执行代码，在一个循环中**手动**控制一个GPIO引脚的电平。流程是：`拉高引脚 -> 软件延时(t_on) -> 拉低引脚 -> 软件延时(t_off) -> 循环`。
> > - **缺点**:
> >   - **效率极低**: CPU被完全占用，一直在“无所事事地”等待和翻转引脚电平，无法执行其他更重要的任务。
> >   - **资源利用不足**: 整个处理器的资源都被用于生成一个简单的波形。

> [!success] **方法二：硬件模块 (使用专用Timer/PWM资源)**
> > - **原理**: **这是现代MCU的标准做法**。MCU内部集成了专门用于生成PWM的**硬件模块**（通常基于定时器和计数器）。
> > - **工作流程**:
> >   1. **CPU进行配置**: CPU只需在开始时，向PWM模块的寄存器写入**频率**和**占空比**等参数。
> >   2. **硬件自动生成**: 配置完成后，**PWM硬件模块**就会在后台**独立、精确地**生成所需的PWM波形。
> > - **优点**:
> >   - **高效**: **CPU被完全解放**，可以去处理其他复杂的任务。
> >   - **精确**: 由硬件产生的波形，其时序非常稳定、精确，不受CPU负载变化的影响。

---

### Ⅱ. PWM核心参数计算实例

> [!help]
> 在进行计算前，我们先回顾一下四个核心公式：
> 1.  **周期与频率**: $T = 1 / f$
> 2.  **占空比**: $D = t_{on} / T$
> 3.  **周期组成**: $T = t_{on} + t_{off}$
> 4.  **平均电压**: $V_{avg} = D \times V_{peak}$

> [!check] **实例 1**
> > - **已知**: `f = 250Hz`, `D = 25%`
> > - **求**: `T` (周期) 和 `t_on` (脉冲宽度)
> > - **解**:
> >   - $T = 1 / f = 1 / 250Hz = 0.004s = 4ms$  *(注：图中kHz单位有误，应为Hz)*
> >   - $t_{on} = D \times T = 0.25 \times 4ms = 1ms$ *(注：图中μs单位有误，应为ms)*

> [!check] **实例 2**
> > - **已知**: `T = 20μs`, `D = 40%`, `V_peak = 10V`
> > - **求**: `t_on`, `t_off`, `f`, `V_avg`
> > - **解**:
> >   - $t_{on} = D \times T = 0.40 \times 20μs = 8μs$
> >   - $t_{off} = T - t_{on} = 20μs - 8μs = 12μs$
> >   - $f = 1 / T = 1 / (20 \times 10^{-6}s) = 50,000Hz = 50KHz$
> >   - $V_{avg} = D \times V_{peak} = 0.4 \times 10V = 4V$

> [!check] **实例 3**
> > - **已知**: `t_on = 6μs`, `t_off = 18μs`, `V_peak = 8V`
> > - **求**: `T`, `D`, `f`, `V_avg`
> > - **解**:
> >   - $T = t_{on} + t_{off} = 6μs + 18μs = 24μs$
> >   - $D = t_{on} / T = 6μs / 24μs = 0.25 = 25\%$
> >   - $f = 1 / T = 1 / (24 \times 10^{-6}s) \approx 41,667Hz \approx 42KHz$
> >   - $V_{avg} = D \times V_{peak} = 0.25 \times 8V = 2V$

> [!check] **实例 4**
> > - **已知**: `V_avg = 2.5V`, `V_peak = 5V`, `T = 100μs`
> > - **求**: `D`, `t_on`, `t_off`, `f`
> > - **解**:
> >   - $D = V_{avg} / V_{peak} = 2.5V / 5V = 0.5 = 50\%$
> >   - $t_{on} = D \times T = 0.5 \times 100μs = 50μs$
> >   - $t_{off} = T - t_{on} = 100μs - 50μs = 50μs$
> >   - $f = 1 / T = 1 / (100 \times 10^{-6}s) = 10,000Hz = 10KHz$

# 笔记：PWM的应用与STM32实现 (PWM Applications & STM32 Implementation)

> [!abstract] 核心纲要
> 本笔记旨在深入剖析**脉冲宽度调制 (PWM)** 的实际应用及其在**STM32微控制器**上的实现细节。我们将重点关注：
> 1.  **PWM知识回顾**: 快速回顾PWM的基本原理、关键参数和生成方法。
> 2.  **STM32中的PWM实现**: 了解专用硬件定时器和多通道输出的优势。
> 3.  **PWM的广泛应用**: 详细解析PWM如何在**DC-AC逆变器**、**直流电机控制**和**电池充电器**等领域发挥关键作用。

---

### Ⅰ. PWM 知识回顾 (Recap of Lecture)

> [!summary]
> 在深入应用之前，我们先对PWM的核心概念做一个快速回顾。
> - **基本原理 (PWM Basics)**:
>   在一个固定的**周期 (Period)**内，通过改变**脉冲宽度 (Pulse Width)**，来控制信号的**平均电压**。
> - **关键参数 (Key Parameters)**:
>   **占空比 (Duty Cycle)**、**频率 (Frequency)** 以及**高/低电平时间 (ON/OFF Times)**共同定义了PWM的行为和效果。
> - **生成方法 (Generation Methods)**:
>   可以通过**模拟电路（比较器）**或**数字方式（微控制器定时器）**来实现。
> - **核心应用 (Applications)**:
>   因其高效的功率控制能力，广泛用于**逆变器、电机驱动、LED/显示器调光**和**电池充电器**。

---

### Ⅱ. 在STM32微控制器上的实现

> [!info]
> 现代微控制器如STM32，都内置了强大的**专用硬件模块**来高效地生成PWM信号。

> [!check] **1. 专用PWM引脚 (Dedicated Pins)**
> > STM32拥有专门用于输出PWM信号的引脚。使用这些引脚，可以由硬件直接生成稳定、精确的PWM波形，而无需CPU的持续干预。

> [!tip] **2. 定时器与多通道输出 (Timer & Multi-Channel Output)**
> > - **核心**: STM32的PWM功能通常由其内部的**高级或通用定时器 (Timer)** 模块来驱动。
> > - **多通道**: 一个**单一的定时器**通常可以控制**多个独立的PWM输出通道**（例如4个、6个或更多）。
> > - **关键特性**: 由**同一个定时器**生成的所有PWM信号，它们会共享**相同的周期（即频率）**。但是，**每一个通道的占空比都可以被独立设置**。
> >
> > **这非常有用**：例如，在控制一个多轴无人机时，你可以用一个定时器来设定所有电机PWM信号的基准频率（如400Hz），然后通过独立调节每个通道的占空比，来精确控制每一个电机的转速。

---

### Ⅲ. PWM 的核心应用详解

> [!example]
> PWM技术的核心在于其**高效的功率调节能力**，使其在许多领域成为首选方案。

> [!success] **1. 逆变器 (Inverters - DC to AC)**
> > - **目标**: 将**直流电 (DC)**（如电池、太阳能电池板）转换成**交流电 (AC)**（如家用插座的220V正弦波）。
> > - **PWM的魔力：模拟正弦波**:
> >   1. 逆变器通过高速开关（如MOSFET），将输入的直流电压快速地“**接通**”和“**断开**”。
> >   2. 通过**动态地、精细地调节每一次开关脉冲的宽度（占空比）**，可以使得输出电压的**“局部平均值”**随着时间的变化，完美地**模拟出一条平滑的正弦曲线**。
> > - **图中示例**:
> >   - **Desired (期望波形)**: 我们想要生成的平滑正弦波。
> >   - **Actual (实际输出)**: PWM电路实际输出的方波信号。在正弦波的**峰顶**和**谷底**，脉冲**最宽**（占空比接近100%）；在正弦波穿过**零点**的位置，脉冲**最窄**（占空比接近0%）。
> >
> > 经过一个低通滤波器后，这个PWM方波就可以被平滑成我们需要的正弦交流电。
> >
> > 

> [!check] **2. 直流电机控制 (DC Motor Control)**
> > - **原理**: 直流电机的**转速**与其两端所加的**平均电压**近似成正比。
> > - **应用**: 通过向电机驱动器发送一个PWM信号，我们可以通过改变**占空比**来精确地调节施加在电机上的平均电压，从而实现平滑、高效的**速度控制**。占空比越高，平均电压越高，电机转速越快。

> [!check] **3. 电池充电器 (Battery Chargers)**
> > - **原理**: 现代的“智能”电池充电器（如锂电池充电器）需要精确地控制充电过程的不同阶段（如恒流、恒压、涓流）。
> > - **应用**: PWM是实现这种精确控制的理想技术。充电器通过调节PWM的占空比，可以非常灵活、高效地控制输送给电池的**充电电流和电压**，从而确保充电过程安全、高效，并延长电池寿命。