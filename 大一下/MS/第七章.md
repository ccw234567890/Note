![[83a26362b2898979e806053aa394604.jpg]]
![[99f551c499def890048a75e2615ef59.jpg]]
![[baaad3be4521ee494a5e2af28335d64.jpg]]
![[9d0591ce7921b3fbe39aed7fca44161.jpg]]

# 笔记：存储器与存储架构 (Memory and Memory Architecture)

> [!abstract] 核心纲要
> 本笔记旨在深入剖析计算机系统中存储器的核心概念、层级结构与组织方式。我们将重点关注：
> 1.  **存储器的基本原理**: 了解内存的定义、核心术语（位、字节、字、地址）以及基本操作。
> 2.  **存储器的两大类型**: 详细对比**RAM（易失性）**与**ROM（非易失性）**家族及其演进。
> 3.  **存储器层级结构 (Memory Hierarchy)**: 理解计算机为何采用金字塔式的多级存储体系。
> 4.  **两种核心存储架构**: 对比**冯·诺依曼架构**与**哈佛架构**的根本区别。
> 5.  **实例解析**: 以**Cortex-M4**为例，了解现代微控制器的内存是如何被映射和组织的。

---

### Ⅰ. 存储器的基本原理

> [!info]
> - **定义**: 存储器（内存）是计算机中用于存放数据和指令的物理设备。
> - **核心术语**:
>   - **存储单元 (Memory Cell)**: 存储1位（bit）信息的基本电路。
>   - **字节 (Byte)**: 8个比特构成的标准单位。
>   - **存储字 (Memory Word)**: CPU一次处理的标准数据块，通常为8到64位。
>   - **地址 (Address)**: 每个存储位置的唯一标识符。
> - **基本操作**:
>   - **读操作 (Read / Fetch)**: 从内存中检索数据。
>   - **写操作 (Write / Store)**: 将数据存入内存。

---

### Ⅱ. 存储器的两大类型：RAM vs. ROM

> [!help]
> 存储器根据其断电后能否保存数据（易失性），可分为RAM和ROM两大“家族”。

> [!tip] **1. 随机存取存储器 (Random Access Memory, RAM) - 易失性**
> > - **特点**: **断电后数据丢失**。是计算机的“**临时工作台**”。
> > - **分类**:
> >   - **静态RAM (SRAM)**: 只要有电就保持数据，**无需刷新**。速度极快、功耗高、成本昂贵，主要用于**CPU高速缓存 (CPU Cache)**。
> >   - **动态RAM (DRAM)**: 需要**周期性刷新**来维持数据。速度较慢、集成度高、成本低廉，主要用于**计算机主存（内存条）**。

> [!success] **2. 只读存储器 (Read-Only Memory, ROM) - 非易失性**
> > - **特点**: **断电后数据保留**。是计算机的“**永久说明书**”。
> > - **技术演进**:
> >   - **ROM**: 出厂时写入，无法修改。
> >   - **PROM**: 用户可**编程一次**。
> >   - **EPROM**: 可通过**紫外线**擦除后重写。
> >   - **EEPROM / Flash**: 可通过**电信号**擦除和重写，是现代非易失性存储的主流技术。

---

### Ⅲ. 存储器层级结构 (Memory Hierarchy)

> [!example]
> 计算机通过一个金字塔式的多级存储体系，来平衡**速度、容量和成本**这三者之间的矛盾。



> [!summary] **从金字塔顶端到底部**
> - **速度 (Speed)**: **越来越慢**。
> - **容量 (Capacity)**: **越来越大**。
> - **每比特成本 (Cost)**: **越来越低**。
>
> **层级分布**:
> 1. **CPU寄存器 (CPU Registers)**: 最快，最小，最贵。
> 2. **CPU缓存 (CPU Cache - SRAM)**: 极快，很小，昂贵。
> 3. **主存 (Main Memory - DRAM)**: 较快，较大，价格适中。
> 4. **闪存/本地存储 (Flash/Local Storage)**: 慢，巨大，便宜。（**非易失性**）
> 5. **外部存储 (External Storage)**: 最慢，容量极大，最便宜。（**非易失性**）

---

### Ⅳ. 两种核心存储架构

> [!question]
> CPU如何组织和访问存放“指令”和“数据”的内存？主要有两种设计哲学。

> [!note] **1. 冯·诺依曼架构 (von Neumann Architecture)**
> > - **特点**: **指令和数据存放在同一个存储空间中，共享同一条总线**。
> > - **优缺点**: 结构简单，但存在“冯·诺依曼瓶颈”，取指令和取数据不能同时进行。
> > - **主要应用**: **通用计算机 (Computers)**。

> [!note] **2. 哈佛架构 (Harvard Architecture)**
> > - **特点**: **将指令和数据分别存放在两个独立的存储空间中，并为它们配备各自专用的总线**。
> > - **优缺点**: 性能更高，可同时取指令和取数据。
> > - **主要应用**: **微控制器 (Microcontrollers)** 和数字信号处理器 (DSP)。

---

### Ⅴ. 实例解析：Cortex-M4 内存映射

> [!cite]
> **内存映射 (Memory Mapping)** 是将芯片上所有组件（内存、外设等）都分配到同一个地址空间的技术。ARM Cortex-M4处理器就采用了这种方式，其32位地址总线可寻址4GB的空间，被划分为九个主要区域（图中简化为6个）。
> - **代码区 (Code)**: 存放程序，通常是Flash。
> - **SRAM区**: 存放运行时数据。
> - **外设区 (Peripheral)**: 将GPIO、ADC、定时器等所有外设的控制寄存器映射到这里，使得CPU可以像读写内存一样来控制外设。
> - **外部RAM/设备区 (External RAM/Devices)**: 用于连接片外扩展的存储器。
> - **系统区 (System)**: 存放NVIC等系统核心组件。