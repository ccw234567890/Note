---
cssclass: "kanban"
---

# 第三章：随机变量与分布

> [!info] 本章内容概览
> - **3.1 随机变量与离散分布**
> - **3.2 连续分布**
> - **3.3 累积分布函数**
> - **3.4 二元分布**
> - **3.5 边缘分布**
> - **3.6 条件分布**
> - **3.7 多元分布**
> - **3.8 单个随机变量的函数**
> - **3.9 两个或多个随机变量的函数**
> - **3.10 马尔可夫链**

---

## 3.1 随机变量与离散分布

随机变量是在统计分析中用于建模未知量的主要工具。对于每个随机变量 $X$ 和任意实数集合 $C$，我们可以计算 $X$ 取值于 $C$ 内的概率。所有这些概率的集合构成了 $X$ 的**分布**。分布主要分为两类：离散分布和连续分布。

> [!abstract] -t "定义 3.1.1：随机变量"
> 设 $S$ 为一个实验的样本空间。在 $S$ 上定义的一个**实值函数**被称为**随机变量**。
>
> 换言之，随机变量是一个定义在样本空间上的实值函数。

> [!example] -t "例子 3.1.1：抛硬币"
> **情景**: 考虑一个抛掷一枚均匀硬币10次的实验。
> **样本空间**: 样本空间 $S$ 包含 $2^{10}$ 种不同的、由10次正面（H）和/或反面（T）组成的序列。
> **随机变量**: 我们可能对结果中出现正面的次数感兴趣。我们可以让 $X$ 代表一个定义在 $S$ 上的实值函数，用来计算每个结果中正面的数量。
> - 例如，如果结果 $s$ 是序列 HHTTTHTTTH，那么 $X(s) = 4$。
> - 对于每个由10次正面和/或反面组成的可能序列 $s$，值 $X(s)$ 等于序列中正面的数量。
> - 函数 $X$ 的可能取值是 0, 1, ..., 10。
>
> 在这个例子中，$X$（10次抛掷中正面的数量）是一个随机变量。另一个随机变量可以是 $Y = 10 - X$，即反面的数量。

> [!example] -t "例子 3.1.2：测量身高"
> 考虑一个实验，从某个群体中随机选择一个人，并测量其身高（以英寸为单位）。这个身高就是一个随机变量。

> [!example] -t "例子 3.1.3：公共设施需求"
> **情景**: 一位承包商关心一个新办公楼对水和电的需求。样本空间由点 $(x, y)$ 组成，其中 $x$ 是水需求， $y$ 是电需求。
>
> **随机变量**:
> 1.  **水需求 $X$**: $X(s) = x$ 当 $s=(x,y)$。$X$ 的可能取值在区间 [4, 200] 内。
> 2.  **电需求 $Y$**: $Y(s) = y$ 当 $s=(x,y)$。$Y$ 的可能取值在区间 [1, 150] 内。
> 3.  **高需求指示器 $Z$**: 一个指示至少有一项需求是否为高的随机变量。设 $A$ 为水需求至少为100的事件，$B$ 为电需求至少为115的事件。定义 $Z$ 如下：
>     $$
>     Z(s) = \begin{cases} 1 & \text{if } s \in A \cup B \\ 0 & \text{if } s \notin A \cup B \end{cases}
>     $$
>     $Z$ 的可能取值是 0 和 1。

---

### 随机变量的分布

> [!abstract] -t "定义 3.1.2：分布"
> 设 $X$ 是一个随机变量。$X$ 的**分布**是对于所有实数集合 $C$（使得 $\{X \in C\}$ 是一个事件），所有形如 $Pr(X \in C)$ 的概率的集合。
>
> 符号上表示为：
> $$
> Pr(X \in C) = Pr(\{s : X(s) \in C\})
> $$

> [!example] -t "例子 3.1.4：抛硬币（续）"
> 在抛10次均匀硬币的实验中，设 $X$ 是获得的正面数。$X$ 的可能取值是 0, 1, ..., 10。
> - 由于硬币是均匀的，每个结果的概率都是 $1/2^{10}$。
> - 我们需要计算有多少个结果 $s$ 使得 $X(s)=x$。这等同于在10次抛掷中恰好有 $x$ 次是正面。
> - 这个数量等于从10次抛掷中选择 $x$ 个位置作为正面的子集数量，即 $\binom{10}{x}$。
> - 因此，概率为：
>   $$
>   Pr(X=x) = \binom{10}{x} \frac{1}{2^{10}} \quad \text{for } x=0, 1, 2, ..., 10
>   $$

> [!example] -t "例子 3.1.5：公共设施需求（续）"
> 在例子3.1.3中，事件 $A$（水需求至少100）可以表示为 $A=\{X \ge 100\}$，其概率为 $Pr(A) = 0.5102$。
> 如果 $C$ 是区间 [4, 200] 的一个子区间，那么：
> $$
> Pr(X \in C) = \frac{(150-1) \times (\text{区间 } C \text{ 的长度})}{29204}
> $$
> 例如，如果 $C$ 是区间 [50, 175]，其长度为125，则 $Pr(X \in C) = 149 \times 125 / 29204 = 0.6378$。

---

### 离散分布

> [!abstract] -t "定义 3.1.3：离散分布/随机变量"
> 如果一个随机变量 $X$ 只能取有限个（$k$ 个）不同的值 $x_1, ..., x_k$，或者至多一个无限序列的不同值 $x_1, x_2, ...$，我们说 $X$ 有一个**离散分布**，或者说 $X$ 是一个**离散随机变量**。
>
> <font color="cyan">那些可以在一个区间内取任何值的随机变量被称为具有连续分布。</font>

> [!abstract] -t "定义 3.1.4：概率函数 (p.f.) / 支撑集"
> 如果一个随机变量 $X$ 有离散分布，那么 $X$ 的**概率函数 (probability function, p.f.)** 是一个函数 $f$，对于任意实数 $x$，定义为：
> $$
> f(x) = Pr(X=x)
> $$
> 集合 $\{x : f(x) > 0\}$ 的闭包称为 $X$（或其分布）的**支撑集 (support)**。
>
> <font color="orange">注意：有些作者称其为概率质量函数 (p.m.f.)，但本书不使用该术语。</font>

> [!example] -t "例子 3.1.6：公共设施需求（续）"
> 随机变量 $Z$ 在例子3.1.3中，当至少一个需求高时取1，否则取0。由于 $Z$ 只取两个值，它有离散分布。
> - $Pr(A \cup B) = 0.65253$。
> - $Z$ 的 p.f. $f$ 是：
>   $$
>   f(z) = \begin{cases} 0.65253 & \text{if } z=1 \\ 0.34747 & \text{if } z=0 \\ 0 & \text{otherwise} \end{cases}
>   $$
> - $Z$ 的支撑集是 $\{0, 1\}$。

> [!bug] -t "定理 3.1.1：概率函数的性质"
> 设 $X$ 是一个离散随机变量，其 p.f. 为 $f$。
> 1.  如果 $x$ 不是 $X$ 的一个可能值，那么 $f(x) = 0$。
> 2.  如果序列 $x_1, x_2, ...$ 包括了 $X$ 的所有可能值，那么 $\sum_{i=1}^{\infty} f(x_i) = 1$。
> 3.  对于任意实数集 $C$，概率 $Pr(X \in C)$ 可以通过以下关系确定：
>     $$
>     Pr(X \in C) = \sum_{x \in C} f(x)
>     $$
>
> **图示**: 一个典型的p.f.图，其中垂直线段的高度代表在对应点的概率值，所有垂直线段高度之和必须为1。

---

### 几种著名的离散分布

#### 伯努利分布 (Bernoulli Distribution)

> [!abstract] -t "定义 3.1.5：伯努利分布/随机变量"
> 一个只取 0 和 1 两个值的随机变量 $Z$，如果 $Pr(Z=1) = p$，则称其服从参数为 $p$ 的**伯努利分布**。我们说 $Z$ 是一个参数为 $p$ 的**伯努利随机变量**。

> [!example]
> 例子3.1.6中的随机变量 $Z$ 服从参数为 0.65253 的伯努利分布。

#### 整数上的均匀分布 (Uniform Distributions on Integers)

> [!abstract] -t "定义 3.1.6：整数上的均匀分布"
> 设 $a \le b$ 是整数。如果一个随机变量 $X$ 的值等可能地是整数 $a, ..., b$ 中的任意一个，我们说 $X$ 服从在整数 $a, ..., b$ 上的**均匀分布**。

> [!example] -t "例子 3.1.8：每日数字彩票"
> 一种彩票游戏要求参与者选择一个三位数号码（允许前导0）。然后随机抽取三个标有数字的球。
> - 样本空间包含所有形如 $(i_1, i_2, i_3)$ 的三元组，其中 $i_j \in \{0, ..., 9\}$。
> - 定义 $X(s) = 100i_1 + 10i_2 + i_3$。
> - 对于每个整数 $x \in \{0, 1, ..., 999\}$，$Pr(X=x) = 0.001$。
> - 因此，$X$ 服从在整数 0, 1, ..., 999 上的均匀分布。

> [!bug] -t "定理 3.1.3：均匀分布的p.f."
> 如果 $X$ 服从在整数 $a, ..., b$ 上的均匀分布，其 p.f. 为：
> $$
> f(x) = \begin{cases} \frac{1}{b-a+1} & \text{for } x=a, ..., b \\ 0 & \text{otherwise} \end{cases}
> $$
> <font color="orange">注意：不可能从所有正整数集合中“随机”选择一个整数，因为无法为每个正整数分配相同的正概率，同时使它们的总和为1。</font>

> [!tip] -t "注意：随机变量可以有相同分布但不是同一个随机变量"
> 考虑连续两天的数字彩票。$X_1$ 是第一天的号码，$X_2$ 是第二天的号码。$X_1$ 和 $X_2$ 是定义在同一样本空间上的不同函数，它们很可能取不同的值。然而，它们的分布是相同的，因为它们以相同的概率取相同的值。

#### 二项分布 (Binomial Distributions)

> [!example] -t "例子 3.1.9：次品"
> **情景**: 一台机器生产次品的概率为 $p(0 < p < 1)$，生产非次品的概率为 $1-p$。假设不同产品是否为次品是相互独立的。
> **实验**: 检查 $n$ 个产品。
> **随机变量**: 令 $X$ 表示这 $n$ 个产品中次品的数量。$X$ 的可能取值是 $0, 1, ..., n$。
> - 获得一个包含 $x$ 个次品和 $n-x$ 个非次品的特定有序序列的概率是 $p^x(1-p)^{n-x}$。
> - 共有 $\binom{n}{x}$ 个这样的不同有序序列。
> - 因此，$Pr(X=x) = \binom{n}{x} p^x (1-p)^{n-x}$。

> [!abstract] -t "定义 3.1.7：二项分布/随机变量"
> 由以下 p.f. 表示的离散分布称为参数为 $n$ 和 $p$ 的**二项分布**：
> $$
> f(x) = \begin{cases} \binom{n}{x} p^x (1-p)^{n-x} & \text{for } x=0, 1, ..., n \\ 0 & \text{otherwise} \end{cases}
> $$
> 服从该分布的随机变量被称为参数为 $n$ 和 $p$ 的**二项随机变量**。

> [!tip] -t "二项分布的应用"
> 考虑一个由 $n$ 次独立重复试验组成的实验，每次试验只有两种可能的结果，通常称为“成功”和“失败”。如果每次试验成功的概率为 $p$，那么成功试验的总次数将服从参数为 $n$ 和 $p$ 的二项分布。
>
> **重要说明**: 当被问及一个随机变量的分布是什么时，必须给出完整的名称，包括所有参数的值（例如，“参数为10和1/2的二项分布”），仅仅说“二项分布”或“离散分布”是不充分的。

---

### 总结

-   **随机变量**: 定义在样本空间上的实值函数。
-   **分布**: 随机变量取值于实数集子集的概率集合。
-   **离散随机变量**: 只能取至多可数个值的随机变量。其分布由**概率函数 (p.f.)** $f(x) = Pr(X=x)$ 刻画。
-   **著名离散分布**:
    -   **伯努利分布**: 参数为 $p$。二项分布在 $n=1$ 时的特例。
    -   **整数上的均匀分布**: 在有限整数集上取值概率相等。
    -   **二项分布**: 参数为 $n$ 和 $p$，描述了 $n$ 次独立伯努利试验中成功的次数。

---

## 3.2 连续分布

本节关注那些可以在一个区间（有界或无界）内取任何值的随机变量。

> [!abstract] -t "定义 3.2.1：连续分布/随机变量"
> 如果存在一个定义在实数线上的非负函数 $f$，使得对于任意实数区间（有界或无界），随机变量 $X$ 取值于该区间的概率是 $f$ 在该区间上的积分，那么我们说 $X$ 有一个**连续分布**，或者说 $X$ 是一个**连续随机变量**。
>
> 对于任意有界闭区间 $[a, b]$:
> $$
> Pr(a \le X \le b) = \int_a^b f(x) dx
> $$

> [!abstract] -t "定义 3.2.2：概率密度函数 (p.d.f.) / 支撑集"
> 如果 $X$ 有一个连续分布，则定义3.2.1中描述的函数 $f$ 被称为 $X$ 的**概率密度函数 (probability density function, p.d.f.)**。集合 $\{x : f(x) > 0\}$ 的闭包被称为 $X$（或其分布）的**支撑集 (support)**。

> [!bug] -t "p.d.f.的性质"
> 每个 p.d.f. $f$ 必须满足以下两个要求：
> 1.  $f(x) \ge 0$ 对于所有 $x$。
> 2.  $\int_{-\infty}^{\infty} f(x) dx = 1$。
>
> 曲线下的总面积必须为1，$Pr(a \le X \le b)$ 的值等于曲线下从 $a$ 到 $b$ 的区域面积。

> [!tip] -t "重要提示"
> -   **连续分布对单点赋值为0**: 如果 $X$ 有连续分布，则对于任意数值 $a$，$Pr(X=a)=0$。这并不意味着 $X=a$ 是不可能的，而是概率被“稀薄地”分布在非退化区间上。
> -   **p.d.f.的非唯一性**: p.d.f. 的值可以在有限个点或某些无限序列的点上改变，而不会改变任何涉及 $X$ 的概率。通常我们选择在可能的情况下最自然的连续版本。

---

### 几种著名的连续分布

#### 区间上的均匀分布 (Uniform Distributions on Intervals)

> [!abstract] -t "定义 3.2.3：区间上的均匀分布"
> 设 $a$ 和 $b$ 是两个给定的实数，且 $a < b$。如果已知 $a \le X \le b$，并且对于 $[a, b]$ 的任意子区间， $X$ 属于该子区间的概率与该子区间的长度成正比，则称随机变量 $X$ 服从在区间 $[a, b]$ 上的**均匀分布**。
>
> 这通常被描述为“从区间 $[a, b]$ 中随机选择一个点”。

> [!bug] -t "定理 3.2.1：均匀分布的p.d.f."
> 如果 $X$ 服从在区间 $[a, b]$ 上的均匀分布，则 $X$ 的 p.d.f. 是：
> $$
> f(x) = \begin{cases} \frac{1}{b-a} & \text{for } a \le x \le b \\ 0 & \text{otherwise} \end{cases}
> $$

> [!tip] -t "密度不是概率"
> p.d.f. 的值 $f(x)$ 本身可以大于1（例如当 $b-a < 1$ 时）。p.d.f. 本身不等于 $X$ 在 $x$ 附近的概率，$f$ 在 $x$ 附近值的积分才给出该概率，且积分值永远不会大于1。

> [!example] -t "例子 3.2.3：不完全指定的p.d.f."
> **问题**: 假设某个随机变量 $X$ 的p.d.f. 形式如下，求常数 $c$ 的值。
> $$
> f(x) = \begin{cases} cx & \text{for } 0 < x < 4 \\ 0 & \text{otherwise} \end{cases}
> $$
> **解**: 根据 p.d.f. 的性质 $\int_{-\infty}^{\infty} f(x) dx = 1$，我们有：
> $$
> \int_0^4 cx \, dx = 8c = 1
> $$
> 因此，$c = 1/8$。

> [!example] -t "例子 3.2.4：从p.d.f.计算概率"
> **问题**: 假设 $X$ 的 p.d.f. 如上例所示，即 $f(x) = x/8$ for $0 < x < 4$。计算 $Pr(1 \le X \le 2)$ 和 $Pr(X > 2)$。
> **解**:
> $$
> Pr(1 \le X \le 2) = \int_1^2 \frac{1}{8}x \, dx = \frac{3}{16}
> $$
> $$
> Pr(X > 2) = \int_2^4 \frac{1}{8}x \, dx = \frac{3}{4}
> $$

> [!example] -t "例子 3.2.5：无界随机变量"
> 某个电路系统中的电压 $X$ 可能是一个连续分布的随机变量，可以用以下 p.d.f. 来近似表示：
> $$
> f(x) = \begin{cases} 0 & \text{for } x \le 0 \\ \frac{1}{(1+x)^2} & \text{for } x > 0 \end{cases}
> $$
> 即使实际电压有界，这个 p.d.f. 在其取值范围内可能提供一个很好的近似。

> [!example] -t "例子 3.2.6：无界p.d.f."
> p.d.f. 的值可以大于1，甚至可以无界。例如，以下 p.d.f. 在 $x=0$ 附近是无界的：
> $$
> f(x) = \begin{cases} \frac{2}{3}x^{-1/3} & \text{for } 0 < x < 1 \\ 0 & \text{otherwise} \end{cases}
> $$
> 尽管无界，它仍然满足 p.d.f. 的两个基本性质。

---

### 混合分布 (Mixed Distributions)

> [!example] -t "例子 3.2.7：截断电压"
> 考虑例子3.2.5中的电压 $X$。一个电压表如果 $X \le 3$ 就记录实际值，如果 $X > 3$ 就记录为3。设 $Y$ 为电压表的读数。
> - 首先，$Pr(Y=3) = Pr(X \ge 3) = \int_3^\infty \frac{1}{(1+x)^2} dx = 1/4$。
> - 由于单点值 $Y=3$ 的概率为 $1/4$，那么 $Pr(0 < Y < 3) = 3/4$。
> - 在区间 $(0, 3)$ 内，$Y=X$，所以这 $3/4$ 的概率根据 $X$ 的 p.d.f. 分布在该区间上。
> - 因此，$Y$ 的分布是区间 $(0, 3)$ 上的 p.d.f. 和点 $Y=3$ 上的正概率的组合。

---

### 总结

-   **连续分布**: 由其**概率密度函数 (p.d.f.)** $f$ 刻画。
-   **p.d.f.**: 一个非负函数，其在任意区间 $[a,b]$ 上的积分为 $Pr(a \le X \le b)$。
-   **连续随机变量**: 对于任意值 $x$，$Pr(X=x)=0$。
-   **区间上的均匀分布**: p.d.f. 在一个区间 $[a, b]$ 上为常数，在区间外为0。

---

## 3.3 累积分布函数 (CDF)

无论是离散还是连续分布，都可以通过其（累积）分布函数（c.d.f.）来统一描述。

> [!abstract] -t "定义 3.3.1：累积分布函数 (c.d.f.)"
> 一个随机变量 $X$ 的**分布函数**或**累积分布函数 (cumulative distribution function, c.d.f.)** $F$ 定义为：
> $$
> F(x) = Pr(X \le x) \quad \text{for } -\infty < x < \infty
> $$
> 这个定义对任何随机变量（离散、连续或混合）都适用。

> [!example] -t "例子 3.3.1：电压的c.d.f."
> 对于例子3.2.5中的电压 $X$，其p.d.f.为 $f(x)=1/(1+x)^2$ for $x>0$。其c.d.f. $F(x)$ 为：
> $$
> F(x) = Pr(X \le x) = \int_{-\infty}^x f(y) dy = \begin{cases} 0 & \text{for } x \le 0 \\ 1 - \frac{1}{1+x} & \text{for } x > 0 \end{cases}
> $$
> 例如，$Pr(X \le 3) = F(3) = 3/4$。

> [!example] -t "例子 3.3.2：伯努利分布的c.d.f."
> 设 $X$ 服从参数为 $p$ 的伯努利分布，$Pr(X=0)=1-p$，$Pr(X=1)=p$。其c.d.f. $F$ 为：
> $$
> F(x) = \begin{cases} 0 & \text{for } x < 0 \\ 1-p & \text{for } 0 \le x < 1 \\ 1 & \text{for } x \ge 1 \end{cases}
> $$

> [!bug] -t "c.d.f.的性质"
> 1.  **非递减性 (Nondecreasing)**: 如果 $x_1 < x_2$，则 $F(x_1) \le F(x_2)$。
> 2.  **极限 (Limits)**: $\lim_{x \to -\infty} F(x) = 0$ 和 $\lim_{x \to \infty} F(x) = 1$。
> 3.  **右连续性 (Continuity from the Right)**: c.d.f. 总是右连续的，即对于任意点 $x$，$F(x) = F(x^+)$。其中 $F(x^+) = \lim_{y \to x, y>x} F(y)$。

---

### 从分布函数确定概率

> [!bug] -t "定理 3.3.1 - 3.3.4：用c.d.f.计算概率"
> -   **$Pr(X > x)$**: 对于任意值 $x$，
>     $$
>     Pr(X > x) = 1 - F(x)
>     $$
> -   **$Pr(x_1 < X \le x_2)$**: 对于任意 $x_1 < x_2$，
>     $$
>     Pr(x_1 < X \le x_2) = F(x_2) - F(x_1)
>     $$
> -   **$Pr(X < x)$**: 对于任意值 $x$，
>     $$
>     Pr(X < x) = F(x^-)
>     $$
>     其中 $F(x^-)$ 是 $F(y)$ 当 $y$ 从左侧趋近于 $x$ 时的极限。
> -   **$Pr(X = x)$**: 对于任意值 $x$，
>     $$
>     Pr(X = x) = F(x) - F(x^-)
>     $$
>     这表示在点 $x$ 处的跳跃大小。如果 $F$ 在 $x$ 处连续，则 $Pr(X=x)=0$。

---

### c.d.f. 与 p.f./p.d.f. 的关系

#### 离散分布的 c.d.f.
如果 $X$ 是一个离散随机变量，其 p.f. 为 $f(x)$，那么它的 c.d.f. $F(x)$ 是一个阶梯函数。在 $X$ 的每个可能值 $x_i$ 处，$F(x)$ 会有一个大小为 $f(x_i)$ 的跳跃，并且在两个连续的跳跃之间是常数。

#### 连续分布的 c.d.f.
> [!bug] -t "定理 3.3.5：连续分布的c.d.f.与p.d.f."
> 设 $X$ 有一个连续分布，其 p.d.f. 为 $f(x)$，c.d.f. 为 $F(x)$。
> 1.  $F(x)$ 在所有 $x$ 处都是连续的。
> 2.  $F(x) = \int_{-\infty}^x f(t) dt$。
> 3.  在所有 $f$ 连续的点 $x$ 处，$\frac{dF(x)}{dx} = f(x)$。

---

### 分位数函数 (Quantile Function)

> [!abstract] -t "定义 3.3.2：分位数/百分位数"
> 设 $X$ 是一个c.d.f.为 $F$ 的随机变量。对于每个严格介于 0 和 1 之间的 $p$，定义 $F^{-1}(p)$ 为满足 $F(x) \ge p$ 的最小 $x$ 值。
> -   $F^{-1}(p)$ 称为 $X$ 的 **$p$ 分位数 (p quantile)** 或 **$100p$ 百分位数 (100p percentile)**。
> -   定义在开区间 $(0, 1)$ 上的函数 $F^{-1}$ 称为 $X$ 的**分位数函数**。

> [!example] -t "例子 3.3.7：风险价值 (Value at Risk)"
> **情景**: 一个投资组合的管理者关心其在固定时间段内可能损失的金额。设 $X$ 为一个月内投资组合价值的变化，$Y=-X$ 为损失。
> **目标**: 找到一个值 $y_0$，使得管理者有99%的把握确信 $Y \le y_0$。这个 $y_0$ 就是 $Y$ 的0.99分位数，被称为**风险价值(VaR)**。
> -   $y_0$ 与 $X$ 的0.01分位数 $x_0$ 密切相关。$Pr(X < x_0) = 0.01$。
> -   $Pr(X < x_0) = Pr(Y > -x_0) = 1 - Pr(Y \le -x_0)$。
> -   因此，$Pr(Y \le -x_0) = 0.99$，所以 $y_0 = -x_0$。

> [!abstract] -t "定义 3.3.3：中位数/四分位数"
> -   **中位数 (Median)**: $1/2$ 分位数或50百分位数。
> -   **下四分位数 (Lower Quartile)**: $1/4$ 分位数或25百分位数。
> -   **上四分位数 (Upper Quartile)**: $3/4$ 分位数或75百分位数。

---

### 总结

-   **c.d.f.**: $F(x) = Pr(X \le x)$，对所有随机变量都有定义，是统一描述分布的方式。
-   **性质**: 非递减、右连续、极限为0和1。
-   **c.d.f.与概率**: 可用于计算任意区间的概率，跳跃点对应离散概率。
-   **c.d.f.与p.d.f.**: 对于连续分布，$F'(x) = f(x)$。
-   **分位数函数**: $F^{-1}(p)$，是c.d.f.的“反函数”，用于定位分布中的概率位置。

---

## 3.4 二元分布

本节将随机变量的分布概念推广到两个随机变量的**联合分布**。

> [!abstract] -t "定义 3.4.1：联合/二元分布"
> 设 $X$ 和 $Y$ 是随机变量。$X$ 和 $Y$ 的**联合分布 (joint distribution)** 或**二元分布 (bivariate distribution)** 是对于所有由实数对组成的集合 $C$（使得 $\{(X,Y) \in C\}$ 是一个事件），所有形如 $Pr[(X,Y) \in C]$ 的概率的集合。

### 离散联合分布

> [!abstract] -t "定义 3.4.2 & 3.4.3：离散联合分布与联合p.f."
> -   **离散联合分布**: 如果随机变量对 $(X, Y)$ 只能取有限个或至多可数个不同的可能值 $(x, y)$，则称 $X$ 和 $Y$ 有一个**离散联合分布**。
> -   **联合概率函数 (joint p.f.)**: $X$ 和 $Y$ 的联合 p.f. 是一个函数 $f$，对于xy平面上的每一点 $(x, y)$，定义为：
>     $$
>     f(x, y) = Pr(X=x \text{ and } Y=y)
>     $$

> [!bug] -t "定理 3.4.2：离散联合p.f.的性质"
> 1.  如果 $(x, y)$ 不是 $(X,Y)$ 的可能值，则 $f(x, y) = 0$。
> 2.  $\sum_{\text{所有}(x,y)} f(x, y) = 1$。
> 3.  对于任意有序对集合 $C$，$Pr[(X,Y) \in C] = \sum_{(x,y) \in C} f(x, y)$。

> [!example] -t "例子 3.4.3：家庭拥有的汽车和电视机数量"
> 设 $X$ 为一个随机选择的家庭拥有的汽车数量，$Y$ 为电视机数量。它们的联合p.f. $f(x,y)$ 由下表给出：
> 
> | x\y | 1 | 2 | 3 | 4 |
> | :--- | :---: | :---: | :---: | :---: |
> | **1** | 0.1 | 0 | 0.1 | 0 |
> | **2** | 0.3 | 0 | 0.1 | 0.2 |
> | **3** | 0 | 0.2 | 0 | 0 |
> 
> - **计算概率**: 求一个家庭至少拥有2辆车和2台电视的概率。
>   $$
>   Pr(X \ge 2 \text{ and } Y \ge 2) = f(2,2) + f(2,3) + f(2,4) + f(3,2) + f(3,3) + f(3,4) = 0 + 0.1 + 0.2 + 0.2 + 0 + 0 = 0.5
>   $$
> - **计算单个变量概率**: 求一个家庭恰好拥有1辆车的概率。
>   $$
>   Pr(X=1) = \sum_{y=1}^4 f(1,y) = 0.1 + 0 + 0.1 + 0 = 0.2
>   $$

---

### 连续联合分布

> [!abstract] -t "定义 3.4.4：连续联合分布与联合p.d.f."
> -   **连续联合分布**: 如果存在一个定义在整个xy平面上的非负函数 $f$，使得对于平面的任意子集 $C$，
>     $$
>     Pr[(X,Y) \in C] = \iint_C f(x, y) dx dy
>     $$
>     则称 $X$ 和 $Y$ 有一个**连续联合分布**。
> -   **联合概率密度函数 (joint p.d.f.)**: 函数 $f$ 称为 $X$ 和 $Y$ 的**联合p.d.f.**。

> [!bug] -t "定理 3.4.3：联合p.d.f.的性质"
> 1.  $f(x, y) \ge 0$ 对于所有 $x, y$。
> 2.  $\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f(x, y) dx dy = 1$。

> [!tip] -t "重要提示"
> -   **连续联合分布对点和线的概率**: 对于任意连续联合分布，xy平面上的任何单个点、可数个点集、以及连续函数的图像（如直线）的概率都为0。
> -   **边际连续不意味着联合连续**: 即使 $X$ 和 $Y$ 各自有连续分布，它们的联合分布也可能不是连续的。例如，如果 $Y=X$，那么 $(X, Y)$ 的所有概率都集中在直线 $y=x$ 上，其二维体积为0，所以联合分布不是连续的。

> [!example] -t "例子 3.4.7：计算归一化常数"
> **问题**: 设 $X, Y$ 的联合 p.d.f. 为 $f(x,y) = cx^2y$ 当 $x^2 \le y \le 1$ 时，否则为0。求常数 $c$。
> **解**: 支撑集 $S$ 是由 $y=x^2$ 和 $y=1$ 围成的区域。积分必须为1：
> $$
> \int_{-1}^1 \int_{x^2}^1 cx^2y \, dy \, dx = \int_{-1}^1 c x^2 [\frac{y^2}{2}]_{x^2}^1 \, dx = \int_{-1}^1 \frac{c}{2} x^2(1-x^4) \, dx = \frac{4}{21}c
> $$
> 因此 $\frac{4}{21}c=1$，解得 $c=21/4$。

---

### 混合二元分布

> [!abstract] -t "定义 3.4.5：联合p.f./p.d.f."
> 设 $X$ 是离散的，$Y$ 是连续的。如果存在一个函数 $f(x, y)$，使得对于任意实数集 $A$ 和 $B$：
> $$
> Pr(X \in A \text{ and } Y \in B) = \int_B \sum_{x \in A} f(x, y) dy
> $$
> 则称 $f$ 为 $X$ 和 $Y$ 的**联合p.f./p.d.f.**。它必须满足 $f(x,y) \ge 0$ 且对所有可能值求和/积分后结果为1。

> [!example] -t "例子 3.4.11：一个联合p.f./p.d.f."
> **问题**: 设 $X, Y$ 的联合p.f./p.d.f. 为 $f(x,y) = \frac{xy^{x-1}}{3}$ 对于 $x=1,2,3$ 和 $0<y<1$。计算 $Pr(Y \ge 1/2 \text{ and } X \ge 2)$。
> **解**:
> $$
> \sum_{x=2}^3 \int_{1/2}^1 \frac{xy^{x-1}}{3} dy = \sum_{x=2}^3 \left[ \frac{y^x}{3} \right]_{1/2}^1 = \sum_{x=2}^3 \frac{1 - (1/2)^x}{3} = \frac{1-1/4}{3} + \frac{1-1/8}{3} = 0.5417
> $$

---

### 二元累积分布函数

> [!abstract] -t "定义 3.4.6：联合c.d.f."
> 两个随机变量 $X$ 和 $Y$ 的**联合分布函数**或**联合累积分布函数 (joint c.d.f.)** $F$ 定义为：
> $$
> F(x, y) = Pr(X \le x \text{ and } Y \le y)
> $$

> [!bug] -t "定理 3.4.5：用联合c.d.f.计算矩形区域概率"
> 对于给定的 $a<b$ 和 $c<d$：
> $$
> Pr(a < X \le b \text{ and } c < Y \le d) = F(b,d) - F(a,d) - F(b,c) + F(a,c)
> $$
>
> **从联合c.d.f.推导边际c.d.f.**:
> - $X$ 的边际c.d.f. $F_1(x) = \lim_{y \to \infty} F(x, y)$。
> - $Y$ 的边际c.d.f. $F_2(y) = \lim_{x \to \infty} F(x, y)$。
>
> **从联合c.d.f.推导联合p.d.f. (连续情况)**:
> $$
> f(x,y) = \frac{\partial^2 F(x,y)}{\partial x \partial y}
> $$

---

### 总结

-   **联合分布**: 描述两个或多个随机变量同时取值的概率。
-   **离散**: 使用**联合p.f.**，$f(x,y) = Pr(X=x, Y=y)$。
-   **连续**: 使用**联合p.d.f.**，$Pr((X,Y) \in C) = \iint_C f(x,y) dx dy$。
-   **混合**: 使用**联合p.f./p.d.f.**，对离散变量求和，对连续变量积分。
-   **联合c.d.f.**: $F(x,y) = Pr(X \le x, Y \le y)$，是所有类型联合分布的统一表示。

---

## 3.5 边缘分布

通常我们从一个联合分布开始，然后想要求出其中单个随机变量的分布。这个从联合分布计算出的单个随机变量的分布称为**边缘分布**。

> [!abstract] -t "定义 3.5.1：边缘c.d.f./p.f./p.d.f."
> 假设 $X$ 和 $Y$ 有一个联合分布。
> -   通过定理3.4.5（即$F_1(x) = \lim_{y \to \infty} F(x, y)$）推导出的 $X$ 的c.d.f.称为 **$X$ 的边缘c.d.f.**。
> -   与 $X$ 的边缘c.d.f.相关联的p.f.或p.d.f.称为 **$X$ 的边缘p.f.或边缘p.d.f.**。

### 推导边缘 p.f. 或 p.d.f.

> [!bug] -t "定理 3.5.1 & 3.5.2：计算边缘p.f.和p.d.f."
> -   **离散情况 (定理 3.5.1)**: 如果 $X, Y$ 的联合p.f.是 $f$，那么 $X$ 的边缘p.f. $f_1$ 是：
>     $$
>     f_1(x) = \sum_{\text{所有 } y} f(x, y)
>     $$
>     $Y$ 的边缘p.f. $f_2$ 是：
>     $$
>     f_2(y) = \sum_{\text{所有 } x} f(x, y)
>     $$
> -   **连续情况 (定理 3.5.2)**: 如果 $X, Y$ 的联合p.d.f.是 $f$，那么 $X$ 的边缘p.d.f. $f_1$ 是：
>     $$
>     f_1(x) = \int_{-\infty}^{\infty} f(x, y) dy
>     $$
>     $Y$ 的边缘p.d.f. $f_2$ 是：
>     $$
>     f_2(y) = \int_{-\infty}^{\infty} f(x, y) dx
>     $$

> [!example] -t "例子 3.5.2：从概率表中推导边缘p.f."
> 对于例子3.4.3中的汽车和电视机数据，我们可以通过对行和列求和来得到边缘p.f.：
> 
> | x\y | 1 | 2 | 3 | 4 | **Total ($f_1(x)$)** |
> | :--- | :---: | :---: | :---: | :---: | :---: |
> | **1** | 0.1 | 0 | 0.1 | 0 | **0.2** |
> | **2** | 0.3 | 0 | 0.1 | 0.2 | **0.6** |
> | **3** | 0 | 0.2 | 0 | 0 | **0.2** |
> | **Total ($f_2(y)$)** | **0.4** | **0.2** | **0.2** | **0.2** | **1.0** |
> 
> -   $X$ 的边缘p.f.为 $f_1(1)=0.2, f_1(2)=0.6, f_1(3)=0.2$。
> -   $Y$ 的边缘p.f.为 $f_2(1)=0.4, f_2(2)=0.2, f_2(3)=0.2, f_2(4)=0.2$。
> 
> <font color="cyan">“边缘”这个名字来源于这些分布是出现在表格边缘的总计。</font>

> [!example] -t "例子 3.5.3：推导边缘p.d.f."
> **问题**: 设 $X, Y$ 的联合p.d.f.为 $f(x,y) = \frac{21}{4}x^2y$ for $x^2 \le y \le 1$。求 $X$ 和 $Y$ 的边缘p.d.f.
> **解**:
> -   **对于X**: $X$ 的取值范围是 $[-1, 1]$。对于 $-1 \le x \le 1$：
>     $$
>     f_1(x) = \int_{x^2}^1 \frac{21}{4}x^2y \, dy = \frac{21}{8}x^2(1-x^4)
>     $$
> -   **对于Y**: $Y$ 的取值范围是 $[0, 1]$。对于 $0 \le y \le 1$：
>     $$
>     f_2(y) = \int_{-\sqrt{y}}^{\sqrt{y}} \frac{21}{4}x^2y \, dx = \frac{7}{2}y^{5/2}
>     $$
> <font color="orange">注意: 仅从边缘分布无法重构联合分布，除非有额外信息。</font>

---

### 独立的随机变量 (Independent Random Variables)

> [!abstract] -t "定义 3.5.2：独立的随机变量"
> 如果对于任意两个实数集 $A$ 和 $B$（使得 $\{X \in A\}$ 和 $\{Y \in B\}$ 是事件），都满足：
> $$
> Pr(X \in A \text{ and } Y \in B) = Pr(X \in A)Pr(Y \in B)
> $$
> 那么我们说两个随机变量 $X$ 和 $Y$ 是**独立的**。

> [!bug] -t "定理 3.5.4 & 3.5.5：判断独立性的等价条件"
> -   **c.d.f. factorization (定理 3.5.4)**: $X$ 和 $Y$ 独立，当且仅当对于所有实数 $x, y$：
>     $$
>     F(x, y) = F_1(x)F_2(y)
>     $$
> -   **p.f./p.d.f. factorization (定理 3.5.5 & 推论 3.5.1)**: $X$ 和 $Y$ 独立，当且仅当对于所有 $x, y$：
>     $$
>     f(x, y) = f_1(x)f_2(y)
>     $$
>     或者更一般地，$f(x,y)$ 可以分解为 $h_1(x)h_2(y)$ 的形式，其中 $h_1$ 只依赖于 $x$，$h_2$ 只依赖于 $y$。

> [!example] -t "例子 3.5.8：判断临床试验中的变量是否独立"
> 回到临床试验数据（表格3.6），$X$ 是响应（是否复发），$Y$ 是治疗组。
> -   从边缘总计中，$f_1(1)=0.513$ (复发概率)，$f_2(1)=0.253$ (Imipramine组概率)。
> -   从表格内部，$f(1,2)=0.087$。
> -   计算乘积：$f_1(1)f_2(1) = 0.513 \times 0.253 = 0.129 \ne 0.087$。
> -   因此，$X$ 和 $Y$ 不是独立的。

> [!tip] -t "关于独立性的重要说明"
> -   **含义**: $X, Y$ 独立意味着，了解其中一个变量的值不会改变关于另一个变量的任何概率。
> -   **支撑集**: 如果一个连续联合分布的支撑集不是一个边与坐标轴平行的矩形区域，那么这两个随机变量不可能是独立的。

---

### 总结

-   **边缘分布**: 从联合分布中得到的单个随机变量的分布。通过对其他变量求和（离散）或积分（连续）得到。
-   **独立随机变量**: 两个随机变量是独立的，如果它们的联合概率等于它们各自概率的乘积。
-   **独立性判据**: 联合c.d.f. (或p.f./p.d.f.) 等于边缘c.d.f. (或p.f./p.d.f.) 的乘积。

---

## 3.6 条件分布

本节将条件概率的概念推广到**条件分布**。条件分布是在我们得知其他随机变量的值后，对未观测随机变量所使用的分布。

### 离散条件分布

> [!abstract] -t "定义 3.6.1：条件p.f./分布 (离散)"
> 设 $X, Y$ 有一个联合p.f.为 $f$ 的离散联合分布，$f_2$ 是 $Y$ 的边缘p.f.。对于每个满足 $f_2(y) > 0$ 的 $y$，定义：
> $$
> g_1(x|y) = \frac{f(x, y)}{f_2(y)}
> $$
> -   $g_1(x|y)$ 称为**给定 $Y=y$ 时 $X$ 的条件p.f.**。
> -   由p.f. $g_1(\cdot|y)$ 定义的离散分布称为**给定 $Y=y$ 时 $X$ 的条件分布**。

> [!example] -t "例子 3.6.2：从联合p.f.计算条件p.f."
> **问题**: 对于例子3.5.2中汽车和电视机的数据，求给定 $X=2$ 时 $Y$ 的条件p.f.
> **解**:
> -   从边缘分布可知 $f_1(2) = Pr(X=2) = 0.6$。
> -   条件p.f. $g_2(y|2) = \frac{f(2, y)}{0.6}$。
> -   计算可得：
>     -   $g_2(1|2) = f(2,1)/0.6 = 0.3/0.6 = 1/2$
>     -   $g_2(2|2) = f(2,2)/0.6 = 0/0.6 = 0$
>     -   $g_2(3|2) = f(2,3)/0.6 = 0.1/0.6 = 1/6$
>     -   $g_2(4|2) = f(2,4)/0.6 = 0.2/0.6 = 1/3$

---

### 连续条件分布

> [!abstract] -t "定义 3.6.2：条件p.d.f. (连续)"
> 设 $X, Y$ 有一个联合p.d.f.为 $f$ 的连续联合分布，边缘p.d.f.分别为 $f_1, f_2$。对于满足 $f_2(y) > 0$ 的 $y$，**给定 $Y=y$ 时 $X$ 的条件p.d.f.** $g_1(x|y)$ 定义为：
> $$
> g_1(x|y) = \frac{f(x, y)}{f_2(y)} \quad \text{for } -\infty < x < \infty
> $$

> [!tip] -t "对条件p.d.f.的理解"
> -   给定 $Y=y_0$ 时 $X$ 的条件p.d.f. $g_1(x|y_0)$ 在形状上与联合p.d.f.在直线 $y=y_0$ 上的截面 $f(x, y_0)$ 成正比。
> -   因子 $1/f_2(y_0)$ 是一个归一化常数，确保 $g_1(x|y_0)$作为 $x$ 的函数积分后为1。
> -   虽然条件于 $\{Y=y\}$ 这个概率为0的事件，但可以严格地将其视为当 $Y$ 在 $y$ 的一个极小邻域内时 $X$ 的分布的极限。

> [!example] -t "例子 3.6.5：处理时间"
> **问题**: 一个制造过程分两阶段，第一阶段耗时 $Y$，总耗时 $X$。联合p.d.f.为 $f(x,y) = e^{-x}$ for $0 \le y \le x < \infty$。求给定 $Y=y$ 时 $X$ 的条件p.d.f.。
> **解**:
> 1.  **求 $Y$ 的边缘p.d.f.**: 对于 $y>0$
>     $$
>     f_2(y) = \int_y^\infty e^{-x} dx = e^{-y}
>     $$
> 2.  **求条件p.d.f.**: 对于 $x \ge y$
>     $$
>     g_1(x|y) = \frac{f(x,y)}{f_2(y)} = \frac{e^{-x}}{e^{-y}} = e^{y-x}
>     $$
> 3.  **计算条件概率**: 例如，求 $Pr(X \ge 9 | Y=4)$
>     $$
>     Pr(X \ge 9 | Y=4) = \int_9^\infty g_1(x|4) dx = \int_9^\infty e^{4-x} dx = e^{-5} \approx 0.0067
>     $$

---

### 联合分布的构造

> [!bug] -t "定理 3.6.2：分布的乘法法则"
> 设 $X, Y$ 的联合p.f./p.d.f.为 $f$，$X, Y$ 的边缘p.f./p.d.f.分别为 $f_1, f_2$。给定 $Y=y$ 时 $X$ 的条件p.f./p.d.f.为 $g_1(x|y)$，给定 $X=x$ 时 $Y$ 的条件p.f./p.d.f.为 $g_2(y|x)$。
> 那么，对于所有 $x, y$：
> $$
> f(x, y) = g_1(x|y)f_2(y)
> $$
> $$
> f(x, y) = f_1(x)g_2(y|x)
> $$

> [!bug] -t "定理 3.6.3 & 3.6.4：随机变量的全概率公式和贝叶斯定理"
> -   **全概率公式 (定理 3.6.3)**: $X$ 的边缘p.f./p.d.f.可以通过对 $Y$ 的所有可能值进行加权平均得到：
>     -   离散Y: $f_1(x) = \sum_y g_1(x|y)f_2(y)$
>     -   连续Y: $f_1(x) = \int_{-\infty}^\infty g_1(x|y)f_2(y) dy$
> -   **贝叶斯定理 (定理 3.6.4)**: 用于“翻转”条件概率：
>     $$
>     g_2(y|x) = \frac{g_1(x|y)f_2(y)}{f_1(x)}
>     $$

> [!example] -t "例子 3.6.7 & 3.6.9：次品"
> **情景**: 一批零件的次品率为 $P$，$P$ 是一个未知参数，我们假设它是一个在 $[0,1]$ 上均匀分布的随机变量，即 $f_2(p)=1$ for $0 \le p \le 1$。从中抽取 $n$ 个零件， $X$ 是其中的次品数。
> **已知**: 给定 $P=p$ 时，$X$ 的条件分布是参数为 $n, p$ 的二项分布，即 $g_1(x|p) = \binom{n}{x}p^x(1-p)^{n-x}$。
> **构造联合分布**:
> $$
> f(x,p) = g_1(x|p)f_2(p) = \binom{n}{x}p^x(1-p)^{n-x} \quad \text{for } x=0,...,n \text{ and } 0 \le p \le 1
> $$
> **应用贝叶斯定理**: 求给定 $X=x$ 时 $P$ 的条件p.d.f.
> 1.  **用全概率公式求 $X$ 的边缘p.f.**:
>     $$
>     f_1(x) = \int_0^1 f(x,p) dp = \int_0^1 \binom{n}{x} p^x(1-p)^{n-x} dp
>     $$
> 2.  **求条件p.d.f.**:
>     $$
>     g_2(p|x) = \frac{f(x,p)}{f_1(x)} = \frac{p^x(1-p)^{n-x}}{\int_0^1 q^x(1-q)^{n-x} dq} \quad \text{for } 0 < p < 1
>     $$

> [!bug] -t "定理 3.6.5：独立性的条件观点"
> $X$ 和 $Y$ 独立，当且仅当对于所有使 $f_2(y)>0$ 的 $y$，
> $$
> g_1(x|y) = f_1(x)
> $$
> 换句话说，当且仅当给定 $Y=y$ 的条件分布与 $y$ 的取值无关，且等于 $X$ 的边缘分布。

---

### 总结

-   **条件分布**: 在观测到另一个随机变量 $Y$ 的值 $y$ 后，对随机变量 $X$ 使用的分布。
-   **计算**: 条件p.f./p.d.f.等于联合p.f./p.d.f.除以边缘p.f./p.d.f.。
-   **构造联合分布**: 可以通过一个边缘分布和一个条件分布相乘来构造联合分布。
-   **全概率公式和贝叶斯定理**: 这些基本规则有其对应的随机变量版本，用于计算边缘和“翻转”的条件分布。
-   **独立性**: 两个随机变量独立，当且仅当其中一个的条件分布不依赖于另一个变量的值。

---

## 3.7 多元分布

本节将二元分布的概念推广到任意有限个随机变量 $X_1, ..., X_n$ 的情况。

### 联合分布

> [!abstract] -t "定义 3.7.1 - 3.7.4：多元分布的基本概念"
> -   **联合c.d.f.**: $F(x_1, ..., x_n) = Pr(X_1 \le x_1, ..., X_n \le x_n)$。
> -   **联合p.f. (离散)**: $f(x_1, ..., x_n) = Pr(X_1 = x_1, ..., X_n = x_n)$。
> -   **联合p.d.f. (连续)**: 一个非负函数 $f$，使得 $Pr(X \in C) = \int \cdots \int_C f(x) dx$。
> -   **联合p.f./p.d.f. (混合)**: 结合了求和与积分的函数。
> -   **向量表示法**: 使用 $X = (X_1, ..., X_n)$ 来表示一个**随机向量**。

### 边缘分布
-   **计算**: 边缘分布可以通过对联合分布中的其他变量求和（离散）或积分（连续）来获得。
    -   例如，要得到 $X_1$ 的边缘p.d.f. $f_1(x_1)$，需要对 $x_2, ..., x_n$ 进行积分：
        $$
        f_1(x_1) = \int_{-\infty}^\infty \cdots \int_{-\infty}^\infty f(x_1, ..., x_n) dx_2 \cdots dx_n
        $$

### 独立的随机变量

> [!abstract] -t "定义 3.7.5：n个独立的随机变量"
> $n$ 个随机变量 $X_1, ..., X_n$ 是**独立的**，如果对于任意 $n$ 个实数集 $A_1, ..., A_n$：
> $$
> Pr(X_1 \in A_1, ..., X_n \in A_n) = \prod_{i=1}^n Pr(X_i \in A_i)
> $$

> [!bug] -t "定理 3.7.3 & 3.7.4：多元独立性的等价条件"
> -   **c.d.f. factorization**: $F(x_1, ..., x_n) = F_1(x_1) \cdots F_n(x_n)$。
> -   **p.f./p.d.f. factorization**: $f(x_1, ..., x_n) = f_1(x_1) \cdots f_n(x_n)$。

> [!abstract] -t "定义 3.7.6：随机样本 / i.i.d."
> -   **随机样本 (Random Sample)**: 如果随机变量 $X_1, ..., X_n$ 是相互独立的，并且每个变量都有相同的边缘p.f.或p.d.f. $f$，则称它们构成了来自该分布的一个大小为 $n$ 的**随机样本**。
> -   **独立同分布 (i.i.d.)**: 随机样本中的变量也被称为是**独立同分布的 (independent and identically distributed)**。

### 条件分布

> [!abstract] -t "定义 3.7.7：多元条件分布"
> 将随机向量 $X$ 分为两个子向量 $Y$ 和 $Z$。给定 $Z=z$ 时 $Y$ 的条件p.f./p.d.f. $g_1(y|z)$ 定义为：
> $$
> g_1(y|z) = \frac{f(y, z)}{f_2(z)}
> $$
> 其中 $f$ 是 $(Y,Z)$ 的联合p.f./p.d.f.，$f_2$ 是 $Z$ 的边缘p.f./p.d.f.。

> [!abstract] -t "定义 3.7.8：条件独立"
> 设 $Z$ 是一个随机向量。给定 $Z=z$ 时，随机变量 $X_1, ..., X_n$ 是**条件独立的 (conditionally independent)**，如果它们的条件联合分布可以分解为它们各自条件分布的乘积：
> $$
> g(x|z) = \prod_{i=1}^n g_i(x_i|z)
> $$

> [!example] -t "例子 3.7.17：临床试验（续）"
> 在临床试验的例子中，假设给定成功率 $P=p$ 时，$m$ 个病人的恢复情况 $X_1, ..., X_m$ 是条件独立的，每个都服从参数为 $p$ 的伯努利分布。
> -   $X_i$ 给定 $P=p$ 的条件p.f.是 $g_i(x_i|p) = p^{x_i}(1-p)^{1-x_i}$。
> -   $(X_1, ..., X_m)$ 给定 $P=p$ 的条件联合p.f.是：
>     $$
>     g(x|p) = \prod_{i=1}^m p^{x_i}(1-p)^{1-x_i} = p^{\sum x_i} (1-p)^{m-\sum x_i}
>     $$

> [!tip] -t "定理的条件版本"
> 之前关于分布的所有定理（如全概率公式、贝叶斯定理）都有其对应的**条件版本**。只需在每个概率陈述中加入“给定 $W=w$”的条件即可。

---

### 直方图 (Histograms)

> [!abstract] -t "定义 3.7.9：直方图"
> **直方图**是一种用于图形化显示一组数值（如随机样本的观测值）的工具。
> 1.  将数值范围 $[a,b]$ 分成 $k$ 个等长的子区间。
> 2.  统计落入每个子区间的数值个数 $c_i$。
> 3.  在每个子区间上方绘制一个矩形条，其高度与 $c_i$ 成正比。
>
> 当样本量很大时，一个经过适当缩放的直方图可以看作是对样本来自的p.d.f.的近似。

---

### 总结

-   **多元分布**: 描述多个随机变量（随机向量）的联合行为。
-   **核心概念**: 联合c.d.f., 联合p.f./p.d.f., 边缘分布, 条件分布等都从二元情况自然推广。
-   **独立性**: 联合分布等于边缘分布的乘积。
-   **i.i.d.** (独立同分布) 是统计推断中最重要的模型之一，代表了来自同一分布的随机样本。
-   **条件独立**: 在给定某个（或某些）其他随机变量的条件下，一组随机变量是独立的。这是构建复杂概率模型（如贝叶斯模型）的基石。


---

## 3.8 单个随机变量的函数

通常，在计算出一个随机变量 $X$ 的分布后，我们真正需要的是 $X$ 的某个函数的分布。例如，如果 $X$ 是服务速率，那么 $1/X$ 就是平均等待时间。本节将介绍如何确定一个随机变量的函数的分布。

### 离散分布的随机变量

> [!bug] -t "定理 3.8.1：离散随机变量的函数"
> 设 $X$ 有一个p.f.为 $f$ 的离散分布，并设 $Y=r(X)$ 是 $X$ 的一个函数。对于 $Y$ 的每个可能值 $y$，$Y$ 的p.f. $g$ 为：
> $$
> g(y) = Pr(Y=y) = Pr[r(X)=y] = \sum_{x:r(x)=y} f(x)
> $$

> [!example] -t "例子 3.8.1 & 3.8.2：与中心的距离"
> **情景**: 设 $X$ 服从在整数 $1, 2, ..., 9$ 上的均匀分布，所以 $f(x)=1/9$ for $x=1, ..., 9$。我们感兴趣的是 $X$ 与中心值5的距离，即 $Y = |X-5|$。
> **解**:
> -   $Y$ 的可能取值为 $0, 1, 2, 3, 4$。
> -   **当 $Y=0$**: 仅当 $X=5$ 时发生。所以 $g(0) = f(5) = 1/9$。
> -   **当 $Y=1$**: 当 $X=4$ 或 $X=6$ 时发生。所以 $g(1) = f(4) + f(6) = 1/9 + 1/9 = 2/9$。
> -   **当 $Y=2$**: 当 $X=3$ 或 $X=7$ 时发生。所以 $g(2) = f(3) + f(7) = 2/9$。
> -   **当 $Y=3$**: 当 $X=2$ 或 $X=8$ 时发生。所以 $g(3) = f(2) + f(8) = 2/9$。
> -   **当 $Y=4$**: 当 $X=1$ 或 $X=9$ 时发生。所以 $g(4) = f(1) + f(9) = 2/9$。

---

### 连续分布的随机变量

如果 $X$ 是连续的，求其函数 $Y=r(X)$ 的分布方法有所不同。

#### 方法1：通过c.d.f.
1.  **求 Y 的 c.d.f. G(y)**:
    $$
    G(y) = Pr(Y \le y) = Pr[r(X) \le y] = \int_{\{x:r(x) \le y\}} f(x) dx
    $$
2.  **求 Y 的 p.d.f. g(y)**:
    $$
    g(y) = \frac{dG(y)}{dy}
    $$

> [!example] -t "例子 3.8.4：X²的p.d.f. (当X是均匀分布时)"
> **问题**: 设 $X$ 服从在区间 $[-1, 1]$ 上的均匀分布，即 $f(x)=1/2$ for $-1 \le x \le 1$。求 $Y = X^2$ 的p.d.f.。
> **解**:
> 1.  $Y$ 的取值范围是 $[0, 1]$。对于 $0 \le y \le 1$：
>     $$
>     G(y) = Pr(Y \le y) = Pr(X^2 \le y) = Pr(-\sqrt{y} \le X \le \sqrt{y})
>     $$
>     $$
>     = \int_{-\sqrt{y}}^{\sqrt{y}} \frac{1}{2} dx = \frac{1}{2} (2\sqrt{y}) = \sqrt{y}
>     $$
> 2.  对 $G(y)$ 求导得到 $Y$ 的p.d.f. $g(y)$：
>     $$
>     g(y) = \frac{dG(y)}{dy} = \frac{1}{2\sqrt{y}} \quad \text{for } 0 < y < 1
>     $$
>     在其他地方 $g(y)=0$。
>     <font color="orange">注意：尽管 $X$ 的p.d.f.是常数，但 $Y=X^2$ 的p.d.f.在 $y=0$ 附近是无界的。</font>

> [!bug] -t "定理 3.8.2：线性函数"
> 设 $X$ 的p.d.f.为 $f$，且 $Y = aX + b$ ($a \ne 0$)。则 $Y$ 的p.d.f.为：
> $$
> g(y) = \frac{1}{|a|} f\left(\frac{y-b}{a}\right)
> $$

#### 方法2：直接变换法 (当函数r是一对一且可微时)

> [!bug] -t "定理 3.8.4：可微一对一函数的变换"
> 设 $X$ 的p.d.f.为 $f$，且 $Pr(a < X < b) = 1$。设 $Y=r(X)$，其中 $r(x)$ 在 $(a,b)$ 上是可微且一对一的。设 $(a,b)$ 在 $r$ 下的像为 $(\alpha, \beta)$，且 $s(y)$ 是 $r(x)$ 的反函数。
> 
> 则 $Y$ 的p.d.f. $g$ 为：
> $$
> g(y) = \begin{cases} f[s(y)] \left| \frac{ds(y)}{dy} \right| & \text{for } \alpha < y < \beta \\ 0 & \text{otherwise} \end{cases}
> $$

> [!example] -t "例子 3.8.8：微生物生长"
> **情景**: 微生物种群大小为 $Y = 10e^{5X}$，其中生长速率 $X$ 的p.d.f.为 $f(x) = 3(1-x)^2$ for $0<x<1$。
> **解**:
> 1.  函数 $r(x) = 10e^{5x}$ 在 $(0, 1)$ 上是严格递增的。
> 2.  当 $x$ 在 $(0, 1)$ 变化时，$y$ 在 $(10, 10e^5)$ 变化。
> 3.  反函数为 $s(y) = \frac{1}{5}\log(\frac{y}{10})$。
> 4.  反函数的导数为 $\frac{ds(y)}{dy} = \frac{1}{5y}$。
> 5.  应用定理3.8.4，对于 $10 < y < 10e^5$：
>     $$
>     g(y) = f[s(y)] \left| \frac{ds(y)}{dy} \right| = 3\left(1 - \frac{1}{5}\log\left(\frac{y}{10}\right)\right)^2 \cdot \frac{1}{5y} = \frac{3(1 - 0.2\log(y/10))^2}{5y}
>     $$

---

### 概率积分变换 (Probability Integral Transformation)

> [!bug] -t "定理 3.8.3：概率积分变换"
> 设 $X$ 有一个连续的c.d.f. $F$，令 $Y=F(X)$。那么 $Y$ 的分布是区间 $[0, 1]$ 上的均匀分布。

> [!bug] -t "推论 3.8.1"
> 设 $Y$ 服从 $[0, 1]$ 上的均匀分布，设 $F$ 是一个连续的c.d.f.，其分位数函数为 $F^{-1}$。那么 $X = F^{-1}(Y)$ 的c.d.f.是 $F$。

> [!tip] -t "模拟中的应用"
> 这个推论是**模拟 (Simulation)** 的基础。我们可以使用一个能够生成 $[0,1]$ 均匀分布伪随机数的计算机程序，通过 $G^{-1}(X)$ 的变换，生成服从任意指定连续c.d.f. $G$ 的伪随机数。

> [!example] -t "例子 3.8.6：生成指定p.d.f.的伪随机数"
> **目标**: 生成3个服从p.d.f. $g(y) = \frac{1}{2}(2-y)$ for $0<y<2$ 的独立值。
> **步骤**:
> 1.  **求c.d.f.**: 对于 $0 < y < 2$， $G(y) = \int_0^y \frac{1}{2}(2-t) dt = y - \frac{y^2}{4}$。
> 2.  **求分位数函数 (反函数)**: 解方程 $x = y - y^2/4$ 得到 $y=G^{-1}(x) = 2[1-(1-x)^{1/2}]$。
> 3.  **生成均匀随机数**: 假设生成器产生 $x_1=0.4125, x_2=0.0894, x_3=0.8302$。
> 4.  **应用变换**:
>     -   $y_1 = G^{-1}(0.4125) = 2[1-(1-0.4125)^{1/2}] = 0.47$
>     -   $y_2 = G^{-1}(0.0894) = 0.09$
>     -   $y_3 = G^{-1}(0.8302) = 1.18$
>     这三个 $y$ 值就是所需的模拟值。

---

### 总结

-   **离散情况**: 使用求和方法，$g(y) = \sum_{x:r(x)=y} f(x)$。
-   **连续情况 - c.d.f.法**: 先求出 $Y$ 的c.d.f. $G(y) = Pr(r(X) \le y)$，然后求导得到p.d.f. $g(y)$。
-   **连续情况 - 变换法**: 如果函数 $r$ 是一对一且可微的，可以直接使用公式 $g(y) = f[s(y)]|s'(y)|$ 来求p.d.f.。
-   **概率积分变换**: $Y=F(X)$ 将一个连续随机变量 $X$ 变换为 $[0,1]$ 上的均匀分布，其逆变换 $X=F^{-1}(Y)$ 可用于从均匀分布生成任意连续分布的随机数。

---

## 3.9 两个或多个随机变量的函数

本节介绍如何确定多个随机变量的函数的分布，这在数据汇总中非常重要。

### 离散联合分布的随机变量

> [!bug] -t "定理 3.9.1：离散随机变量的函数"
> 设 $X_1, ..., X_n$ 的联合p.f.为 $f$。定义 $m$ 个函数 $Y_j = r_j(X_1, ..., X_n)$。
> 
> $Y_1, ..., Y_m$ 的联合p.f. $g(y_1, ..., y_m)$ 为：
> $$
> g(y_1, ..., y_m) = \sum_{(x_1, ..., x_n) \in A} f(x_1, ..., x_n)
> $$
> 其中 $A$ 是所有满足 $r_j(x_1, ..., x_n) = y_j$ (for $j=1,...,m$) 的点 $(x_1, ..., x_n)$ 的集合。

> [!bug] -t "定理 3.9.2：伯努利与二项分布"
> 假设 $X_1, ..., X_n$ 是i.i.d.的伯努利随机变量，参数为 $p$。令 $Y = X_1 + \cdots + X_n$。那么 $Y$ 服从参数为 $n$ 和 $p$ 的二项分布。

---

### 连续联合分布的随机变量

#### 方法1：蛮力法 (通过c.d.f.)
> [!bug] -t "定理 3.9.3：函数的蛮力分布法"
> 设 $X=(X_1, ..., X_n)$ 的联合p.d.f.为 $f(x)$，且 $Y=r(X)$。定义 $A_y = \{x : r(x) \le y\}$。
> 
> 那么 $Y$ 的c.d.f. $G(y)$ 是：
> $$
> G(y) = \int \cdots \int_{A_y} f(x) dx
> $$
> 然后可以通过对 $G(y)$ 求导得到p.d.f. $g(y)$。

#### 卷积 (Convolution)

> [!abstract] -t "定义 3.9.1：卷积"
> 设 $X_1, X_2$ 是独立的连续随机变量，令 $Y=X_1+X_2$。$Y$ 的分布称为 $X_1$ 和 $X_2$ 分布的**卷积**。
> 
> 如果 $X_1, X_2$ 的p.d.f.分别为 $f_1, f_2$，那么 $Y$ 的p.d.f. $g(y)$ (即 $f_1, f_2$ 的卷积) 是：
> $$
> g(y) = \int_{-\infty}^{\infty} f_1(y-z) f_2(z) dz = \int_{-\infty}^{\infty} f_1(z) f_2(y-z) dz
> $$

> [!example] -t "例子 3.9.4：两个指数分布变量之和"
> **问题**: $X_1, X_2$ 是i.i.d.的随机变量，p.d.f.为 $f(x)=2e^{-2x}$ for $x>0$。求 $Y=X_1+X_2$ 的p.d.f.。
> **解**: 使用卷积公式，对于 $y>0$：
> $$
> g(y) = \int_0^y f_1(z)f_2(y-z) dz = \int_0^y (2e^{-2z})(2e^{-2(y-z)}) dz = \int_0^y 4e^{-2y} dz = 4ye^{-2y}
> $$

#### 方法2：多元变换法

> [!bug] -t "定理 3.9.5：多元变换"
> 设 $X=(X_1, ..., X_n)$ 的联合p.d.f.为 $f$。定义 $Y_j = r_j(X)$ for $j=1,...,n$ 是一个一对一可微的变换，其反变换为 $x_i = s_i(y)$。
> 
> 那么 $Y=(Y_1, ..., Y_n)$ 的联合p.d.f. $g(y)$ 是：
> $$
> g(y_1, ..., y_n) = f(s_1(y), ..., s_n(y)) |J|
> $$
> 其中 $J$ 是反变换的**雅可比行列式 (Jacobian)**:
> $$
> J = \det \begin{pmatrix} \frac{\partial s_1}{\partial y_1} & \cdots & \frac{\partial s_1}{\partial y_n} \\ \vdots & \ddots & \vdots \\ \frac{\partial s_n}{\partial y_1} & \cdots & \frac{\partial s_n}{\partial y_n} \end{pmatrix}
> $$

> [!example] -t "例子 3.9.9：两个随机变量的商与积"
> **问题**: 设 $X_1, X_2$ 的联合p.d.f.为 $f(x_1, x_2) = 4x_1x_2$ for $0<x_1<1, 0<x_2<1$。求 $Y_1 = X_1/X_2$ 和 $Y_2 = X_1X_2$ 的联合p.d.f.。
> **解**:
> 1.  **反变换**: $x_1 = \sqrt{y_1y_2}$, $x_2 = \sqrt{y_2/y_1}$。
> 2.  **雅可比行列式**: $|J| = 1/(2y_1)$。
> 3.  **变换后的p.d.f.**:
>     $$
>     g(y_1, y_2) = f(\sqrt{y_1y_2}, \sqrt{y_2/y_1}) \cdot |J| = 4(\sqrt{y_1y_2})(\sqrt{y_2/y_1}) \cdot \frac{1}{2y_1} = \frac{2y_2}{y_1}
>     $$
> 4.  **新的支撑集T**: 由 $0 < x_1 < 1$ 和 $0 < x_2 < 1$ 变换得到 $y_1 > 0, y_2 > 0, y_2 < 1/y_1, y_2 < y_1$。

---

### 总结

-   **离散情况**: 通过对所有导致相同函数值的原始变量组合的概率求和来找到新变量的p.f.。
-   **连续情况**:
    -   **c.d.f.法**是通用的，但可能涉及复杂的积分。
    -   **卷积**是计算两个独立随机变量之和分布的专用且强大的工具。
    -   **多元变换法** (雅可比法) 是最强大的方法，适用于变量数量不变的一对一变换。
-   **策略**: 如果只关心一个函数 $Y_1=r_1(X)$ 的分布，通常需要引入辅助函数 $Y_2, ..., Y_n$ 使得变换是一对一的，然后计算出联合p.d.f. $g(y_1, ..., y_n)$，最后通过积分消去 $y_2, ..., y_n$ 来得到 $Y_1$ 的边缘p.d.f.。

---

## *3.10 马尔可夫链 (Markov Chains)

马尔可夫链是用于模拟随时间随机变化的系统的一种常用模型。它是一个随机变量序列，其中每个未来状态的条件分布仅依赖于当前状态，而与过去的状态无关。

### 随机过程 (Stochastic Processes)

> [!abstract] -t "定义 3.10.1：随机过程"
> 一个随机变量序列 $X_1, X_2, ...$ 被称为一个**离散时间参数的随机过程**。
> -   $X_1$ 称为过程的**初始状态**。
> -   $X_n$ 称为过程在**时间n的状态**。

> [!example] -t "例子 3.10.1：占用的电话线"
> 办公室有五条电话线。每隔2分钟观察一次正在使用的线路数。
> -   $X_1$ 是第一次观察时使用的线路数。
> -   $X_n$ 是第 $n$ 次观察时使用的线路数。
> 这个序列 $X_1, X_2, ...$ 就是一个随机过程，每个时间的状态是 $\{0, 1, 2, 3, 4, 5\}$ 中的一个整数。

### 马尔可夫链 (Markov Chains)

> [!abstract] -t "定义 3.10.2：马尔可夫链"
> 一个离散时间参数的随机过程是**马尔可夫链**，如果对于每个时间 $n$，给定过去状态 $X_1, ..., X_{n-1}$ 和现在状态 $X_n$ 时，任何未来状态 $X_{n+j} (j \ge 1)$ 的条件分布只依赖于**现在状态 $X_n$**。
> 
> 符号表示为，对于任意 $b$ 和任意状态序列 $x_1, ..., x_n$：
> $$
> Pr(X_{n+1} \le b | X_1=x_1, ..., X_n=x_n) = Pr(X_{n+1} \le b | X_n=x_n)
> $$
> 如果可能的状态总数是有限的，则称之为**有限马尔可夫链**。

> [!abstract] -t "定义 3.10.3：转移分布"
> -   **转移分布 (Transition Distributions)**: 给定时间 $n$ 的状态，时间 $n+1$ 的状态的条件分布，即 $Pr(X_{n+1}=j | X_n=i)$。
> -   **平稳转移分布 (Stationary Transition Distributions)**: 如果转移分布对于所有时间 $n$ 都是相同的，则称马尔可夫链具有平稳转移分布。此时，存在概率 $p_{ij}$ 使得：
>     $$
>     p_{ij} = Pr(X_{n+1}=j | X_n=i) \quad \text{for all } n
>     $$

> [!example] -t "例子 3.10.2：购买牙膏"
> 一个购物者在两个品牌A(状态1)和B(状态2)之间选择。每次购买时，她有 $1/3$ 的概率选择与上次相同的品牌，有 $2/3$ 的概率更换品牌。
> -   这是一个马尔可夫链，因为下一次购买只取决于上一次购买。
> -   它具有平稳转移分布：
>     -   $p_{11} = Pr(X_{n+1}=1|X_n=1) = 1/3$
>     -   $p_{12} = Pr(X_{n+1}=2|X_n=1) = 2/3$
>     -   $p_{21} = Pr(X_{n+1}=1|X_n=2) = 2/3$
>     -   $p_{22} = Pr(X_{n+1}=2|X_n=2) = 1/3$

### 转移矩阵 (The Transition Matrix)

> [!abstract] -t "定义 3.10.4：转移矩阵"
> 对于一个具有平稳转移分布的有限马尔可夫链，其**转移矩阵** $P$ 是一个 $k \times k$ 的矩阵，其元素为 $p_{ij}$。第 $i$ 行第 $j$ 列的元素是从状态 $i$ 转移到状态 $j$ 的概率。
> $$
> P = \begin{pmatrix} p_{11} & \cdots & p_{1k} \\ \vdots & \ddots & \vdots \\ p_{k1} & \cdots & p_{kk} \end{pmatrix}
> $$

> [!abstract] -t "定义 3.10.5：随机矩阵"
> 一个所有元素非负且每行元素之和为1的方阵被称为**随机矩阵 (stochastic matrix)**。
> 
> <font color="cyan">任何有限马尔可夫链的转移矩阵都必须是一个随机矩阵。</font>

> [!example] -t "例子 3.10.5：电话线的转移矩阵"
> 假设电话线占用数是一个具有平稳转移分布的马尔可夫链，状态为 $\{0, 1, 2, 3, 4, 5\}$。一个可能的转移矩阵 $P$ 如下：
> ```
>       0    1    2    3    4    5
>   0 [0.1, 0.4, 0.2, 0.1, 0.1, 0.1]
>   1 [0.2, 0.3, 0.2, 0.1, 0.1, 0.1]
>   2 [0.1, 0.2, 0.3, 0.2, 0.1, 0.1]
>   3 [0.1, 0.1, 0.2, 0.3, 0.2, 0.1]
>   4 [0.1, 0.1, 0.1, 0.2, 0.3, 0.2]
>   5 [0.1, 0.1, 0.1, 0.1, 0.4, 0.2]
> ```
> -   **问题a**: 假设当前5条线都在使用，下一次观察时恰好有4条线在使用的概率是多少？
>     -   **答案**: 查找矩阵中对应“状态5”的行和“状态4”的列的元素，即 $p_{54} = 0.4$。
> -   **问题b**: 假设当前没有线路使用，下一次观察时至少有一条线路在使用的概率是多少？
>     -   **答案**: 没有线路使用的概率是 $p_{00} = 0.1$。因此，至少有一条线路使用的概率是 $1 - p_{00} = 1 - 0.1 = 0.9$。