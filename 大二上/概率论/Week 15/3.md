# Chapter 8: Sampling Distributions and Confidence Intervals

> [!abstract] 章节概览
> 本章主要讨论统计推断的基础。
> 1.  **抽样分布 (Sampling Distributions)**：介绍统计量（Statistic）及其分布，重点讲解 $\chi^2$、$t$ 和 $F$ 三大分布。
> 2.  **置信区间 (Confidence Intervals)**：如何利用样本信息估计总体参数的范围（区间估计），包括双侧和单侧区间，以及枢轴量法 (Pivotal Quantity)。

---

## 8.1 & 8.2 抽样分布基础与四大典型分布

### 1. 抽样分布的概念 (Sampling Distribution)

> [!NOTE] Definition 8.1.1: Sampling Distribution
> 假设随机变量 $\vec{X} = (X_1, \dots, X_n)$ 是来自某个包含未知参数 $\theta$ 的分布的**随机样本 (Random Sample)**。
> 令 $T$ 为 $\vec{X}$ 的函数（可能也包含 $\theta$），即 $T = r(X_1, \dots, X_n, \theta)$。
> **$T$ 的分布（给定 $\theta$）被称为 $T$ 的抽样分布 (Sampling Distribution)。**

*   **通俗解释**：统计量（如样本均值 $\bar{X}$）本身也是随机变量，因为它每次抽样结果都不一样。统计量自己的概率分布，就叫抽样分布。它是统计推断的基石。

---

### 2. 标准正态分布 (Standard Normal Distribution)

> [!summary] Definition 5.6.2
> 均值为 0，方差为 1 的正态分布称为标准正态分布。
> *   **PDF (概率密度)**: $\phi(x) = \frac{1}{\sqrt{2\pi}} e^{-x^2/2}, \quad -\infty < x < \infty$
> *   **CDF (累积分布)**: $\Phi(x) = \int_{-\infty}^x \phi(u) du$

---

### 3. $\chi^2$ 分布 (Chi-square Distribution)

$\chi^2$ 分布在方差分析和列联表检验中非常重要。

> [!def] Definition 8.2.1: $\chi^2$ Distribution
> 对于正数 $m$，参数为 $\alpha = m/2$ 和 $\beta = 1/2$ 的 **Gamma 分布** 被称为 **自由度为 $m$ 的 $\chi^2$ 分布**。
> 记作：$X \sim \chi^2_m$ 或 $X \sim \chi^2(m)$。
>
> **PDF 公式 ($x > 0$)**:
> $$ f(x) = \frac{1}{2^{m/2}\Gamma(m/2)} x^{(m/2)-1} e^{-x/2} $$

#### 核心定理与性质
*   **<font color="#d35400">Theorem 8.2.3 (来源)</font>**：如果 $X$ 服从标准正态分布 ($X \sim N(0,1)$)，那么 $Y = X^2$ 服从自由度为 1 的 $\chi^2$ 分布 ($Y \sim \chi^2_1$)。
*   **<font color="#d35400">Corollary 8.2.1 (平方和)</font>**：如果 $X_1, \dots, X_m$ 独立同分布 (i.i.d.) 且服从 $N(0,1)$，则它们的平方和服从自由度为 $m$ 的 $\chi^2$ 分布：
    $$ \sum_{i=1}^m X_i^2 \sim \chi^2_m $$
*   **Theorem 8.2.1 (均值与方差)**：若 $X \sim \chi^2_m$，则：
    *   $E(X) = m$
    *   $Var(X) = 2m$
*   **Theorem 8.2.2 (可加性)**：独立的 $\chi^2$ 变量之和仍是 $\chi^2$ 分布，自由度相加。

---

### 4. $t$ 分布 (Student's t Distribution)

$t$ 分布主要用于**小样本**且**方差未知**时的均值估计。

> [!def] Definition 8.4.1: $t$ Distributions
> 考虑两个独立的随机变量 $Y$ 和 $Z$：
> *   $Y \sim \chi^2_m$ (自由度为 $m$ 的卡方分布)
> *   $Z \sim N(0,1)$ (标准正态分布)
>
> 定义随机变量 $X$ 为：
> $$ X = \frac{Z}{\sqrt{Y/m}} $$
> 则 $X$ 服从**自由度为 $m$ 的 $t$ 分布**，记作 $X \sim t_m$。

*   **PDF 特性 (Thm 8.4.1)**：
    $$ f(x) = \frac{\Gamma(\frac{m+1}{2})}{(m\pi)^{1/2}\Gamma(\frac{m}{2})} \left( 1 + \frac{x^2}{m} \right)^{-(m+1)/2} $$
*   **形态**：$t$ 分布是对称的钟形曲线，类似于正态分布，但**尾部更厚 (heavier tails)**。当 $n \ge 50$ 时，$t$ 分布非常接近标准正态分布。

---

### 5. $F$ 分布 (F Distributions)

$F$ 分布用于比较两个方差（方差分析 ANOVA 的基础）。

> [!def] Definition 9.7.1: $F$ Distributions
> 设 $Y$ 和 $W$ 是独立的随机变量：
> *   $Y \sim \chi^2_m$
> *   $W \sim \chi^2_n$
>
> 定义随机变量 $X$ 为两个卡方变量与其自由度之比的比值：
> $$ X = \frac{Y/m}{W/n} $$
> 则 $X$ 服从自由度为 $m$ 和 $n$ 的 $F$ 分布，记作 $X \sim F_{m,n}$。

---

## 8.3 抽样分布的重要定理 (Theorems of Sampling Distribution)

这部分建立了样本均值 $\bar{X}$ 和样本方差 $S^2$ 的分布性质，是置信区间推导的核心。

### 1. 正态样本均值的分布
> [!note] Corollary 5.6.2
> 设 $X_1, \dots, X_n$ i.i.d. 来自 $N(\mu, \sigma^2)$。样本均值 $\bar{X}_n = \frac{1}{n}\sum X_i$。
> 则 $\bar{X}_n$ 服从：
> $$ \bar{X}_n \sim N\left(\mu, \frac{\sigma^2}{n}\right) $$

### 2. 正态样本均值与方差的独立性 (Fisher's Lemma)
> [!important] Theorem 8.3.1 (关键定理)
> 设 $X_1, \dots, X_n$ 来自 $N(\mu, \sigma^2)$。则：
> 1.  样本均值 $\bar{X}_n$ 与样本方差 $S^2 = \frac{1}{n}\sum (X_i - \bar{X}_n)^2$ **相互独立**。
> 2.  标准化统计量 $\frac{\sum(X_i - \bar{X}_n)^2}{\sigma^2}$ 服从 $\chi^2$ 分布：
>     $$ \frac{\sum_{i=1}^n (X_i - \bar{X}_n)^2}{\sigma^2} = \frac{n S^2}{\sigma^2} \sim \chi^2_{n-1} $$
>     *(注：如果是无偏方差 $S'^2 = \frac{1}{n-1}\sum(X_i-\bar{X})^2$，则 $\frac{(n-1)S'^2}{\sigma^2} \sim \chi^2_{n-1}$)*

### 3. 单样本 $t$ 统计量
> [!important] Theorem 8.4.2
> 结合上述定理，构造统计量：
> $$ T = \frac{\bar{X}_n - \mu}{\sigma' / \sqrt{n}} $$
> 其中 $\sigma' = \left[ \frac{1}{n-1} \sum_{i=1}^n (X_i - \bar{X}_n)^2 \right]^{1/2}$ 是样本标准差。
> 该统计量服从：
> $$ T \sim t_{n-1} $$

### 4. 双样本 $t$ 统计量 (Theorem 9.6.1)
用于比较两个正态总体的均值（假设方差相等）。
$$ \frac{(\bar{X}_m - \bar{Y}_n) - (\mu_1 - \mu_2)}{\sqrt{(\frac{1}{m} + \frac{1}{n})(S_X^2 + S_Y^2)}} \sim t_{m+n-2} $$
*(注：这里 $S_X^2$ 和 $S_Y^2$ 定义为误差平方和，即 $\sum(X_i-\bar{X})^2$)*

---

## 8.4 置信区间 (Confidence Intervals)

### 1. 定义与含义

> [!def] Definition 8.5.1: Confidence Interval
> 设 $\vec{X}$ 是样本，参数为 $\theta$。$A$ 和 $B$ 是两个统计量（不含 $\theta$），满足 $A \le B$。若对所有 $\theta$：
> $$ \text{Pr}(A < g(\theta) < B) \ge \gamma $$
> 则随机区间 $(A, B)$ 称为 $g(\theta)$ 的 **系数为 $\gamma$ 的置信区间 (Confidence Interval, CI)**。
> $\gamma$ 通常取 0.90, 0.95, 0.99，称为**置信水平 (Confidence Level)**。

*   **观测值**：样本观测后计算出的具体数值区间 $(a, b)$。
*   **含义**：$\gamma$ 代表方法的**可靠性 (Reliability)**。如果重复抽样很多次，计算出很多个区间，其中有 $\gamma \times 100\%$ 的区间会包含真实参数 $\theta$。

---

### 2. 正态分布均值 $\mu$ 的置信区间

#### 情况 A：方差 $\sigma^2$ 已知 (Page 22)
利用 $Z = \frac{\bar{X}_n - \mu}{\sigma/\sqrt{n}} \sim N(0,1)$。
置信区间为：
$$ \left( \bar{X}_n - \frac{\sigma}{\sqrt{n}}\Phi^{-1}\left(\frac{1+\gamma}{2}\right), \quad \bar{X}_n + \frac{\sigma}{\sqrt{n}}\Phi^{-1}\left(\frac{1+\gamma}{2}\right) \right) $$
其中 $\Phi^{-1}$ 是标准正态分布的分位点。

#### 情况 B：方差 $\sigma^2$ 未知 (Page 23 - Thm 8.5.1)
利用 $T = \frac{\bar{X}_n - \mu}{\sigma'/\sqrt{n}} \sim t_{n-1}$。
置信区间为：
$$ \left( \bar{X}_n - \frac{\sigma'}{\sqrt{n}}T_{n-1}^{-1}\left(\frac{1+\gamma}{2}\right), \quad \bar{X}_n + \frac{\sigma'}{\sqrt{n}}T_{n-1}^{-1}\left(\frac{1+\gamma}{2}\right) \right) $$
*   $\sigma'$：样本标准差（分母为 $n-1$）。
*   $T_{n-1}^{-1}$：$t$ 分布的分位点（Quantile function）。

---

### 3. 具体例题讲解

#### <font color="#2e86c1">Example 8.5.3: Rain from Seeded Clouds (人工降雨数据)</font>
**题干**：
*   样本量 $n=26$。
*   样本均值 $\bar{X}_n = 5.134$。
*   样本标准差 $\sigma' = 1.600$。
*   求：95% 置信区间 ($\gamma = 0.95$)。

**计算步骤**：
1.  **确定自由度**：$df = n - 1 = 25$。
2.  **查找 $t$ 分位点**：需要找到 $T_{25}^{-1}(\frac{1+0.95}{2}) = T_{25}^{-1}(0.975)$。
    *   通过查表或计算可知：$t_{0.975, 25} \approx 2.060$ (题目中隐含使用了算出的系数 0.404 反推)。
    *   题目直接给出 Margin calculation：$0.404 \times 1.600$。这里 $0.404$ 实际上是 $\frac{t_{val}}{\sqrt{26}}$ 或者是系数部分。让我们按标准公式核对：$\frac{2.06}{\sqrt{26}} \approx 0.404$。
3.  **计算下限 $a$**：
    $$ a = 5.134 - 0.404 \times 1.600 = 5.134 - 0.6464 = 4.488 $$
4.  **计算上限 $b$**：
    $$ b = 5.134 + 0.404 \times 1.600 = 5.780 $$

**结论**：95% CI 为 $(4.488, 5.780)$。

---

#### <font color="#2e86c1">Example 8.5.4: Acid Concentration in Cheese (奶酪中的酸浓度)</font>
**题干**：
*   样本数据：$0.86, 1.53, 1.57, 1.81, 0.99, 1.09, 1.29, 1.78, 1.29, 1.58$。
*   样本量 $n=10$。
*   求：$\mu$ 的 90% 置信区间 ($\gamma = 0.9$)。

**计算步骤**：
1.  **计算样本统计量**：
    *   均值 $\bar{x}_n = \frac{\sum x_i}{10} = 1.379$。
    *   标准差 $\sigma' = 0.3277$ (根据公式 $\sqrt{\frac{\sum(x_i-\bar{x})^2}{n-1}}$)。
2.  **确定 $t$ 分位点**：
    *   自由度 $n-1 = 9$。
    *   目标概率 $(1+0.9)/2 = 0.95$。
    *   查表得 $c = T_9^{-1}(0.95) = 1.833$。
3.  **代入公式**：
    $$ \text{Endpoints} = 1.379 \pm 1.833 \times \frac{0.3277}{\sqrt{10}} $$
    $$ \text{Margin} = 1.833 \times \frac{0.3277}{3.162} \approx 0.190 $$
    *   下限：$1.379 - 0.190 = 1.189$
    *   上限：$1.379 + 0.190 = 1.569$

**结论**：90% CI 为 $(1.189, 1.569)$。

---

### 4. 单侧置信区间 (One-Sided Confidence Intervals)

有时我们要找的不是一个范围，而是一个下界（Lower Bound）或上界（Upper Bound）。

> [!def] Definition 8.5.2
> *   **单侧下置信限 (Lower Confidence Limit)** $A$：满足 $\text{Pr}(A < g(\theta)) \ge \gamma$。区间为 $(A, \infty)$。
> *   **单侧上置信限 (Upper Confidence Limit)** $B$：满足 $\text{Pr}(g(\theta) < B) \ge \gamma$。区间为 $(-\infty, B)$。

**正态分布均值的单侧限公式 ($\sigma$ 未知)** (Theorem 8.5.2):
*   下限 $A = \bar{X}_n - \frac{\sigma'}{\sqrt{n}} T_{n-1}^{-1}(\gamma)$
*   上限 $B = \bar{X}_n + \frac{\sigma'}{\sqrt{n}} T_{n-1}^{-1}(\gamma)$
    *注意：这里使用的是 $\gamma$ 分位点，而不是双侧的 $\frac{1+\gamma}{2}$。*

#### <font color="#2e86c1">Example 8.5.5: Rain from Seeded Clouds (单侧下限)</font>
**题干**：
*   使用 Example 8.5.3 的数据 ($n=26, \bar{x}=5.134, \sigma'=1.6$)。
*   求：90% 的**单侧下置信限** ($\gamma = 0.9$)。

**计算步骤**：
1.  **查找分位点**：自由度 25。需要 $T_{25}^{-1}(0.9) = 1.316$。
2.  **代入公式**：
    $$ a = 5.134 - 1.316 \times \frac{1.600}{\sqrt{26}} $$
    $$ a = 5.134 - 1.316 \times 0.3138 \approx 5.134 - 0.413 = 4.721 $$
    *(PPT中计算结果为 4.727，差异源于中间步骤保留精度)*

**结论**：我们有 90% 的把握认为均值 $\mu > 4.727$。

---

### 5. 枢轴量法 (Pivotal Quantity)

这是构造置信区间的通用数学方法。

> [!def] Definition 8.5.3: Pivotal Quantity
> 设 $\vec{X}$ 为样本，$\theta$ 为参数。
> 令 $V(\vec{X}, \theta)$ 为一个随机变量。
> 如果 **$V$ 的分布不依赖于 $\theta$**，则称 $V$ 为一个**枢轴量 (Pivotal Quantity)**。
> *   例如：$Z = \frac{\bar{X}-\mu}{\sigma/\sqrt{n}}$ 分布是 $N(0,1)$，不含 $\mu$，它是枢轴量。

**构造 CI 的步骤 (Theorem 8.5.3)**：
1.  找到枢轴量 $V(\vec{X}, \theta)$，其累积分布函数为 $G$。
2.  选取概率 $\gamma_1, \gamma_2$ 使得 $\gamma_2 - \gamma_1 = \gamma$（通常取对称）。
3.  解不等式 $G^{-1}(\gamma_1) < V(\vec{X}, \theta) < G^{-1}(\gamma_2)$ 以分离出 $\theta$。

#### <font color="#2e86c1">Example 8.5.8: Estimating the Variance (估计方差)</font>
**题干**：
如何估计正态分布的方差 $\sigma^2$？

**推导**：
1.  根据 Theorem 8.3.1，统计量 $V = \frac{\sum(X_i - \bar{X}_n)^2}{\sigma^2}$ 服从 $\chi^2_{n-1}$ 分布。
2.  $\chi^2_{n-1}$ 不依赖于未知参数 $\sigma^2$，因此 $V$ 是**枢轴量**。
3.  我们可以利用 $\chi^2$ 表找到分位点 $c_1, c_2$，使得 $\text{Pr}(c_1 < V < c_2) = \gamma$。
4.  代入 $V$ 并反解 $\sigma^2$：
    $$ c_1 < \frac{(n-1)S'^2}{\sigma^2} < c_2 \implies \frac{(n-1)S'^2}{c_2} < \sigma^2 < \frac{(n-1)S'^2}{c_1} $$
    这便是方差 $\sigma^2$ 的置信区间。

