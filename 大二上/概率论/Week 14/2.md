# 第8章：抽样分布与估计量性质 (Sampling Distributions & Properties of Estimators)

> [!abstract] **课程概要**
> 本节课主要连接了第7章（参数估计）与第8章（抽样分布）的内容。
> 1. **复习矩估计 (Method of Moments)**：核心思想与计算步骤。
> 2. **估计量的评价标准 (Criteria for Estimators)**：重点讲解了无偏性 (Unbiasedness)、一致性 (Consistency) 和 均方误差 (MSE)。
> 3. **核心证明**：为什么样本方差要除以 $n-1$ 而不是 $n$？
> 4. **四大抽样分布**：正态分布、$\chi^2$分布、$t$分布、$F$分布。重点推导了 $\chi^2$ 分布的来源。

---

## 1. 矩估计法 (Method of Moments, MM)

> [!tip] **核心思想**
> 用**样本矩 (Sample Moments)** 去估计 **总体矩 (Population Moments)**。
> “让你的样本矩等于总体矩，解方程即可。”

### 1.1 定义与公式
假设总体 $X$ 的概率密度函数为 $f(x; \theta)$，参数为 $\theta$。
* **总体矩 (Population Moment):** $\mu_k = E[X^k]$
* **样本矩 (Sample Moment):** $M_k = \frac{1}{n} \sum_{i=1}^{n} X_i^k$

### 1.2 计算步骤
对于包含 $k$ 个未知参数的分布：
1.  计算前 $k$ 阶总体矩：$E[X], E[X^2], \dots$（这些通常是关于参数 $\theta$ 的函数）。
2.  计算前 $k$ 阶样本矩：$M_1 = \bar{X}, M_2 = \frac{1}{n}\sum X_i^2, \dots$
3.  建立方程组并求解：
    $$
    \begin{cases}
    \mu_1(\theta) = M_1 \\
    \mu_2(\theta) = M_2 \\
    \vdots
    \end{cases}
    $$

### 1.3 实例：Gamma 分布的矩估计
> [!example] **Gamma Distribution Example**
> 假设 $X \sim \text{Gamma}(\alpha, \beta)$，求 $\alpha$ 和 $\beta$ 的矩估计量。

* **已知：**
    * 总体均值 (First Moment): $\mu_1 = E[X] = \frac{\alpha}{\beta}$
    * 总体方差: $Var(X) = \frac{\alpha}{\beta^2}$
    * 总体二阶矩: $\mu_2 = E[X^2] = Var(X) + (E[X])^2 = \frac{\alpha}{\beta^2} + \frac{\alpha^2}{\beta^2} = \frac{\alpha(\alpha+1)}{\beta^2}$

* **建立方程：**
    1.  $\frac{\alpha}{\beta} = M_1 = \bar{X}$  (Sample Mean)
    2.  $\frac{\alpha(\alpha+1)}{\beta^2} = M_2 = \frac{1}{n}\sum X_i^2$ (Sample Second Moment)

* **求解：**
    利用 $Var(X) = E[X^2] - (E[X])^2$，样本方差 $S^2 \approx M_2 - M_1^2$。
    通过解上述方程组，可以得到 $\hat{\alpha}$ 和 $\hat{\beta}$ 的表达式（通常 $\hat{\beta} = \bar{X}/S^2$, $\hat{\alpha} = \bar{X}^2/S^2$ 形式，具体取决于用的是哪种样本方差定义）。

---

## 2. 估计量的评价标准 (Criteria for Estimators)

对于同一个参数，可能有多种估计方法（如 MLE 和 MM 得到的结果可能不同）。我们需要标准来判断哪个更好。

### 2.1 一致性 (Consistency)
> [!info] 定义
> 随着样本量 $n \to \infty$，估计量 $\hat{\theta}$ 依概率收敛于真实参数 $\theta$。
> $$\lim_{n \to \infty} P(|\hat{\theta}_n - \theta| \ge \epsilon) = 0$$
> *通俗理解：样本越多，估计越准。*

### 2.2 无偏性 (Unbiasedness)
> [!important] 定义
> 如果估计量的数学期望等于真实参数值，则称其为无偏估计。
> $$E[\hat{\theta}] = \theta$$
> * **Bias (偏差):** $Bias(\hat{\theta}) = E[\hat{\theta}] - \theta$。如果 Bias = 0，则无偏。

#### **重要结论：样本均值是无偏的**
对于独立同分布 (i.i.d) 的样本 $X_1, \dots, X_n$，总体均值为 $\mu$。
$$E[\bar{X}] = E\left[\frac{1}{n}\sum X_i\right] = \frac{1}{n}\sum E[X_i] = \frac{1}{n} \cdot n\mu = \mu$$
所以，$\bar{X}$ 是 $\mu$ 的无偏估计。

### 2.3 均方误差 (Mean Squared Error, MSE)
> [!warning] 注意 PPT 符号错误
> 课堂上指出了课件中关于 MSE 定义公式的括号位置错误，正确定义如下。

* **定义：** 用于衡量估计量与真实值之间的“平均”差异。
    $$MSE(\hat{\theta}) = E[(\hat{\theta} - \theta)^2]$$
* **分解公式：**
    $$MSE(\hat{\theta}) = Var(\hat{\theta}) + [Bias(\hat{\theta})]^2$$
* **关系：**
    * 如果是无偏估计 ($Bias=0$)，则 $MSE(\hat{\theta}) = Var(\hat{\theta})$。
    * **Minimum Mean Square Error Estimator:** 我们希望 MSE 越小越好。

---

## 3. 重点证明：样本方差的无偏性 (Why divide by n-1?)

> [!question] **核心问题**
> 为什么样本方差 $S^2 = \frac{1}{n-1}\sum(X_i - \bar{X})^2$ 是无偏的，而 $\frac{1}{n}\sum(X_i - \bar{X})^2$ 是有偏的？

### 3.1 预备知识
1.  $E[X_i] = \mu, \quad Var(X_i) = \sigma^2$
2.  $E[\bar{X}] = \mu, \quad Var(\bar{X}) = \frac{\sigma^2}{n}$
3.  公式：$E[Y^2] = Var(Y) + (E[Y])^2$

### 3.2 证明过程
我们要计算 $E\left[ \sum_{i=1}^n (X_i - \bar{X})^2 \right]$。

**第一步：恒等变形**
$$
\begin{aligned}
\sum_{i=1}^n (X_i - \mu)^2 &= \sum_{i=1}^n [(X_i - \bar{X}) + (\bar{X} - \mu)]^2 \\
&= \sum_{i=1}^n (X_i - \bar{X})^2 + \sum_{i=1}^n (\bar{X} - \mu)^2 + 2(\bar{X} - \mu)\sum_{i=1}^n (X_i - \bar{X})
\end{aligned}
$$
注意交叉项 $\sum(X_i - \bar{X}) = \sum X_i - n\bar{X} = n\bar{X} - n\bar{X} = 0$。
所以得到：
$$\sum_{i=1}^n (X_i - \mu)^2 = \sum_{i=1}^n (X_i - \bar{X})^2 + n(\bar{X} - \mu)^2$$

**第二步：求期望**
对等式两边同时求期望 $E[\cdot]$：
$$E\left[ \sum_{i=1}^n (X_i - \mu)^2 \right] = E\left[ \sum_{i=1}^n (X_i - \bar{X})^2 \right] + E\left[ n(\bar{X} - \mu)^2 \right]$$

**第三步：逐项计算**
1.  **左边：**
    $$\sum E[(X_i - \mu)^2] = \sum Var(X_i) = \sum \sigma^2 = n\sigma^2$$
2.  **右边第二项：**
    $$n E[(\bar{X} - \mu)^2] = n Var(\bar{X}) = n \cdot \frac{\sigma^2}{n} = \sigma^2$$

**第四步：代回等式**
$$n\sigma^2 = E\left[ \sum_{i=1}^n (X_i - \bar{X})^2 \right] + \sigma^2$$
$$E\left[ \sum_{i=1}^n (X_i - \bar{X})^2 \right] = n\sigma^2 - \sigma^2 = (n-1)\sigma^2$$

### 3.3 结论
* 如果定义 **$S^2 = \frac{1}{n-1}\sum (X_i - \bar{X})^2$**：
    $$E[S^2] = \frac{1}{n-1} \cdot (n-1)\sigma^2 = \sigma^2 \quad \text{(无偏 Unbiased)}$$
* 如果定义 **$\hat{\sigma}^2 = \frac{1}{n}\sum (X_i - \bar{X})^2$** (比如 MLE 的结果)：
    $$E[\hat{\sigma}^2] = \frac{1}{n} \cdot (n-1)\sigma^2 = \frac{n-1}{n}\sigma^2 \neq \sigma^2 \quad \text{(有偏 Biased)}$$

> [!note] 线性组合性质
> 如果 $\hat{\theta}_1$ 和 $\hat{\theta}_2$ 都是 $\theta$ 的无偏估计量，且 $\alpha + \beta = 1$，则 $\alpha\hat{\theta}_1 + \beta\hat{\theta}_2$ 也是 $\theta$ 的无偏估计量。

---

## 4. 抽样分布 (Sampling Distributions)

统计学中有四大经典分布：Normal, Chi-Square, t, F。

### 4.1 正态分布 (Normal Distribution)
* **Standard Normal:** $Z \sim N(0, 1)$
* **PDF:** $f(z) = \frac{1}{\sqrt{2\pi}} e^{-z^2/2}$
* **CDF:** $\Phi(z)$

### 4.2 卡方分布 (Chi-Square Distribution, $\chi^2$)

#### **定义**
设 $X$ 服从参数为 $\alpha = m/2, \beta = 1/2$ 的 **Gamma 分布**，则称 $X$ 服从自由度为 $m$ 的卡方分布，记为 $X \sim \chi^2(m)$。

* **PDF:** $f(x) = \frac{1}{2^{m/2}\Gamma(m/2)} x^{m/2 - 1} e^{-x/2}, \quad x > 0$
* **性质:**
    * Mean: $E[X] = \frac{\alpha}{\beta} = \frac{m/2}{1/2} = m$
    * Variance: $Var(X) = \frac{\alpha}{\beta^2} = \frac{m/2}{1/4} = 2m$

#### **核心推导：标准正态平方服从 $\chi^2(1)$**
> [!example] Theorem Proof
> **Theorem:** Let $X \sim N(0, 1)$. Let $Y = X^2$. Then $Y \sim \chi^2(1)$.

**证明 (变量代换法 Change of Variables):**
1.  **CDF 关系:**
    $$F_Y(y) = P(Y \le y) = P(X^2 \le y) = P(-\sqrt{y} \le X \le \sqrt{y})$$
    $$F_Y(y) = \Phi(\sqrt{y}) - \Phi(-\sqrt{y})$$
2.  **求导得 PDF ($f_Y(y)$):**
    利用链式法则：
    $$f_Y(y) = \frac{d}{dy}F_Y(y) = \phi(\sqrt{y}) \cdot (\sqrt{y})' - \phi(-\sqrt{y}) \cdot (-\sqrt{y})'$$
    其中 $\phi(x) = \frac{1}{\sqrt{2\pi}} e^{-x^2/2}$ 是标准正态的 PDF，具有偶函数性质 $\phi(\sqrt{y}) = \phi(-\sqrt{y})$。
    $$
    \begin{aligned}
    f_Y(y) &= \phi(\sqrt{y}) \cdot \frac{1}{2\sqrt{y}} - \phi(-\sqrt{y}) \cdot \left(-\frac{1}{2\sqrt{y}}\right) \\
    &= \phi(\sqrt{y}) \left( \frac{1}{2\sqrt{y}} + \frac{1}{2\sqrt{y}} \right) \\
    &= \frac{1}{\sqrt{2\pi}} e^{-(\sqrt{y})^2/2} \cdot \frac{1}{\sqrt{y}} \\
    &= \frac{1}{\sqrt{2\pi}} y^{-1/2} e^{-y/2}
    \end{aligned}
    $$
3.  **验证是否为 $\chi^2(1)$:**
    对比 $\chi^2(1)$ 的公式（即 $\text{Gamma}(1/2, 1/2)$）：
    $$f(y) = \frac{1}{2^{1/2}\Gamma(1/2)} y^{1/2-1} e^{-y/2}$$
    已知 $\Gamma(1/2) = \sqrt{\pi}$ (课堂重点强调)，代入得：
    $$f(y) = \frac{1}{\sqrt{2}\cdot \sqrt{\pi}} y^{-1/2} e^{-y/2} = \frac{1}{\sqrt{2\pi}} y^{-1/2} e^{-y/2}$$
    **结论：两者一致，得证。**

#### **可加性定理**
若 $X_1, \dots, X_m \sim_{i.i.d} N(0,1)$，则：
$$\sum_{i=1}^m X_i^2 \sim \chi^2(m)$$
*自由度 (Degree of Freedom) 相加。*

### 4.3 t-分布 (Student's t-distribution)
> [!summary] 定义
> 如果 $Z \sim N(0, 1)$， $Y \sim \chi^2(m)$，且 $Z, Y$ 独立。
> 定义变量 $T$：
> $$T = \frac{Z}{\sqrt{Y/m}}$$
> 则 $T$ 服从自由度为 $m$ 的 $t$ 分布，记为 $T \sim t(m)$。

* **要求：** 知道定义，能识别 PDF 形状（类似正态但尾部更厚），无需推导 PDF。

### 4.4 F-分布 (F-distribution)
> [!summary] 定义
> 如果 $Y \sim \chi^2(m)$， $W \sim \chi^2(n)$，且 $Y, W$ 独立。
> 定义变量 $F$：
> $$F = \frac{Y/m}{W/n}$$
> 则 $F$ 服从自由度为 $(m, n)$ 的 $F$ 分布，记为 $F \sim F(m, n)$。

---

## 5. 下一步计划
* **第8章剩余：** 下周用一次课讲完，重点是看图表和计算。
* **第9章：** 计算为主，新概念较少，主要应用第7、8章的理论基础。

# 补充笔记：推导细节与考试重点 (Supplement: Derivations & Exam Focus)

> [!warning] **内容说明**
> 本部分包含录音中详细讲解但上一份笔记中简化的推导步骤（特别是 MSE 的分解和有偏估计的计算），以及老师关于考试范围的明确界定。

---

## 1. 均方误差 (MSE) 的详细分解证明

> [!info] **背景**
> 录音中老师特别提到课件（PPT）上关于 MSE 定义的一个**印刷错误 (Typo)**，并详细解释了如何通过代数变形推导出 $MSE = Var + Bias^2$ 的过程 。

**证明目标：**
$$MSE(\hat{\theta}) = E[(\hat{\theta} - \theta)^2] = Var(\hat{\theta}) + [Bias(\hat{\theta})]^2$$

**推导步骤：**
1.  **恒等变形（加一项减一项）：**
    在括号内插入估计量的期望 $E[\hat{\theta}]$：
    $$
    (\hat{\theta} - \theta) = (\hat{\theta} - E[\hat{\theta}]) + (E[\hat{\theta}] - \theta)
    $$
    其中：
    * 第一部分 $(\hat{\theta} - E[\hat{\theta}])$ 是随机变量部分。
    * 第二部分 $(E[\hat{\theta}] - \theta)$ 是常数部分，即 **Bias**。

2.  **展开平方项：**
    $$
    \begin{aligned}
    (\hat{\theta} - \theta)^2 &= [(\hat{\theta} - E[\hat{\theta}]) + (E[\hat{\theta}] - \theta)]^2 \\
    &= (\hat{\theta} - E[\hat{\theta}])^2 + (E[\hat{\theta}] - \theta)^2 + 2(\hat{\theta} - E[\hat{\theta}])(E[\hat{\theta}] - \theta)
    \end{aligned}
    $$

3.  **求期望 $E[\cdot]$：**
    $$
    \begin{aligned}
    E[(\hat{\theta} - \theta)^2] &= E[(\hat{\theta} - E[\hat{\theta}])^2] + E[(Bias)^2] + 2(Bias) \cdot E[\hat{\theta} - E[\hat{\theta}]]
    \end{aligned}
    $$

4.  **化简每一项：**
    * **第一项：** $E[(\hat{\theta} - E[\hat{\theta}])^2]$ 正是方差的定义 $Var(\hat{\theta})$ 。
    * **第二项：** Bias 是常数，常数的期望是其本身，即 $[Bias(\hat{\theta})]^2$。
    * **第三项（交叉项）：** 注意 $E[\hat{\theta}] - E[\hat{\theta}] = 0$，所以交叉项为 0 。

**结论：**
$$MSE(\hat{\theta}) = Var(\hat{\theta}) + (Bias)^2$$
*如果估计量是无偏的 ($Bias=0$)，则 $MSE = Var$。*

---

## 2. 有偏方差估计量 ($\hat{\sigma}_0^2$) 的具体偏差计算

> [!question] **问题**
> [cite_start]老师详细计算了如果除以 $n$ 而不是 $n-1$，期望值具体是多少，以此证明它是 Biased [cite: 9]。

**定义有偏估计量：**
$$\hat{\sigma}_0^2 = \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})^2$$

**推导其期望：**
利用之前证明过的恒等式：$E\left[ \sum (X_i - \bar{X})^2 \right] = (n-1)\sigma^2$。

$$
\begin{aligned}
E[\hat{\sigma}_0^2] &= E\left[ \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})^2 \right] \\
&= \frac{1}{n} E\left[ \sum_{i=1}^n (X_i - \bar{X})^2 \right] \\
&= \frac{1}{n} \cdot (n-1)\sigma^2 \\
&= \frac{n-1}{n} \sigma^2
\end{aligned}
$$

**结论：**
* $E[\hat{\sigma}_0^2] \neq \sigma^2$，所以它是 **Biased Estimator**。
* 它的偏差 (Bias) 为：
    $$Bias = \frac{n-1}{n}\sigma^2 - \sigma^2 = -\frac{1}{n}\sigma^2$$
* 这解释了为什么教科书定义样本方差要除以 $n-1$：为了消除这个偏差。

---

## 3. 无偏估计量的线性组合证明

> [!example] **例子**
>录音中提到的一个具体的数学性质：两个无偏估计量的凸组合（系数和为1）仍然是无偏的 。

**命题：**
已知 $\hat{\theta}_1$ 和 $\hat{\theta}_2$ 都是 $\theta$ 的无偏估计量。
定义新估计量 $\hat{\theta}_{new} = \alpha \hat{\theta}_1 + (1-\alpha) \hat{\theta}_2$，其中 $\alpha$ 是常数。

**证明：**
$$
\begin{aligned}
E[\hat{\theta}_{new}] &= E[\alpha \hat{\theta}_1 + (1-\alpha) \hat{\theta}_2] \\
&= \alpha E[\hat{\theta}_1] + (1-\alpha) E[\hat{\theta}_2] \quad \text{(期望的线性性质)} \\
&= \alpha \theta + (1-\alpha) \theta \quad \text{(因为原估计量无偏)} \\
&= \theta (\alpha + 1 - \alpha) \\
&= \theta
\end{aligned}
$$
**结论：** 无论 $\alpha$ 取何值，只要系数之和为 1，组合后的估计量依然是无偏的。

---

## 4. Gamma 分布矩估计的具体解法

> [!tip] **解题细节**
> 老师口述了如何从矩的方程中解出 $\alpha$ 和 $\beta$ 。

**方程组：**
1.  Mean: $\frac{\alpha}{\beta} = M_1$
2.  Variance: $\frac{\alpha}{\beta^2} = M_2 - M_1^2$ (注意：总体方差等于二阶原点矩减去一阶原点矩的平方)

**求解步骤：**
1.  将方程 (1) 变形为 $\alpha = M_1 \beta$。
2.  代入方程 (2)：
    $$
    \frac{M_1 \beta}{\beta^2} = M_2 - M_1^2 \implies \frac{M_1}{\beta} = M_2 - M_1^2
    $$
3.  解出 $\beta$：
    $$
    \hat{\beta} = \frac{M_1}{M_2 - M_1^2} = \frac{\bar{X}}{\hat{\sigma}^2}
    $$
4.  回代解出 $\alpha$：
    $$
    \hat{\alpha} = M_1 \cdot \hat{\beta} = \frac{M_1^2}{M_2 - M_1^2} = \frac{\bar{X}^2}{\hat{\sigma}^2}
    $$
*(注：此处 $\hat{\sigma}^2$ 指样本二阶中心矩)*

---

## 5. 考试范围明确提示 (Exam Scope)

> [!important] **老师强调的考试要求**
>针对第 8 章的四种分布，老师明确划分了掌握程度 。

| 分布类型                      | 定义与PDF                   | 期望与方差        | 推导证明 (Derivations)                    |
| :------------------------ | :----------------------- | :----------- | :------------------------------------ |
| **Normal (正态)**           | **必须默写 PDF**             | 熟记           | 需掌握标准化过程                              |
| **Chi-Square ($\chi^2$)** | **必须默写 PDF**             | 熟记 ($m, 2m$) | **重点掌握** (必须会推导 $X^2 \sim \chi^2(1)$) |
| **t-distribution**        | 知道定义 (由 Z 和 $\chi^2$ 构成) | 知道概念         | **不要求推导**                             |
| **F-distribution**        | 知道定义 (两个 $\chi^2$ 之比)    | 知道概念         | **不要求推导**                             |

* **重点复习：** 第 7 章的概念比较抽象，是第 9 章的基础，如果有不懂的必须花时间消化 。
* **计算要求：** 第 9 章计算较多，第 8 章的定理多但主要作为工具 。