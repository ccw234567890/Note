# 🧩 多项式系数 (Multinomial Coefficients)

多项式系数是**二项式系数**的直接推广。二项式系数用于将一个集合划分为 **2** 个子集（选中的和未选中的），而多项式系数则用于将一个集合划分为 **k** 个可区分的子集。

---

## 🎯 核心定义

**问题：** 将 $n$ 个不同的元素，分成 $k$ 个不同的组，要求第 1 组有 $n_1$ 个元素，第 2 组有 $n_2$ 个元素，...，第 $k$ 组有 $n_k$ 个元素。

**约束条件：** 所有分组的元素数量之和必须等于总数，即 $n_1 + n_2 + \dots + n_k = n$。

---

## 🔢 多项式系数公式

这个问题的解，即分组的方法总数，由多项式系数给出，其记法和公式如下：

$$
\mathbf{\binom{n}{n_1, n_2, \dots, n_k} = \frac{n!}{n_1! n_2! \dots n_k!}}
$$

---

## 🧠 公式详细推导

这个公式可以通过一个非常直观的、分步选择的过程来推导，每一步都应用我们已经熟悉的**二项式系数** $\binom{n}{k}$。

想象我们有一个包含 $n$ 个元素的池子，需要按顺序为第1组、第2组、...、第k组分配元素。

1.  **为第 1 组选择元素：**
    *   我们需要从全部 $n$ 个元素中，选出 $n_1$ 个放入第 1 组。
    *   根据组合数的定义，方法总数为：
    $$
    C(n, n_1) = \binom{n}{n_1} = \frac{n!}{n_1!(n-n_1)!}
    $$

2.  **为第 2 组选择元素：**
    *   此时，池子里只剩下 $n - n_1$ 个元素。
    *   我们需要从这**剩下**的元素中，选出 $n_2$ 个放入第 2 组。
    *   方法总数为：
    $$
    C(n-n_1, n_2) = \binom{n-n_1}{n_2} = \frac{(n-n_1)!}{n_2!(n-n_1-n_2)!}
    $$

3.  **为第 3 组选择元素：**
    *   现在，池子里还剩下 $n - n_1 - n_2$ 个元素。
    *   我们需要从中选出 $n_3$ 个放入第 3 组。
    *   方法总数为：
    $$
    C(n-n_1-n_2, n_3) = \binom{n-n_1-n_2}{n_3} = \frac{(n-n_1-n_2)!}{n_3!(n-n_1-n_2-n_3)!}
    $$

4.  **以此类推... 直到最后一组：**
    *   当我们为第 $k$ 组选择元素时，池子里恰好剩下 $n_{k}$ 个元素 ($n - n_1 - \dots - n_{k-1} = n_k$)。
    *   从这 $n_k$ 个元素中选出 $n_k$ 个，方法数显然只有 1 种。
    $$
    C(n_k, n_k) = \binom{n_k}{n_k} = \frac{n_k!}{n_k!0!} = 1
    $$

**最终组合：**
根据**乘法原理**，完成整个分配过程的总方法数是上述所有步骤方法数的乘积。

$$
\text{总方法数} = \binom{n}{n_1} \times \binom{n-n_1}{n_2} \times \binom{n-n_1-n_2}{n_3} \times \dots \times \binom{n_k}{n_k}
$$

现在，我们将每个二项式系数用阶乘形式展开：

$$
= \left( \frac{n!}{n_1! (n-n_1)!} \right) \times \left( \frac{(n-n_1)!}{n_2! (n-n_1-n_2)!} \right) \times \left( \frac{(n-n_1-n_2)!}{n_3! (n-n_1-n_2-n_3)!} \right) \times \dots \times \left( \frac{n_k!}{n_k! 0!} \right)
$$

观察这个长长的乘积，我们可以发现一个**链式抵消**的规律：
*   第一项的分母 `(n-n₁)!` 被第二项的分子 `(n-n₁)!` **抵消**。
*   第二项的分母 `(n-n₁-n₂)!` 被第三项的分子 `(n-n₁-n₂)!` **抵消**。
*   这个过程会一直持续下去，直到最后。

所有中间项都被抵消后，只剩下第一项的分子 $n!$ 和每一项分母中的 $n_i!$。

$$
\text{总方法数} = \frac{n!}{n_1! n_2! n_3! \dots n_k!}
$$

**推导完成。** 这就是多项式系数的最终形式。

---

## 🚀 应用实例

### 1. 委员会分配 (Example 1.9.1)

*   **问题:** 20人分成3个委员会，人数分别为8人、8人、4人。
*   **分析:** $n=20$, $n_1=8, n_2=8, n_3=4$。
*   **解:**
    $$
    \binom{20}{8, 8, 4} = \frac{20!}{8! \cdot 8! \cdot 4!}
    $$

### 2. 多类型排列 (Permutations with Repetitions)

*   **问题:** 排列 n 个物品，其中有 $n_1$ 个A类物品，$n_2$ 个B类物品...
*   **分析:** 这可以看作是将 $n$ 个**位置**分配给 $k$ 类物品。
*   **解:** 方法数同样是多项式系数 $\binom{n}{n_1, n_2, \dots, n_k}$。例如，排列单词 "MISSISSIPPI" (1 M, 4 I, 4 S, 2 P, 总计 11 个字母) 的方法数是:
    $$
    \binom{11}{1, 4, 4, 2} = \frac{11!}{1! \cdot 4! \cdot 4! \cdot 2!}
    $$

### 3. 掷骰子概率 (Example 1.9.3)

*   **问题:** 掷12次骰子，每个点数(1-6)各出现2次的概率。
*   **分析:**
    *   **总样本空间:** 每次掷骰有6种可能，共12次，所以总结果数为 $6^{12}$。
    *   **有利结果数:** 将12次投掷看作12个位置，分配给6个点数，每个点数占2个位置。$n=12, n_1=n_2=\dots=n_6=2$。
        $$
        \text{有利情况} = \binom{12}{2, 2, 2, 2, 2, 2} = \frac{12!}{(2!)^6}
        $$
    *   **概率:**
        $$
        P = \frac{\binom{12}{2,2,2,2,2,2}}{6^{12}} \approx 0.0034
        $$

### 4. 扑克牌分发 (Example 1.9.4)

*   **问题:** 52张牌发给4个玩家(A,B,C,D)，每人13张。A得6张红心, B得4张, C得2张, D得1张的概率。
*   **分析:** 这是一个多步组合问题。
    1.  **总分牌方法 (分母 N):** 将52张牌分为4组，每组13张。
        $$ N = \binom{52}{13, 13, 13, 13} = \frac{52!}{(13!)^4} $$
    2.  **有利分牌方法 (分子 M):**
        *   **第一步：** 分配13张红心。将13张红心按 (6,4,2,1) 的数量分给4位玩家。
            $$ M_1 = \binom{13}{6, 4, 2, 1} = \frac{13!}{6!4!2!1!} $$
        *   **第二步：** 分配剩下的39张非红心牌。为了让每位玩家都凑满13张牌，剩下的牌必须按 (7,9,11,12) 的数量分配 (A: 13-6=7, B: 13-4=9, ...)。
            $$ M_2 = \binom{39}{7, 9, 11, 12} = \frac{39!}{7!9!11!12!} $$
        *   **总有利情况** $M = M_1 \times M_2$
    3.  **最终概率:**
        $$ P = \frac{M}{N} = \frac{\binom{13}{6,4,2,1} \times \binom{39}{7,9,11,12}}{\binom{52}{13,13,13,13}} $$
---