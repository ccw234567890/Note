# 概率论作业解析 (Assignment 8)

---
![410c3c45-34ae-4fe5-b85b-986fb03c49c8.png](https://cc-407-1376569927.cos.ap-guangzhou.myqcloud.com/cc-407-1376569927/images-obsidian/202511291833107.png)

## Section 7.5: Maximum Likelihood Estimation (极大似然估计)

### 1. 离散均匀分布的方差 (7.5.1)

> [!question] 题目
> Let $x_1, ..., x_n$ be distinct numbers. Let $Y$ be a discrete random variable with p.f. $f(y) = 1/n$ if $y \in \{x_1, ..., x_n\}$, and 0 otherwise.
> **Prove that $Var(Y)$ is given by Eq. (7.5.5)**.
> *(注: Eq. 7.5.5 指的是样本方差公式 $\hat{\sigma}^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2$)*

> [!info] 核心知识点
> - **离散型期望**: $E(Y) = \sum y f(y)$
> - **离散型方差**: $Var(Y) = E[(Y - E(Y))^2] = \sum (y - E(Y))^2 f(y)$
> - **经验分布**: 这个问题实际上是在证明“经验分布的方差”等于“样本方差（MLE定义）”。

**解析**:

1.  **计算期望 $E(Y)$**:
    由于 $Y$ 在 $n$ 个值上均匀分布，概率均为 $\frac{1}{n}$：
    $$
    E(Y) = \sum_{i=1}^{n} x_i \cdot f(x_i) = \sum_{i=1}^{n} x_i \cdot \frac{1}{n} = \frac{1}{n}\sum_{i=1}^{n} x_i = \bar{x}_n
    $$
    即 $Y$ 的期望等于样本均值。

2.  **计算方差 $Var(Y)$**:
    根据方差的定义：
    $$
    Var(Y) = E[(Y - E(Y))^2] = \sum_{i=1}^{n} (x_i - \bar{x}_n)^2 \cdot f(x_i)
    $$
    代入 $f(x_i) = \frac{1}{n}$：
    $$
    Var(Y) = \sum_{i=1}^{n} (x_i - \bar{x}_n)^2 \cdot \frac{1}{n} = \frac{1}{n}\sum_{i=1}^{n} (x_i - \bar{x}_n)^2
    $$
**结论**: 得证，该结果与 Eq. (7.5.5) 一致。

---

### 4. 伯努利分布 MLE 的存在性 (7.5.4)

> [!question] 题目
> $X_1, ..., X_n \sim \text{Bernoulli}(\theta)$, $\theta$ unknown but $\theta \in (0, 1)$.
> Show that the M.L.E. of $\theta$ **does not exist** if every observed value is 0 or every observed value is 1.

> [!tip] 知识点: 似然函数与开区间极值
> - **似然函数**: $L(\theta) = \prod p(x_i|\theta)$。
> - **极值问题**: 如果函数单调，且定义域是开区间 $(a, b)$，则函数在区间内无最大值（最大值在端点取到，但端点不在定义域内）。

**解析**:
伯努利分布的似然函数为：
$$
L(\theta) = \prod_{i=1}^n \theta^{x_i} (1-\theta)^{1-x_i} = \theta^{\sum x_i} (1-\theta)^{n - \sum x_i}
$$

1.  **情形 1: 全是 0 (Every observed value is 0)**
    此时 $\sum x_i = 0$。似然函数变为：
    $$
    L(\theta) = \theta^0 (1-\theta)^n = (1-\theta)^n
    $$
    在区间 $(0, 1)$ 上，$(1-\theta)^n$ 是关于 $\theta$ 的**单调递减**函数。
    - 理论最大值在 $\theta = 0$ 处取到。
    - 但题目限定 $\theta \in (0, 1)$（开区间），$\theta$ 不能取 0。
    - 因此，在 $(0, 1)$ 内不存在最大值点。

2.  **情形 2: 全是 1 (Every observed value is 1)**
    此时 $\sum x_i = n$。似然函数变为：
    $$
    L(\theta) = \theta^n (1-\theta)^0 = \theta^n
    $$
    在区间 $(0, 1)$ 上，$\theta^n$ 是关于 $\theta$ 的**单调递增**函数。
    - 理论最大值在 $\theta = 1$ 处取到。
    - 同样，由于 $\theta$ 不能取 1，在 $(0, 1)$ 内不存在最大值点。

**结论**: M.L.E. 不存在。

---

### 6. 正态分布方差的 MLE (已知均值) (7.5.6)

> [!question] 题目
> $X_1, ..., X_n \sim N(\mu, \sigma^2)$, $\mu$ is known, $\sigma^2$ is unknown. Find the M.L.E. of $\sigma^2$.

> [!summary] 知识点
> - **正态 PDF**: $f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}$
> - **参数变换**: 令 $\tau = \sigma^2$ 作为待估参数，计算会更简单。

**解析**:
1.  **写出似然函数**:
    令 $\tau = \sigma^2$。
    $$
    L(\tau) = \prod_{i=1}^n \frac{1}{\sqrt{2\pi\tau}} e^{-\frac{(x_i-\mu)^2}{2\tau}} = (2\pi\tau)^{-n/2} \exp\left(-\frac{1}{2\tau}\sum_{i=1}^n (x_i-\mu)^2\right)
    $$
2.  **对数似然**:
    $$
    l(\tau) = \ln L(\tau) = -\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln(\tau) - \frac{1}{2\tau}\sum_{i=1}^n (x_i-\mu)^2
    $$
3.  **求导并置零**:
    $$
    \frac{dl}{d\tau} = -\frac{n}{2\tau} + \frac{1}{2\tau^2}\sum_{i=1}^n (x_i-\mu)^2 = 0
    $$
4.  **求解**:
    两边同乘 $2\tau^2$：
    $$
    -n\tau + \sum_{i=1}^n (x_i-\mu)^2 = 0 \implies \tau = \frac{1}{n}\sum_{i=1}^n (x_i-\mu)^2
    $$

**答案**:
$$
\hat{\sigma}^2 = \frac{1}{n}\sum_{i=1}^n (X_i - \mu)^2
$$

---

### 9. 幂律分布的 MLE (7.5.9)

> [!question] 题目
> $f(x|\theta) = \theta x^{\theta-1}$ for $0<x<1$ ($\theta > 0$). Find M.L.E. of $\theta$.

**解析**:
1.  **似然函数**:
    $$
    L(\theta) = \prod_{i=1}^n \theta x_i^{\theta-1} = \theta^n \left(\prod_{i=1}^n x_i\right)^{\theta-1}
    $$
2.  **对数似然**:
    $$
    l(\theta) = n \ln \theta + (\theta-1) \sum_{i=1}^n \ln x_i
    $$
3.  **求导**:
    $$
    \frac{dl}{d\theta} = \frac{n}{\theta} + \sum_{i=1}^n \ln x_i = 0
    $$
4.  **求解**:
    $$
    \frac{n}{\theta} = - \sum_{i=1}^n \ln x_i \implies \hat{\theta} = \frac{n}{-\sum_{i=1}^n \ln X_i}
    $$

> [!note] 注意
> 由于 $0 < X_i < 1$，所以 $\ln X_i$ 是负数。分母上的负号保证了 $\hat{\theta}$ 是正数。

---
![bee9fc62-83d7-40d9-ada2-0c1057a33309.png](https://cc-407-1376569927.cos.ap-guangzhou.myqcloud.com/cc-407-1376569927/images-obsidian/202511291833575.png)

### 10. 拉普拉斯分布的 MLE (7.5.10)

> [!question] 题目
> $f(x|\theta) = \frac{1}{2}e^{-|x-\theta|}$. Find M.L.E. of $\theta$.
> **Hint**: Compare to minimizing M.A.E (Mean Absolute Error) as in Theorem 4.5.3.

> [!example] 引用: Theorem 4.5.3
> 该定理指出：函数 $Q(d) = E[|X-d|]$ (或者样本形式 $\sum |x_i - d|$) 在 $d$ 取**中位数 (Median)** 时达到最小。

**解析**:
1.  **似然函数**:
    $$
    L(\theta) = \prod_{i=1}^n \frac{1}{2} e^{-|x_i - \theta|} = \frac{1}{2^n} \exp\left(-\sum_{i=1}^n |x_i - \theta|\right)
    $$
2.  **最大化**:
    要最大化 $L(\theta)$，等价于最大化指数部分，即**最小化**指数上的负号部分：
    $$
    \min_\theta \sum_{i=1}^n |x_i - \theta|
    $$
3.  **利用 Hint**:
    这就变成了寻找一个数 $\theta$，使得它到所有样本点的“绝对距离之和”最小。根据统计学性质（Theorem 4.5.3），这个数是**样本中位数**。

**答案**:
$$
\hat{\theta} = \text{Sample Median} (X_1, ..., X_n)
$$
*(注：如果 $n$ 是偶数，中位数取中间两个数的任意值均可使似然达到最大，通常取平均，但在MLE严格定义下，两者之间的区间都是最大似然估计)*

---

### 11. 均匀分布区间的 MLE (7.5.11)

> [!question] 题目
> Uniform distribution on $[\theta_1, \theta_2]$. Find M.L.E. of $\theta_1, \theta_2$.

> [!important] 技巧: 指示函数 (Indicator Function)
> 均匀分布的 PDF 只有在 $\theta_1 \le x \le \theta_2$ 时非零。这在似然函数中表现为约束条件。

**解析**:
1.  **似然函数**:
    $$
    L(\theta_1, \theta_2) = \prod_{i=1}^n \frac{1}{\theta_2 - \theta_1} \cdot I_{[\theta_1, \theta_2]}(x_i)
    $$
    其中 $I$ 是指示函数。如果所有 $x_i$ 都在 $[\theta_1, \theta_2]$ 内，则 $L = (\theta_2 - \theta_1)^{-n}$；否则 $L=0$。
2.  **约束条件**:
    为了使 $L \neq 0$，必须满足：
    $$
    \theta_1 \le \min(x_1, ..., x_n) \quad \text{且} \quad \theta_2 \ge \max(x_1, ..., x_n)
    $$
3.  **最大化**:
    在满足上述约束的前提下，要最大化 $L = \frac{1}{(\theta_2 - \theta_1)^n}$，必须使分母 $(\theta_2 - \theta_1)$ **尽可能小**。
    - $\theta_1$ 应该尽可能大 $\implies$ 取上限 $\min(x_i)$。
    - $\theta_2$ 应该尽可能小 $\implies$ 取下限 $\max(x_i)$。

**答案**:
$$
\hat{\theta}_1 = X_{(1)} = \min(X_i), \quad \hat{\theta}_2 = X_{(n)} = \max(X_i)
$$

---

## Section 8.2: Sampling Distributions

### 1. 卡方分布的应用 (8.2.1)

> [!question] 题目
> Sample 20 chunks ($n=20$). Let $T = \sum_{i=1}^{20}(X_i - \mu)^2 / 20$. Assume $\sigma^2 = 0.09$.
> What number $c$ satisfies $Pr(T \le c) = 0.9$?

> [!info] 知识点: 卡方分布 ($\chi^2$)
> 若 $X_i \sim N(\mu, \sigma^2)$，则 $\sum_{i=1}^n \frac{(X_i - \mu)^2}{\sigma^2} \sim \chi^2_n$（自由度为 $n$）。

**解析**:
1.  **构造统计量**:
    已知 $T = \frac{1}{20}\sum (X_i - \mu)^2$。
    构造符合卡方分布的变量 $Y$：
    $$
    Y = \sum_{i=1}^{20} \frac{(X_i - \mu)^2}{\sigma^2} \sim \chi^2_{20}
    $$
2.  **建立 $T$ 和 $Y$ 的关系**:
    $$
    Y = \frac{1}{\sigma^2} \sum (X_i - \mu)^2 = \frac{20}{\sigma^2} \cdot \left( \frac{\sum (X_i - \mu)^2}{20} \right) = \frac{20T}{\sigma^2}
    $$
    代入 $\sigma^2 = 0.09$，得 $Y = \frac{20T}{0.09}$。
3.  **求解 $c$**:
    题目要求 $Pr(T \le c) = 0.9$。
    $$
    Pr(\frac{0.09Y}{20} \le c) = Pr(Y \le \frac{20c}{0.09}) = 0.9
    $$
    查 **Chi-square Table** (自由度 $m=20$, 概率 $p=0.9$):
    找到对应的值为 **28.41**。
    $$
    \frac{20c}{0.09} = 28.41 \implies c = \frac{28.41 \times 0.09}{20} \approx 0.1278
    $$

**答案**: $c \approx 0.1278$.

---

### 9. 导出分布 (8.2.9)

> [!question] 题目
> Find the distribution of $\frac{n(\bar{X}_n - \mu)^2}{\sigma^2}$.

> [!info] 知识点: 样本均值的分布
> 若 $X_i \sim N(\mu, \sigma^2)$，则 $\bar{X} \sim N(\mu, \sigma^2/n)$。
> 标准化: $Z = \frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \sim N(0, 1)$。
> 性质: 标准正态的平方服从 $\chi^2_1$。

**解析**:
1.  将表达式重写为完全平方形式：
    $$
    W = \frac{n(\bar{X}_n - \mu)^2}{\sigma^2} = \left( \frac{\bar{X}_n - \mu}{\sigma/\sqrt{n}} \right)^2
    $$
2.  括号内的部分正是样本均值的标准化形式 $Z \sim N(0, 1)$。
3.  因此 $W = Z^2$。

**答案**:
该统计量服从自由度为 1 的卡方分布，即 **$\chi^2_1$ distribution**。

---

## Section 8.4: MLE Sampling Distribution

### 2. t-分布与 MLE (8.4.2)

> [!question] 题目
> $X_i \sim N(\mu, \sigma^2)$ unknown parameters. $\hat{\mu}, \hat{\sigma}$ are M.L.E.s.
> Sample size $n=17$. Find $k$ such that $Pr(\hat{\mu} > \mu + k\hat{\sigma}) = 0.95$.

> [!warning] 关键点: MLE $\hat{\sigma}$ vs 样本标准差 $S$
> - MLE: $\hat{\sigma}^2 = \frac{1}{n}\sum(X_i - \bar{X})^2$
> - 样本方差 (无偏): $S^2 = \frac{1}{n-1}\sum(X_i - \bar{X})^2$
> - 关系: $\hat{\sigma} = \sqrt{\frac{n-1}{n}} S$

**解析**:
1.  **转化不等式**:
    $$
    Pr(\hat{\mu} - \mu > k\hat{\sigma}) = Pr\left( \frac{\hat{\mu} - \mu}{\hat{\sigma}} > k \right) = 0.95
    $$
    其中 $\hat{\mu} = \bar{X}$。
2.  **引入 t-分布**:
    我们知道统计量 $T = \frac{\bar{X} - \mu}{S/\sqrt{n}} \sim t_{n-1}$。
    利用 $\hat{\sigma}$ 和 $S$ 的关系 $\hat{\sigma} = S \sqrt{\frac{n-1}{n}}$，代入上式左边：
    $$
    \frac{\hat{\mu} - \mu}{\hat{\sigma}} = \frac{\bar{X} - \mu}{S \sqrt{\frac{n-1}{n}}} = \frac{\bar{X} - \mu}{S/\sqrt{n}} \cdot \frac{1}{\sqrt{n-1}} = \frac{T}{\sqrt{n-1}}
    $$
    其中 $T \sim t_{16}$ (因为 $n=17, df=16$)。
3.  **确定临界值**:
    题目变为：求 $k$ 使得
    $$
    Pr\left( \frac{T}{\sqrt{16}} > k \right) = 0.95 \implies Pr(T > 4k) = 0.95
    $$
    这意味着 $4k$ 是 t-分布的一个极小分位点（因为大于它的概率高达 0.95，说明 $4k$ 在分布的最左侧）。
    根据对称性 $Pr(T > 4k) = 0.95 \iff Pr(T < -4k) = 0.95$。
    查 **t-Distribution Table** ($m=16$, $p=0.95$):
    对应值为 **1.746**。
    $$
    -4k = 1.746 \implies k = -\frac{1.746}{4} = -0.4365
    $$

**答案**: $k = -0.4365$.

