---
aliases: [4.3 矩, 矩母函数, MGF]
tags: [概率论, 统计学, 笔记]
date: 2025-11-12
---

# 4.3 Moments (矩)

> [!WARNING] 💡 教授的课前重要提示
> * **课程难度**：这门课的后半学期极其困难，有非常多的定义、定理和复杂计算。很多术语即便是翻译成中文也难以理解，建议==尽量用英文去理解英文的定义==。
> * **学习方法**：每天上完课，至少要花半小时到一个小时去复习当天的内容，**必须自己亲手推导一遍公式**。
> * **课程进度**：课程进度会非常快，内容很多，计算很复杂，涉及到很多微积分的知识。
> * **关于考试**：这门课的考核会非常严格，旨在考察是否真正学懂。平时不努力、缺课、只靠最后刷题是无法通过的。
> * **出勤**：最后这几周的内容非常关键，千万不能缺课。

---

## 1. 矩 (Moments)

> [!NOTE] 📌 定义：K阶矩 (k-th Moment)
> 对于一个随机变量 $X$ 和任意正整数 $k$，$E(X^k)$ 被称为 $X$ 的 **k阶矩**。
> 
> 在数学上，如果 $X$ 是一个连续型随机变量，其概率密度函数 (PDF) 为 $f(x)$，那么它的k阶矩计算公式为：
> $$
> E(X^k) = \int_{-\infty}^{\infty} x^k f(x) dx
> $$

> [!ABSTRACT] 📜 定理 4.4.1：矩的存在性
> 如果 $E(|X|^k) < \infty$（即k阶矩存在且有限），那么对于任意正整数 $j < k$，$E(|X|^j)$ 也必定存在且有限。
> 
> **通俗解释**：如果一个高阶矩（比如10阶矩）存在，那么所有比它低的矩（9阶、8阶...1阶）都必定存在。

#### 证明过程：

我们要证明 $E(|X|^j) < \infty$。

1.  **根据定义拆分积分**：
    $E(|X|^j) = \int_{-\infty}^{\infty} |x|^j f(x) dx$
    我们可以把这个积分拆成两部分：$|x| \le 1$ 和 $|x| > 1$。
    $E(|X|^j) = \int_{|x| \le 1} |x|^j f(x) dx + \int_{|x| > 1} |x|^j f(x) dx$

2.  **分析第一部分 ($|x| \le 1$)**：
    当 $|x| \le 1$ 时，我们知道 $|x|^j \le 1$ (因为 $j$ 是正整数)。
    所以：$\int_{|x| \le 1} |x|^j f(x) dx \le \int_{|x| \le 1} 1 \cdot f(x) dx = P(|x| \le 1)$
    这部分的值是一个概率，所以它必定 $\le 1$，是一个有限的数。

3.  **分析第二部分 ($|x| > 1$)**：
    当 $|x| > 1$ 时，因为 $j < k$，所以 $|x|^j < |x|^k$。
    所以：$\int_{|x| > 1} |x|^j f(x) dx \le \int_{|x| > 1} |x|^k f(x) dx$

4.  **合并与放缩**：
    $\int_{|x| > 1} |x|^k f(x) dx$ 只是 $E(|X|^k)$ 的一部分。因为 $f(x) \ge 0$，所以这一部分必定小于或等于 $E(|X|^k)$ 的总和：
    $\int_{|x| > 1} |x|^k f(x) dx \le \int_{-\infty}^{\infty} |x|^k f(x) dx = E(|X|^k)$
    
    综合起来，我们得到：
    $E(|X|^j) \le P(|x| \le 1) + E(|X|^k)$

5.  **得出结论**：
    根据已知条件，$E(|X|^k)$ 是一个有限的数。$P(|x| \le 1)$ 也是一个有限的数（$\le 1$）。两个有限的数相加，结果仍然是有限的。
    因此，$E(|X|^j) < \infty$，定理得证。

---

## 2. 中心矩 (Central Moments)

> [!NOTE] 📌 定义：K阶中心矩 (k-th Central Moment)
> 假设 $X$ 的期望（均值）为 $\mu = E(X)$。对于任意正整数 $k$，$E[(X-\mu)^k]$ 被称为 $X$ 的 **k阶中心矩**，或 $X$ **关于均值的k阶矩**。

* **一阶中心矩 (k=1)**：
    $E[(X-\mu)^1] = E(X) - E(\mu)$
    因为 $\mu$ 是一个常数， $E(\mu) = \mu$。
    所以：$E(X) - \mu = \mu - \mu = 0$
    ==一阶中心矩恒等于0。==

* **二阶中心矩 (k=2)**：
    $E[(X-\mu)^2]$
    ==这就是**方差 (Variance)** $Var(X)$ 的定义==。它衡量的是随机变量 $X$ 在其均值 $\mu$ 附近波动的剧烈程度。

* **高阶中心矩 (k=3, 4, ...)**：
    当 $k$ 增加时，高阶中心矩 $E[(X-\mu)^k]$ 会更加关注那些**远离均值 $\mu$ 的值**（即“波动大的地方”）。
    * 例如，一个 $0.1$ 的小波动，它的4次方 $0.1^4 = 0.0001$，几乎被忽略了。
    * 而一个 $10$ 的大波动，它的4次方 $10^4 = 10000$，被极大地放大了。
    * 因此，高阶矩可以提供更多关于分布“尾部”的信息。

* **对称性 (Symmetry)**：
    如果一个随机变量 $X$ 的分布是**对称的**（例如正态分布），那么它的均值 $\mu$ 就在对称中心。
    在这种情况下，对于**任意奇数 $k$**（$k=1, 3, 5, \dots$），k阶中心矩 $E[(X-\mu)^k]$ **必定等于0**。
    * *理解*：在积分 $\int (x-\mu)^k f(x) dx$ 中，因为 $k$ 是奇数，$(x-\mu)^k$ 是一个奇函数（相对于 $\mu$）。$f(x)$ 是对称的（偶函数）。奇函数乘以偶函数仍然是奇函数，其在对称区间（$-\infty, \infty$）上的积分必定为0。

---

## 3. 偏度 (Skewness)

> [!NOTE] 📌 定义：偏度 (Skewness)
> 偏度是用来衡量随机变量 $X$ 分布的**不对称性**。
> 
> **定义式**：
> $$
> \text{Skewness} = \frac{E[(X-\mu)^3]}{\sigma^3} = \frac{E[(X-\mu)^3]}{(\sqrt{E[(X-\mu)^2]})^3}
> $$
> 
> * 如果分布是**对称的**，三阶中心矩 $E[(X-\mu)^3]$ 为0，偏度为0。
> * 如果 $E[(X-\mu)^3] \neq 0$，说明分布是不对称的。这个值越大，说明不对称性越强。

---

## 4. 矩母函数 (Moment Generating Function, MGF)

> [!TIP] 🌟 **本日最重要概念**
> 矩母函数 (MGF) 是今天所有概念中最重要、最有用的一个。

> [!NOTE] 📌 定义：矩母函数 (MGF)
> 对于一个随机变量 $X$，对任意实数 $t$，定义函数 $\psi(t)$：
> $$
> \psi(t) = E(e^{tX})
> $$
> 这个函数 $\psi(t)$ 就被称为 $X$ 的**矩母函数**。
> 
> * **计算方法**：
> * **连续型**：$\psi(t) = \int_{-\infty}^{\infty} e^{tx} f(x) dx$
> * **离散型**：$\psi(t) = \sum_{x} e^{tx} P(X=x)$
> 
> * **存在条件**：MGF 必须在 $t=0$ 附近的一个开放区间内是有限的（即积分/求和必须收敛）。

#### 为什么叫“矩母函数”？

因为它是一个可以“生成” (Generate) 所有阶矩 (Moment) 的“母亲” (Mother Function)。

> [!ABSTRACT] 📜 核心定理：MGF 与 矩
> 如果 $X$ 的MGF $\psi(t)$ 存在，那么 $X$ 的n阶矩 $E(X^n)$ 可以通过对 $\psi(t)$ 求n阶导数，并在 $t=0$ 处取值得到：
> $$
> E(X^n) = \psi^{(n)}(0) = \left. \frac{d^n}{dt^n} \psi(t) \right|_{t=0}
> $$

**几个重要的例子**：
* **一阶矩（均值）**：$E(X) = \psi'(0)$
* **二阶矩**：$E(X^2) = \psi''(0)$
* **方差**：$Var(X) = E(X^2) - [E(X)]^2 = \psi''(0) - [\psi'(0)]^2$

#### 定理的简单证明：

我们来证明 $E(X^n) = \psi^{(n)}(0)$。

1.  **MGF 定义**：
    $\psi(t) = E(e^{tX})$

2.  **求一阶导**：
    $\psi'(t) = \frac{d}{dt} E(e^{tX})$
    (假设我们可以交换求导和求期望的顺序)
    $\psi'(t) = E\left[ \frac{d}{dt} e^{tX} \right]$
    根据链式法则，$\frac{d}{dt} e^{tX} = X \cdot e^{tX}$
    $\psi'(t) = E[X e^{tX}]$

3.  **在 $t=0$ 处取值**：
    $\psi'(0) = E[X e^{0 \cdot X}] = E[X \cdot 1] = E(X)$
    **证明了：$E(X) = \psi'(0)$**

4.  **求二阶导**：
    $\psi''(t) = \frac{d}{dt} \psi'(t) = \frac{d}{dt} E[X e^{tX}]$
    $\psi''(t) = E\left[ \frac{d}{dt} (X e^{tX}) \right]$
    $\frac{d}{dt} (X e^{tX}) = X \cdot (X e^{tX}) = X^2 e^{tX}$
    $\psi''(t) = E[X^2 e^{tX}]$

5.  **在 $t=0$ 处取值**：
    $\psi''(0) = E[X^2 e^{0 \cdot X}] = E[X^2 \cdot 1] = E(X^2)$
    **证明了：$E(X^2) = \psi''(0)$**

6.  **推广到n阶**：
    $\psi^{(n)}(t) = E[X^n e^{tX}]$
    $\psi^{(n)}(0) = E[X^n e^0] = E(X^n)$
    **定理证毕。**

---

## 5. 常见分布的MGF计算实例

下面我们将用MGF定理来推导我们学过的几个重要分布的均值和方差。

### 实例1：指数分布 (Exponential Distribution)
**PDF**: $f(x) = e^{-x}, \quad \text{for } x > 0$

1.  **计算 MGF $\psi(t)$**：
    $\psi(t) = E(e^{tX}) = \int_{0}^{\infty} e^{tx} f(x) dx = \int_{0}^{\infty} e^{tx} e^{-x} dx$
    $= \int_{0}^{\infty} e^{(t-1)x} dx$
    (为使积分收敛，必须 $t-1 < 0$，即 $t < 1$)
    $= \left[ \frac{1}{t-1} e^{(t-1)x} \right]_0^{\infty}$
    $= \lim_{x \to \infty} \left( \frac{1}{t-1} e^{(t-1)x} \right) - \left( \frac{1}{t-1} e^0 \right)$
    $= (0) - \left( \frac{1}{t-1} \right) = -\frac{1}{t-1} = \frac{1}{1-t}$
    $\psi(t) = (1-t)^{-1}$

2.  **求导**：
    * $\psi'(t) = \frac{d}{dt} (1-t)^{-1} = (-1)(1-t)^{-2}(-1) = (1-t)^{-2}$
    * $\psi''(t) = \frac{d}{dt} (1-t)^{-2} = (-2)(1-t)^{-3}(-1) = 2(1-t)^{-3}$

3.  **计算均值和方差**：
    * **均值**：$E(X) = \psi'(0) = (1-0)^{-2} = 1$
    * **二阶矩**：$E(X^2) = \psi''(0) = 2(1-0)^{-3} = 2$
    * **方差**：$Var(X) = E(X^2) - [E(X)]^2 = 2 - 1^2 = 1$

---
### 实例2：伯努利分布 (Bernoulli Distribution)
**PF**: $P(X=1) = p$, $P(X=0) = 1-p$

1.  **计算 MGF $\psi(t)$**：
    $\psi(t) = E(e^{tX}) = \sum_{x} e^{tx} P(X=x)$
    $= e^{t \cdot 0} P(X=0) + e^{t \cdot 1} P(X=1)$
    $= 1 \cdot (1-p) + e^t \cdot p$
    $\psi(t) = 1 - p + pe^t$

2.  **求导**：
    * $\psi'(t) = \frac{d}{dt} (1 - p + pe^t) = pe^t$
    * $\psi''(t) = \frac{d}{dt} (pe^t) = pe^t$

3.  **计算均值和方差**：
    * **均值**：$E(X) = \psi'(0) = pe^0 = p$
    * **二阶矩**：$E(X^2) = \psi''(0) = pe^0 = p$
    * **方差**：$Var(X) = E(X^2) - [E(X)]^2 = p - p^2 = p(1-p)$

---
### 实例3：二项分布 (Binomial Distribution)
**PF**: $P(X=k) = \binom{n}{k} p^k (1-p)^{n-k}, \quad k=0, 1, \dots, n$

1.  **计算 MGF $\psi(t)$**：
    $\psi(t) = E(e^{tX}) = \sum_{k=0}^{n} e^{tk} \cdot \binom{n}{k} p^k (1-p)^{n-k}$
    $= \sum_{k=0}^{n} \binom{n}{k} (e^t p)^k (1-p)^{n-k}$
    (这里我们使用==二项式定理==: $(a+b)^n = \sum_{k=0}^{n} \binom{n}{k} a^k b^{n-k}$)
    令 $a = pe^t$, $b = (1-p)$
    $\psi(t) = (pe^t + 1 - p)^n$

2.  **求导**：
    * $\psi'(t) = \frac{d}{dt} (pe^t + 1 - p)^n = n(pe^t + 1 - p)^{n-1} \cdot (pe^t)$
    * $\psi''(t)$ (使用乘法法则)：
        $= [n(n-1)(pe^t + 1-p)^{n-2}(pe^t)] \cdot (pe^t) + [n(pe^t + 1-p)^{n-1}] \cdot (pe^t)$

3.  **计算均值和方差**：
    * **均值**：$E(X) = \psi'(0)$
        $= n(pe^0 + 1 - p)^{n-1} \cdot (pe^0)$
        $= n(p + 1 - p)^{n-1} \cdot p = n(1)^{n-1} p = np$
    * **二阶矩**：$E(X^2) = \psi''(0)$
        $= [n(n-1)(p+1-p)^{n-2}(p)] \cdot (p) + [n(p+1-p)^{n-1}] \cdot (p)$
        $= n(n-1)(1)^{n-2} p^2 + n(1)^{n-1} p = n(n-1)p^2 + np$
    * **方差**：$Var(X) = E(X^2) - [E(X)]^2$
        $= (n(n-1)p^2 + np) - (np)^2$
        $= (n^2p^2 - np^2 + np) - n^2p^2 = np - np^2 = np(1-p)$

---
### 实例4：泊松分布 (Poisson Distribution)
**PF**: $P(X=x) = \frac{e^{-\lambda} \lambda^x}{x!}, \quad x=0, 1, 2, \dots$

1.  **计算 MGF $\psi(t)$**：
    $\psi(t) = E(e^{tX}) = \sum_{x=0}^{\infty} e^{tx} \cdot \frac{e^{-\lambda} \lambda^x}{x!}$
    $= e^{-\lambda} \sum_{x=0}^{\infty} \frac{(e^t \lambda)^x}{x!}$
    (这里我们使用==$e^u$的泰勒级数展开==: $e^u = \sum_{x=0}^{\infty} \frac{u^x}{x!}$)
    令 $u = \lambda e^t$
    $= e^{-\lambda} \cdot e^{\lambda e^t} = e^{\lambda e^t - \lambda}$
    $\psi(t) = e^{\lambda(e^t - 1)}$

2.  **求导**：
    * $\psi'(t) = \frac{d}{dt} [e^{\lambda(e^t - 1)}] = e^{\lambda(e^t - 1)} \cdot (\lambda e^t)$
    * $\psi''(t)$ (使用乘法法则)：
        $= [e^{\lambda(e^t - 1)} \cdot (\lambda e^t)] \cdot (\lambda e^t) + [e^{\lambda(e^t - 1)}] \cdot (\lambda e^t)$
        $= \lambda^2 e^{2t} e^{\lambda(e^t - 1)} + \lambda e^t e^{\lambda(e^t - 1)}$

3.  **计算均值和方差**：
    * **均值**：$E(X) = \psi'(0)$
        $= e^{\lambda(e^0 - 1)} \cdot (\lambda e^0) = e^{\lambda(1 - 1)} \cdot \lambda = e^0 \cdot \lambda = \lambda$
    * **二阶矩**：$E(X^2) = \psi''(0)$
        $= \lambda^2 e^0 e^{\lambda(e^0 - 1)} + \lambda e^0 e^{\lambda(e^0 - 1)}$
        $= \lambda^2 e^0 e^0 + \lambda e^0 e^0 = \lambda^2 + \lambda$
    * **方差**：$Var(X) = E(X^2) - [E(X)]^2$
        $= (\lambda^2 + \lambda) - (\lambda)^2 = \lambda$

---
### 实例5：均匀分布 (Uniform Distribution)
**PDF**: $f(x) = \frac{1}{b-a}, \quad \text{for } x \in [a, b]$

1.  **计算 MGF $\psi(t)$**：
    $\psi(t) = E(e^{tX}) = \int_{a}^{b} e^{tx} \cdot \frac{1}{b-a} dx$
    $= \frac{1}{b-a} \left[ \frac{1}{t} e^{tx} \right]_a^b$
    $\psi(t) = \frac{e^{tb} - e^{ta}}{t(b-a)}$

---
### 实例6：指数分布 (General Exponential)
**PDF**: $f(x) = \lambda e^{-\lambda x}, \quad \text{for } x > 0$

1.  **计算 MGF $\psi(t)$**：
    $\psi(t) = E(e^{tX}) = \int_{0}^{\infty} e^{tx} (\lambda e^{-\lambda x}) dx = \lambda \int_{0}^{\infty} e^{(t-\lambda)x} dx$
    (为使积分收敛，必须 $t - \lambda < 0$，即 $t < \lambda$)
    $= \lambda \left[ \frac{1}{t-\lambda} e^{(t-\lambda)x} \right]_0^{\infty}$
    $= \lambda \left( 0 - \frac{1}{t-\lambda} e^0 \right) = \frac{-\lambda}{t-\lambda} = \frac{\lambda}{\lambda - t}$
    $\psi(t) = \lambda (\lambda - t)^{-1}$

2.  **求导**：
    * $\psi'(t) = \lambda (-1)(\lambda-t)^{-2}(-1) = \lambda(\lambda-t)^{-2}$
    * $\psi''(t) = \lambda (-2)(\lambda-t)^{-3}(-1) = 2\lambda(\lambda-t)^{-3}$

3.  **计算均值和方差**：
    * **均值**：$E(X) = \psi'(0) = \lambda(\lambda-0)^{-2} = \frac{\lambda}{\lambda^2} = \frac{1}{\lambda}$
    * **二阶矩**：$E(X^2) = \psi''(0) = 2\lambda(\lambda-0)^{-3} = \frac{2\lambda}{\lambda^3} = \frac{2}{\lambda^2}$
    * **方差**：$Var(X) = E(X^2) - [E(X)]^2 = \frac{2}{\lambda^2} - \left(\frac{1}{\lambda}\right)^2 = \frac{1}{\lambda^2}$

---
### 实例7：正态分布 (Normal Distribution)
**PDF**: $f(x) = \frac{1}{\sigma\sqrt{2\pi}} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)$

1.  **计算 MGF $\psi(t)$**：
    $\psi(t) = \int_{-\infty}^{\infty} e^{tx} \frac{1}{\sigma\sqrt{2\pi}} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right) dx$
    这一步计算的核心是**==配方法 (Completing the Square)==**，将 $tx - \frac{(x-\mu)^2}{2\sigma^2}$ 重新组合。
    
    * 将指数项合并：
        $\text{Exponent} = tx - \frac{x^2 - 2\mu x + \mu^2}{2\sigma^2}$
        $= \frac{2\sigma^2 tx - (x^2 - 2\mu x + \mu^2)}{2\sigma^2}$
        $= -\frac{1}{2\sigma^2} [x^2 - 2\mu x - 2\sigma^2 tx + \mu^2]$
        $= -\frac{1}{2\sigma^2} [x^2 - 2(\mu + \sigma^2 t)x + \mu^2]$

    * **配方**：
        令 $\mu^* = \mu + \sigma^2 t$。我们想凑出 $(x - \mu^*)^2 = x^2 - 2\mu^* x + (\mu^*)^2$
        $\text{Exponent} = -\frac{1}{2\sigma^2} [ (x^2 - 2\mu^* x + (\mu^*)^2) - (\mu^*)^2 + \mu^2 ]$
        $= -\frac{1}{2\sigma^2} [ (x - \mu^*)^2 ] - \frac{1}{2\sigma^2} [ \mu^2 - (\mu^*)^2 ]$
        $= -\frac{(x - (\mu + \sigma^2 t))^2}{2\sigma^2} + \frac{(\mu + \sigma^2 t)^2 - \mu^2}{2\sigma^2}$
    
    * **化简常数项**：
        $\frac{(\mu^2 + 2\mu\sigma^2 t + \sigma^4 t^2) - \mu^2}{2\sigma^2} = \frac{2\mu\sigma^2 t + \sigma^4 t^2}{2\sigma^2} = \mu t + \frac{\sigma^2 t^2}{2}$
        
    * **代回原积分**：
        $\text{Exponent} = -\frac{(x - (\mu + \sigma^2 t))^2}{2\sigma^2} + \left( \mu t + \frac{\sigma^2 t^2}{2} \right)$
        
        $\psi(t) = \int_{-\infty}^{\infty} e^{tx} f(x) dx$
        $= \int_{-\infty}^{\infty} \frac{1}{\sigma\sqrt{2\pi}} \exp\left( -\frac{(x - (\mu + \sigma^2 t))^2}{2\sigma^2} + \mu t + \frac{\sigma^2 t^2}{2} \right) dx$
        
        (把与 $x$ 无关的常数项 $e^{\mu t + \frac{\sigma^2 t^2}{2}}$ 提出来)
        
        $= e^{\mu t + \frac{\sigma^2 t^2}{2}} \int_{-\infty}^{\infty} \underbrace{\frac{1}{\sigma\sqrt{2\pi}} \exp\left( -\frac{(x - (\mu + \sigma^2 t))^2}{2\sigma^2} \right)}_{\text{这是一个新的正态分布PDF}} dx$
        
        这个积分内部是一个均值为 $\mu^* = (\mu + \sigma^2 t)$、方差为 $\sigma^2$ 的正态分布PDF。==任何PDF在全区间的积分都等于1==。
        
    * **得到 MGF**：
        $\psi(t) = e^{\mu t + \frac{\sigma^2 t^2}{2}} \cdot (1)$
        $\psi(t) = \exp\left(\mu t + \frac{\sigma^2 t^2}{2}\right)$

2.  **求导**：
    * $\psi'(t) = \exp\left(\mu t + \frac{\sigma^2 t^2}{2}\right) \cdot (\mu + \sigma^2 t)$
    * $\psi''(t)$ (使用乘法法则)：
        $= \exp(\dots) \cdot (\mu + \sigma^2 t) \cdot (\mu + \sigma^2 t) + \exp(\dots) \cdot (\sigma^2)$

3.  **计算均值和方差**：
    * **均值**：$E(X) = \psi'(0)$
        $= \exp(0) \cdot (\mu + \sigma^2 \cdot 0) = 1 \cdot \mu = \mu$
    * **二阶矩**：$E(X^2) = \psi''(0)$
        $= [\exp(0) \cdot (\mu) \cdot (\mu)] + [\exp(0) \cdot (\sigma^2)] = \mu^2 + \sigma^2$
    * **方差**：$Var(X) = E(X^2) - [E(X)]^2$
        $= (\mu^2 + \sigma^2) - (\mu)^2 = \sigma^2$