# 概率论进阶：从几何概率到计数方法

---

## <font color="teal">1. 不可数样本空间的概率 (Probability in Uncountable Sample Spaces)</font>

当样本空间是不可数无限集时（例如一个几何区域），我们无法对单个点分配概率。此时，我们采用一种新的思路。

### <font color="#3498DB">几何概率模型 (Geometric Probability Model)</font>

> [!tip] 核心思想：用“大小”的比值来定义概率
> 对于不可数样本空间，事件的概率可以通过几何度量（如长度、面积、体积）的比值来定义：
> $$ P(A) = \frac{\text{构成事件 A 的区域大小}}{\text{整个样本空间 S 的大小}} $$

> [!example] 水电需求问题回顾
> - **样本空间 (S)**: 一个矩形区域 $S = \{(x, y) | 4 \le x \le 200, 1 \le y \le 150\}$。
>   - 区域总面积: $Area(S) = (200-4) \times (150-1) = 196 \times 149$。
> - **事件 (A)**: 水需求 $x \ge 100$，电需求 $y \ge 35$。
>   - 事件A对应区域面积: $Area(A) = (200-100) \times (150-35) = 100 \times 115$。
> - **计算概率**:
>   $$ P(A) = \frac{Area(A)}{Area(S)} = \frac{100 \times 115}{196 \times 149} $$

### <font color="#3498DB">一个重要的思辨：概率为零 vs. 不可能事件</font>

> [!danger] 概率为 0 ≠ 不可能事件！
> - **问题**: 在上述水电模型中，事件 C 为 "水需求恰好等于100" ($x=100$) 的概率是多少？
> - **分析**: 事件 C 在二维坐标系中是一条**线段**。线段的面积为零。
>   $$ P(C) = \frac{Area(\text{一条线段})}{Area(\text{整个矩形})} = \frac{0}{196 \times 149} = 0 $$
> - **结论**:
>   - 事件 C 的概率是 0，但它**是可能发生**的 (水需求完全可以是100)。
>   - **对于无限样本空间**，概率为 0 的事件依然可能发生。
>   - **对于有限样本空间**，概率为 0 的事件等价于不可能事件。
> - 同样地，概率为 1 的事件也**不一定必然发生**。

---

## <font color="teal">2. 概率的基本性质与容斥原理</font>

基于概率三公理，我们可以推导出一些非常有用的概率性质。

### <font color="#3498DB">容斥原理 (Inclusion-Exclusion Principle)</font>

容斥原理是计算事件并集概率的核心公式。

> [!abstract] 两个事件的并集
> $$ P(A \cup B) = P(A) + P(B) - P(A \cap B) $$
> **直观理解**: 直接相加会把重叠部分 $A \cap B$ 计算两次，所以需要减去一次。

> [!abstract] 三个事件的并集
> $$
> \begin{aligned}
> P(A \cup B \cup C) = & \ [P(A) + P(B) + P(C)] \\
> & - [P(A \cap B) + P(A \cap C) + P(B \cap C)] \\
> & + [P(A \cap B \cap C)]
> \end{aligned}
> $$
> **直观理解**:
> 1.  先把所有单个的加上。
> 2.  发现两两相交的部分被多加了，于是减掉。
> 3.  发现三个事件共同相交的部分被减多了，于是再加回来。

> [!example] 学生选课问题
> - **背景**: 200名学生，选数学(M)137人，选历史(H)50人，选音乐(Mu)124人。
>   - M and H: 33人
>   - H and Mu: 29人
>   - M and Mu: 92人
>   - M and H and Mu: 18人
> - **问题**: 随机选一名学生，他至少选了三门课中一门的概率是多少？
> - **解**: 我们要求 $P(M \cup H \cup Mu)$。这是一个古典概型问题，可以直接用人数代替概率，最后再除以总人数。
>   - **分子 (至少选一门课的人数)**:
>     $N(M \cup H \cup Mu) = (137+50+124) - (33+29+92) + 18 = 311 - 154 + 18 = 175$
>   - **计算概率**:
>     $P = \frac{175}{200} = 0.875$

---

## <font color="teal">3. 计数方法 (Counting Methods)</font>

在古典概型（简单样本空间）中，计算概率的核心任务是**计数**。

### <font color="#3498DB">乘法法则 (Multiplication Rule)</font>

> [!summary] 核心思想
> 如果一个试验可以分解为 $k$ 个独立的步骤，第 $i$ 步有 $n_i$ 种可能的结果，那么完成整个试验的总结果数就是所有步骤结果数的乘积。
> $$ \text{Total Outcomes} = n_1 \times n_2 \times \dots \times n_k $$

> [!example] 示例
> 1.  **路径选择**: 从A地到B地有3条路，从B地到C地有5条路，那么从A到C经过B共有 $3 \times 5 = 15$ 条不同路径。
> 2.  **抛掷硬币**: 抛掷6枚硬币，每个硬币有2种结果（正/反），总结果数为 $2^6 = 64$ 种。
> 3.  **密码锁**: 一个三位密码锁，每位数字可以从0到39（共40个选项），总密码组合数为 $40 \times 40 \times 40 = 40^3 = 64,000$ 种。

### <font color="#3498DB">排列 (Permutation)</font>

排列关注的是从一个集合中**按顺序**选取元素。

> [!note] 核心概念：无放回抽样 (Sampling without Replacement)
> 从 $n$ 个不同元素中，按顺序取出 $k$ 个，取出的元素**不再放回**。总共有多少种不同的排列方式？

> [!abstract] 排列数公式
> $$ P_n^k = n \times (n-1) \times (n-2) \times \dots \times (n-k+1) = \frac{n!}{(n-k)!} $$

> [!example] 示例
> 1.  **选举**: 一个25人的俱乐部，要选出一名主席和一名秘书。顺序很重要（主席和秘书是不同职位）。
>     - 总排列数: $P_{25}^2 = 25 \times 24 = 600$ 种。
> 2.  **书籍排列**: 6本不同的书在书架上排成一排。
>     - 总排列数: $P_6^6 = 6! = 720$ 种。

### <font color="#3498DB">生日问题 (The Birthday Problem)</font>

这是一个经典的、反直觉的概率问题，完美地结合了计数、乘法法则和补集思想。

> [!faq] 问题
> 在一个有 $k$ 人的房间里，至少有两个人生日相同的概率是多少？（假设一年365天，忽略闰年，且生日均匀分布）

> [!rocket] 解题策略：计算补集概率
> 直接计算“至少两人”非常复杂（可能2人、3人、...、k人相同）。
> 更简单的方法是计算其**补集事件 (E')** 的概率，即“**所有人的生日都不同**”。
>
> $$ P(\text{至少两人同生日}) = 1 - P(\text{所有人不同生日}) $$

**计算步骤**:

1.  **确定样本空间大小 (总结果数)**:
    - 每个人都有365种生日可能，共k个人。
    - 根据乘法法则，总结果数为 $365^k$。

2.  **确定补集事件的结果数 (所有人生日都不同)**:
    - 这相当于从365天中，**无放回地**为k个人分配生日。
    - 第1个人有365种选择。
    - 第2个人为避免重复，只有364种选择。
    - ...
    - 第k个人只有 $(365-k+1)$ 种选择。
    - 结果数为 $P_{365}^k = 365 \times 364 \times \dots \times (365-k+1)$。

3.  **计算补集概率**:
    $$ P(E') = \frac{P_{365}^k}{365^k} $$

4.  **得到最终答案**:
    $$ P(E) = 1 - \frac{P_{365}^k}{365^k} $$

> [!quote] 反直觉的结果
> - 当 $k=23$ 时，概率就已经**超过了 50%**。
> - 当 $k=60$ 时，概率已经**高达 99%**。
> 这说明我们的直觉在概率问题上往往是不可靠的。